<!DOCTYPE html>
<html lang="en"><head>
<meta charset="utf-8"/>
<meta content="ReSpec 34.1.0" name="generator"/>
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
:is(aside,div).example{border-left-width:.5em;border-left-style:solid;border-color:#e0cb52;background:#fcfaee}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
.example pre{background-color:rgba(0,0,0,.03)}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-width:.2em;border-style:solid;background:#fbe9e9}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
<title>ReShare</title>
<script src="localBiblio.js"></script>
<link href="custom_styles.css" rel="stylesheet"/>
<link href="resources/primer.css" media="screen" rel="stylesheet"/>
<link href="resources/rec.css" media="screen" rel="stylesheet"/>
<link href="resources/extra.css" media="screen" rel="stylesheet"/>
<link href="resources/owl.css" media="screen" rel="stylesheet"/>
<script src="resources/jquery.js"></script>
<script src="resources/marked.min.js"></script>
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
:is(h1,h2,h3,h4,h5,h6,a) abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
<link href="https://www.w3.org/StyleSheets/TR/2021/W3C-Member-SUBM" rel="stylesheet"/>
<link href="https://www.w3.org/Submission/reshare/" rel="canonical"/>
<style>
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}
.hljs-comment,.hljs-quote{color:#717277;font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}
.hljs-literal{color:#0b76c5}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "specStatus": "Member-SUBM",
  "shortName": "reshare",
  "subtitle": "Scalable Reliability for Data Sharing on the Web",
  "github": "ReShare-DTC/reshare-w3c-member-submission",
  "submissionCommentNumber": "??",
  "canonicalURI": "https://www.w3.org/Submission/reshare/",
  "authors": [
    {
      "name": "Simon Mangel",
      "company": "Computer Science 5, RWTH Aachen University",
      "companyURL": "http://dbis.rwth-aachen.de/"
    },
    {
      "name": "Lars Gleim",
      "company": "Computer Science 5, RWTH Aachen University",
      "companyURL": "http://dbis.rwth-aachen.de/"
    },
    {
      "name": "Jan Pennekamp",
      "company": "Communication and Distributed Systems, RWTH Aachen University",
      "companyURL": "https://www.comsys.rwth-aachen.de/"
    }
  ],
  "editors": [
    {
      "name": "Stefan Decker",
      "company": "Fraunhofer Institute for Applied Information Technology",
      "companyURL": "https://www.fit.fraunhofer.de/",
      "w3cid": 9614
    }
  ],
  "edDraftURI": "https://w3id.org/reshare/spec/authors-draft/",
  "localBiblio": {
    "FactDAG": {
      "title": "FactDAG: Formalizing Data Interoperability in an Internet of Production",
      "href": "https://doi.org/10.1109/JIOT.2020.2966402",
      "publisher": "IEEE Internet of Things Journal, vol. 7, no. 4, pp. 3243-3253",
      "date": "April 2020",
      "status": "Research Paper",
      "authors": [
        "Lars Gleim",
        "Jan Pennekamp",
        "Martin Liebenberg",
        "Melanie Buchsbaum",
        "Phillip Niemietz",
        "Simon Knape",
        "Alexander Epple",
        "Daniel Trauth",
        "Thomas Bergs",
        "Christian Brecher",
        "Stefan Decker",
        "Gerhard Lakemeyer",
        "Klaus Wehrle"
      ],
      "id": "factdag"
    },
    "SECURITY-VOCABULARY": {
      "title": "The Security Vocabulary",
      "href": "https://w3c-ccg.github.io/security-vocab/",
      "authors": [
        "Manu Sporny",
        "Orie Steele",
        "Tobias Looker"
      ],
      "status": "CGDRAFT",
      "publisher": "Credentials Community Group"
    },
    "LD-PROOFS": {
      "title": "Linked Data Proofs 1.0",
      "href": "https://w3c-ccg.github.io/ld-proofs/",
      "authors": [
        "Dave Longley",
        "Manu Sporny"
      ],
      "status": "CGDRAFT",
      "publisher": "W3C Digital Verification Community Group"
    },
    "URDNA2015": {
      "title": "RDF Dataset Normalization",
      "href": "https://json-ld.github.io/rdf-dataset-canonicalization/spec/",
      "authors": [
        "Dave Longley",
        "Manu Sporny"
      ],
      "status": "CGDRAFT",
      "publisher": "Credentials W3C Community Group"
    },
    "OEZER-TRUST": {
      "title": "Establishing Trust and Trustworthiness for Supply Chain Information Sharing",
      "href": "https://doi.org/10.1007/978-3-319-32441-8_14",
      "authors": [
        "Özalp Özer, Yanchong Zheng"
      ],
      "status": "Research Paper",
      "date": "2017",
      "publisher": "Handbook of Information Exchange in Supply Chain Management. Springer Series in Supply Chain Management, vol 5. Springer, Cham",
      "id": "oezer-trust"
    },
    "ReShare": {
      "title": "Data Reliability and Trustworthiness Through Digital Transmission Contracts",
      "href": "https://doi.org/10.1007/978-3-030-77385-4_16",
      "authors": [
        "Simon Mangel",
        "Lars Gleim",
        "Jan Pennekamp",
        "Klaus Wehrle",
        "Stefan Decker"
      ],
      "status": "Research Paper",
      "date": "2021",
      "publisher": "The Semantic Web. ESWC 2021. Lecture Notes in Computer Science, vol 12731. Springer, Cham",
      "id": "reshare"
    },
    "TowardsIoP": {
      "title": "Towards an Infrastructure Enabling the Internet of Production",
      "authors": [
        "Jan Pennekamp",
        "René Glebke",
        "Martin Henze",
        "Tobias Meisen",
        "Christoph Quix",
        "Rihan Hai",
        "Lars Gleim",
        "Philipp Niemitz",
        "Maximilian Rudack",
        "Simon Knape",
        "Alexander Epple",
        "Daniel Trauth",
        "Uwe Vroomen",
        "Thomas Bergs",
        "Christian Brecher",
        "Andreas Bührig-Polaczek",
        "Matthias Jarke",
        "Klaus Wehrle"
      ],
      "href": "https://doi.org/10.1109/ICPHYS.2019.8780276",
      "status": "Research Paper",
      "date": "2019",
      "publisher": "2019 IEEE International Conference on Industrial Cyber Physical Systems (ICPS)",
      "id": "towardsiop"
    },
    "JSON-SCHEMA-VALIDATION": {
      "authors": [
        "Austin Wright",
        "Henry Andrews",
        "Ben Hutton"
      ],
      "href": "https://datatracker.ietf.org/doc/html/draft-bhutton-json-schema-validation",
      "publisher": "Internet Engineering Task Force (IETF)",
      "status": "Internet-Draft",
      "title": "JSON Schema Validation: A Vocabulary for Structural Validation of JSON",
      "repository": "https://github.com/json-schema-org/json-schema-spec",
      "id": "json-schema-validation",
      "date": "11 June 2021"
    },
    "DATA-INTEGRITY": {
      "title": "Data Integrity",
      "href": "https://w3c-ccg.github.io/data-integrity-spec/",
      "authors": [
        "Manu Sporny",
        "Dave Longley"
      ],
      "status": "CG-DRAFT",
      "publisher": "Credentials Community Group",
      "id": "data-integrity"
    }
  },
  "xref": [
    "reshare",
    "dtc"
  ],
  "publishISODate": "2023-05-01T00:00:00.000Z",
  "generatedSubtitle": "W3C Member Submission 01 May 2023"
}</script>
<link href="https://www.w3.org/StyleSheets/TR/2021/W3C-Member-SUBM" rel="stylesheet" type="text/css"/></head>
<body class="h-entry" data-cite="reshare dtc"><div class="head">
<p class="logos"><a class="logo" href="https://www.w3.org/"><img alt="W3C" crossorigin="" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"/>
</a><a class="logo"><img alt="W3C Member Submission" crossorigin="" height="48" src="https://www.w3.org/Icons/member_subm-v.svg" width="211"/>
</a></p>
<h1 class="title" id="title">ReShare</h1> <h2 class="subtitle" id="subtitle">Scalable Reliability for Data Sharing on the Web</h2>
<p id="w3c-state"><a href="https://www.w3.org/standards/types#Member-SUBM">W3C Member Submission</a> <time class="dt-published" datetime="2023-05-01">01 May 2023</time></p>
<details open="">
<summary>More details about this document</summary>
<dl>
<dt>This version:</dt><dd>
<a class="u-url" href="https://www.w3.org/Submission/2023/SUBM-reshare-20230501/">https://www.w3.org/Submission/2023/SUBM-reshare-20230501/</a>
</dd>
<dt>Latest published version:</dt><dd>
<a href="https://www.w3.org/Submission/reshare/">https://www.w3.org/Submission/reshare/</a>
</dd>
<dt>Latest editor's draft:</dt><dd><a href="https://w3id.org/reshare/spec/authors-draft/">https://w3id.org/reshare/spec/authors-draft/</a></dd>
<dt>History:</dt><dd>
<a href="https://github.com/ReShare-DTC/reshare-w3c-member-submission/commits/">Commit history</a>
</dd>
<dt>Editor:</dt><dd class="editor p-author h-card vcard" data-editor-id="9614">
<span class="p-name fn">Stefan Decker</span> (<a class="p-org org h-org" href="https://www.fit.fraunhofer.de/">Fraunhofer Institute for Applied Information Technology</a>)
  </dd>
<dt>Authors:</dt><dd class="editor p-author h-card vcard">
<span class="p-name fn">Simon Mangel</span> (<a class="p-org org h-org" href="http://dbis.rwth-aachen.de/">Computer Science 5, RWTH Aachen University</a>)
  </dd><dd class="editor p-author h-card vcard">
<span class="p-name fn">Lars Gleim</span> (<a class="p-org org h-org" href="http://dbis.rwth-aachen.de/">Computer Science 5, RWTH Aachen University</a>)
  </dd><dd class="editor p-author h-card vcard">
<span class="p-name fn">Jan Pennekamp</span> (<a class="p-org org h-org" href="https://www.comsys.rwth-aachen.de/">Communication and Distributed Systems, RWTH Aachen University</a>)
  </dd>
<dt>Feedback:</dt><dd>
<a href="https://github.com/ReShare-DTC/reshare-w3c-member-submission/">GitHub ReShare-DTC/reshare-w3c-member-submission</a>
        (<a href="https://github.com/ReShare-DTC/reshare-w3c-member-submission/pulls/">pull requests</a>,
        <a href="https://github.com/ReShare-DTC/reshare-w3c-member-submission/issues/new/choose">new issue</a>,
        <a href="https://github.com/ReShare-DTC/reshare-w3c-member-submission/issues/">open issues</a>)
      </dd>
</dl>
</details>
<p class="copyright">
    Copyright © 2022 Fraunhofer Institute for Applied Information Technology. This document is available under the <a href="https://www.w3.org/Consortium/Legal/copyright-documents">W3C Document License</a>. See the <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">W3C Intellectual Rights Notice and Legal Disclaimers</a> for additional information.
  </p>
<hr title="Separator for header"/>
</div>
<section class="introductory" id="abstract"><h2>Abstract</h2>
    The ReShare system constitutes a uniform approach to ensure accountable and trustworthy data sharing and collaboration in Open Data ecosystems based on Digital Transmission Contracts (DTCs).
    DTCs are bilaterally signed digital records immutably certifying the data and context of a data transmission without the typical overhead of distributed ledger technologies.
    By leveraging open Web technologies, a simple and common cryptography architecture, and a bilateral signature paradigm, the system promises superior performance and scalability to common approaches such as manual records management or blockchain-based solutions while providing immutability and fraud protection guarantees sufficient for a variety of use cases, such as data accountability and liability assurance in aircraft manufacturing.
    In this document, we specify (1) the structure and representations of DTCs, (2) the <i>ReShare ontology</i> used to embed DTCs into the Semantic Web, and (3) the protocol and necessary mechanisms to create and verify DTCs.
  </section>
<section class="introductory" id="sotd"><h2>Status of This Document</h2><p><em>This section describes the status of this
      document at the time of its publication. A list of current W3C
      publications and the latest revision of this technical report can be found
      in the <a href="https://www.w3.org/TR/">W3C technical reports index</a> at
      https://www.w3.org/TR/.</em></p><p>
    By publishing this document, W3C acknowledges that the
    <a href="https://www.w3.org/Submission/2023/SUBM-reshare-20230501/">Submitting Members</a> have made a formal
    Submission request to W3C for discussion. Publication of this document by
    W3C indicates no endorsement of its content by W3C, nor that W3C has, is, or
    will be allocating any resources to the issues addressed by it. This
    document is not the product of a chartered W3C group, but is published as
    potential input to the
    <a href="https://www.w3.org/Consortium/Process">W3C Process</a>. A
    <a href="https://www.w3.org/Submission/2023/??/Comment/">W3C Team Comment</a> has been published in
    conjunction with this Member Submission. Publication of acknowledged Member
    Submissions at the W3C site is one of the benefits of
    <a href="https://www.w3.org/Consortium/Prospectus/Joining">
      W3C Membership</a>. Please consult the requirements associated with Member Submissions of
    <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-submissions">section 3.3 of the W3C Patent Policy</a>. Please consult the complete
    <a href="https://www.w3.org/Submission">list of acknowledged W3C Member Submissions</a>.
  </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">2. </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#primer"><bdi class="secno">3. </bdi>A Primer to Data Sharing</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#primer-background"><bdi class="secno">3.1 </bdi>Background</a></li><li class="tocline"><a class="tocxref" href="#primer-terminology"><bdi class="secno">3.2 </bdi>Terminology</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#primer-terminology-concepts"><bdi class="secno">3.2.1 </bdi>Concepts</a></li><li class="tocline"><a class="tocxref" href="#primer-terminology-process"><bdi class="secno">3.2.2 </bdi>Process and Agents of Data Sharing</a></li></ol></li><li class="tocline"><a class="tocxref" href="#primer-example-scenario"><bdi class="secno">3.3 </bdi>Example Scenario</a></li></ol></li><li class="tocline"><a class="tocxref" href="#digital-transmission-contracts"><bdi class="secno">4. </bdi>Digital Transmission Contracts (DTCs)</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#dtc-signature-paradigm"><bdi class="secno">4.1 </bdi>Mutual Commitment through Bilateral Signatures</a></li><li class="tocline"><a class="tocxref" href="#dtc-example-application"><bdi class="secno">4.2 </bdi>Application to the Example Scenario</a></li><li class="tocline"><a class="tocxref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a></li><li class="tocline"><a class="tocxref" href="#dtc-representations"><bdi class="secno">4.4 </bdi>DTC Representations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#dtc-representations-json"><bdi class="secno">4.4.1 </bdi>JSON</a></li><li class="tocline"><a class="tocxref" href="#dtc-representations-jsonld"><bdi class="secno">4.4.2 </bdi>JSON-LD</a></li></ol></li><li class="tocline"><a class="tocxref" href="#dtc-signatures"><bdi class="secno">4.5 </bdi>Signature Creation &amp; Verification</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#dtc-signatures-overview"><bdi class="secno">4.5.1 </bdi>Overview</a></li><li class="tocline"><a class="tocxref" href="#dtc-signatures-preprocessing"><bdi class="secno">4.5.2 </bdi>Pre-Processing</a></li><li class="tocline"><a class="tocxref" href="#dtc-signatures-creation"><bdi class="secno">4.5.3 </bdi>Signature Creation</a></li><li class="tocline"><a class="tocxref" href="#dtc-signatures-verification"><bdi class="secno">4.5.4 </bdi>Signature Verification</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#reshare-ontology"><bdi class="secno">5. </bdi>The ReShare Ontology</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#overview-0"><bdi class="secno">5.1 </bdi>Overview</a></li><li class="tocline"><a class="tocxref" href="#sec-classes"><bdi class="secno">5.2 </bdi>Classes</a></li><li class="tocline"><a class="tocxref" href="#object-properties"><bdi class="secno">5.3 </bdi>Object Properties</a></li><li class="tocline"><a class="tocxref" href="#data-properties"><bdi class="secno">5.4 </bdi>Data Properties</a></li></ol></li><li class="tocline"><a class="tocxref" href="#dtc-generation-and-verification"><bdi class="secno">6. </bdi>DTC Generation &amp; Verification</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#dtcgenver-generation"><bdi class="secno">6.1 </bdi>DTC Generation Handshake</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#dtcgenver-generation-overview"><bdi class="secno">6.1.1 </bdi>Overview</a></li><li class="tocline"><a class="tocxref" href="#dtcgenver-generation-complete"><bdi class="secno">6.1.2 </bdi>Complete (3-way) Handshake</a></li><li class="tocline"><a class="tocxref" href="#dtcgenver-generation-abbrev"><bdi class="secno">6.1.3 </bdi>Abbreviated (2-way) Handshake</a></li><li class="tocline"><a class="tocxref" href="#dtcgenver-generation-msgids"><bdi class="secno">6.1.4 </bdi>Message Identifiers</a></li><li class="tocline"><a class="tocxref" href="#dtcgenver-generation-msgbuilder"><bdi class="secno">6.1.5 </bdi>Message Builder</a></li><li class="tocline"><a class="tocxref" href="#dtcgenver-generation-msgschemas"><bdi class="secno">6.1.6 </bdi>Message Schemas</a></li><li class="tocline"><a class="tocxref" href="#dtcgenver-generation-msgvalidator"><bdi class="secno">6.1.7 </bdi>Message Validator</a></li><li class="tocline"><a class="tocxref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a></li><li class="tocline"><a class="tocxref" href="#dtcgenver-generation-protocol"><bdi class="secno">6.1.9 </bdi>Protocol Stack</a></li></ol></li><li class="tocline"><a class="tocxref" href="#dtcgenver-verification"><bdi class="secno">6.2 </bdi>DTC Verification</a></li></ol></li><li class="tocline"><a class="tocxref" href="#considerations"><bdi class="secno">A. </bdi>Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#considerations-otherw3ctechs"><bdi class="secno">A.1 </bdi>Relation to Other W3C Documents</a></li><li class="tocline"><a class="tocxref" href="#considerations-iricertlink"><bdi class="secno">A.2 </bdi>Identity Management</a></li><li class="tocline"><a class="tocxref" href="#considerations-2or3wayhs"><bdi class="secno">A.3 </bdi>DTC Generation: Two Handshake Versions</a></li></ol></li><li class="tocline"><a class="tocxref" href="#acknowledgements"><bdi class="secno">B. </bdi>Acknowledgements</a></li><li class="tocline"><a class="tocxref" href="#tof"><bdi class="secno">C. </bdi>List of Figures</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">D. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">D.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">D.2 </bdi>Informative references</a></li></ol></li></ol></nav>
<section class="informative" id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a aria-label="Permalink for Section 1." class="self-link" href="#introduction"></a></div><p><em>This section is non-normative.</em></p>
<div class="tlcontent">
<p>
        Information sharing between parties on the Internet is omnipresent.
        However, there is a severe lack of efficient and scalable methods to prove the existence, contents, and context of a data transfer.
      </p>
<p>
        Especially in the context of data-driven business models, data <a class="internalDFN" data-link-type="dfn" href="#dfn-trustworthiness" id="ref-for-dfn-trustworthiness-1">trustworthiness</a> and <a class="internalDFN" data-link-type="dfn" href="#dfn-reliability" id="ref-for-dfn-reliability-1">reliability</a> are extremely important to minimize data quality-related risks in the business model.
        Therefore, an approach, which is able to guarantee both of these properties in the context of <a class="internalDFN" data-link-type="dfn" href="#dfn-data-sharing" id="ref-for-dfn-data-sharing-1">data sharing</a>, and scale up to the future needs w.r.t. data throughput, is needed.
        The relevance of inter-organizational data sharing is stressed by the vision of an <i>Internet of Production</i>
        (IoP), where open data sharing approaches leverage cross-domain collaboration, resulting in a multitude of benefits for all participants [<cite><a class="bibref" data-link-type="biblio" href="#bib-towardsiop" title="Towards an Infrastructure Enabling the Internet of Production">TowardsIoP</a></cite>].
      </p>
<p>
        In this document, we describe <em><b>ReShare</b> (Reliable Data Sharing through Digital Transmission Contracts)</em>.
        <em>ReShare</em> provides data integrity, authenticity, and immutability in data exchanges between two parties through digital contracting using on-demand bilateral signatures.
        By establishing an irrefutable commitment by the two parties to the data transmission, data trustworthiness, and reliability emerge.
      </p>
<p>
<em>ReShare</em> is a unified solution for the Web, built from open Web technology, and adresses an important research gap.
        That is, ReShare is both highly scalable, and does not rely on pre-existing trust relations, which both are essential requirements in the context of the Web.
      </p>
<p>
<em>ReShare</em> employs signature-based strong data immutability to be feasible as a unified solution for the Web.
        Further, the design provides a system which is flexible to the payload (i.e., the shared data to be made trustworthy and reliable), and therefore supports any Web resource or content, including plain text, Linked Data payloads, JSON, and binary data, amongst other formats.
      </p>
<p>
        The structure of this document is as follows:
        In Section <a class="sec-ref" href="#primer"><bdi class="secno">3. </bdi>A Primer to Data Sharing</a>, we introduce the relevant terminology and outline typical data sharing scenarios motivating the need for scalable immutability, authenticity, and integrity.
        In Section <a class="sec-ref" href="#digital-transmission-contracts"><bdi class="secno">4. </bdi>Digital Transmission Contracts (DTCs)</a>, we describe the paradigm and structure of Digital Transmission Contracts (DTCs), which are at the core of <em>ReShare</em>.
        After that, we propose the <em>ReShare ontology</em> in Section <a class="sec-ref" href="#reshare-ontology"><bdi class="secno">5. </bdi>The ReShare Ontology</a>, which is used to define the semantics of DTCs in the context of Linked Data.
        Finally, we describe the generation and verification mechanisms needed to process DTCs in Section <a class="sec-ref" href="#dtc-generation-and-verification"><bdi class="secno">6. </bdi>DTC Generation &amp; Verification</a>.
      </p>
</div>
</section>
<section id="conformance"><div class="header-wrapper"><h2 id="x2-conformance"><bdi class="secno">2. </bdi>Conformance</h2><a aria-label="Permalink for Section 2." class="self-link" href="#conformance"></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, <em class="rfc2119">SHOULD</em>, and <em class="rfc2119">SHOULD NOT</em> in this document
        are to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p>
</section>
<section class="informative" id="primer"><div class="header-wrapper"><h2 id="x3-a-primer-to-data-sharing"><bdi class="secno">3. </bdi>A Primer to Data Sharing</h2><a aria-label="Permalink for Section 3." class="self-link" href="#primer"></a></div><p><em>This section is non-normative.</em></p>
<div class="tlcontent">
<p>
        For a formal understanding of data sharing and its applications, Section <a class="sec-ref" href="#primer-background"><bdi class="secno">3.1 </bdi>Background</a> gives an introduction to data sharing, and Section <a class="sec-ref" href="#primer-terminology"><bdi class="secno">3.2 </bdi>Terminology</a> formalizes the used terminology.
        In Section <a class="sec-ref" href="#primer-example-scenario"><bdi class="secno">3.3 </bdi>Example Scenario</a>, we introduce a use case scenario which we use throughout the remainder of the document for clarifications and examples.
      </p>
</div>
<section id="primer-background"><div class="header-wrapper"><h3 id="x3-1-background"><bdi class="secno">3.1 </bdi>Background</h3><a aria-label="Permalink for Section 3.1" class="self-link" href="#primer-background"></a></div>
<div class="tlcontent">
<p>
<a class="internalDFN" data-link-type="dfn" href="#dfn-data-sharing" id="ref-for-dfn-data-sharing-2">Data sharing</a> is a central concept of the Web.
          In recent years, fueled by developments in data-driven business and industries, challenges of fitting the process of <a class="internalDFN" data-link-type="dfn" href="#dfn-data-sharing" id="ref-for-dfn-data-sharing-3">data sharing</a> to more advanced requirements, such as <a class="internalDFN" data-link-type="dfn" href="#dfn-trustworthiness" id="ref-for-dfn-trustworthiness-2">trustworthiness</a> and <a class="internalDFN" data-link-type="dfn" href="#dfn-reliability" id="ref-for-dfn-reliability-2">reliability</a>, have emerged.
        </p>
<p>
          As the source of data used in industrial collaborations often is external, it has no inherent trustworthiness compared to self-produced data.
          This increases the risk of legal and safety issues for the data user, as the liability for incidents caused by the data cannot immediately be attributed to its source.
        </p>
<p>
          
          Solving the challenges of data <a class="internalDFN" data-link-type="dfn" href="#dfn-trustworthiness" id="ref-for-dfn-trustworthiness-3">trustworthiness</a> and <a class="internalDFN" data-link-type="dfn" href="#dfn-reliability" id="ref-for-dfn-reliability-3">reliability</a> has been shown to enable a variety of novel business models based on data-driven decision making [<cite><a class="bibref" data-link-type="biblio" href="#bib-oezer-trust" title="Establishing Trust and Trustworthiness for Supply Chain Information Sharing">OEZER-TRUST</a></cite>], where the data sharing process is made transparent to the data users through the ability to reliably trace the provenance of data.
          Further, data sharing in inter-organizational collaborations has been shown to provide the basis for benefits such as cost reductions, increased profit margins, and general improvements in product quality and safety [<cite><a class="bibref" data-link-type="biblio" href="#bib-towardsiop" title="Towards an Infrastructure Enabling the Internet of Production">TowardsIoP</a></cite>].
        </p>
<section class="notoc">
<div class="header-wrapper"><h4 id="the-challenge-of-data-trustworthiness">The Challenge of Data Trustworthiness</h4><a aria-label="Permalink for this Section" class="self-link" href="#the-challenge-of-data-trustworthiness"></a></div>
<p>
            Wherever corrupted or forged data imposes a relevant risk, the user should carefully assess the trustworthiness of its data.
            That is, users need some rationale for trusting the authenticity and correctness of data.
            This rationale may be a strong trust relationship with the data source, some form of digital proof of authenticity and integrity, or even the result of manual data curation.
          </p>
</section>
<section class="notoc">
<div class="header-wrapper"><h4 id="the-challenge-of-data-reliability">The Challenge of Data Reliability</h4><a aria-label="Permalink for this Section" class="self-link" href="#the-challenge-of-data-reliability"></a></div>
<p>
            Especially in safety-critical environments, the data user might need confidence in the reliability of data,
            i.e., that the data itself is valuable and usable beyond its initial use, i.e., it should keep its initial value to the user.
            One relevant aspect of data reliability is that the data source cannot easily repudiate the state of the shared data later, neither by forging contradicting data, nor by repudiating the earlier data transmission at all.
          </p>
<p>
            Similar as for data trustworthiness, some kind of rationale for this reliability is necessary, e.g., a strong pre-existing trust relationship with the data source, or some kind of mechanism to notice adversaries by the data source and solve the resulting conflicts.
          </p>
</section>
<section class="notoc">
<div class="header-wrapper"><h4 id="relevance-of-the-web">Relevance of the Web</h4><a aria-label="Permalink for this Section" class="self-link" href="#relevance-of-the-web"></a></div>
<p>
            
            The Web is a prime candidate to enable reliable data sharing as it is commonly used to exchange information between different stakeholders.
            As the importance of Open Data increases steadily, a system for trustworthy and reliable data sharing built using open Web standards and technology can both profit from the inherent data sharing capabilities of the Web, and facilitate integration into an Open Data paradigm.
          </p>
<p>
            
            Existing approaches to trustworthy and reliable data sharing, such as mutually trusted mediators and distributed ledgers, might be applicable to small-scale use cases with either pre-existing trust relations or low requirements to system scalability.
            However, Web-scaled systems have specific, more challenging needs.
            First, the possible limitation of a trust assumption in a system would severely limit its potential, as common trust in a central mediator can hardly be assumed in a global network such as the Web.
            Second, existing no-trust solutions, such as manual data curation and even distributed ledger technology, do not meet tomorrow's needs toward scalability for efficient usage on the whole Web.
          </p>
</section>
</div>
</section>
<section class="informative" id="primer-terminology"><div class="header-wrapper"><h3 id="x3-2-terminology"><bdi class="secno">3.2 </bdi>Terminology</h3><a aria-label="Permalink for Section 3.2" class="self-link" href="#primer-terminology"></a></div><p><em>This section is non-normative.</em></p>
<p>In the following, we introduce the necessary terminology used throughout the document.</p>
<section class="informative" id="primer-terminology-concepts"><div class="header-wrapper"><h4 id="x3-2-1-concepts"><bdi class="secno">3.2.1 </bdi>Concepts</h4><a aria-label="Permalink for Section 3.2.1" class="self-link" href="#primer-terminology-concepts"></a></div><p><em>This section is non-normative.</em></p>
<p>
          While the presented terms and concepts may have different definitions in practice, <em>ReShare</em> builds on the terminology introduced in the following.
        </p>
<dl>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" id="dfn-data-sharing" tabindex="0">data sharing</dfn></dt>
<dd>
            Data sharing denotes a process in which one party, the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-1">sender</a>, grants a second party (or group of parties), the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-1">receiver</a> (or <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-2">receivers</a>), access to a set of data.
            The data is then transmitted from the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-2">sender</a> to the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-3">receiver</a> as a <em>data transmission</em>.
          </dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" id="dfn-trustworthiness" tabindex="0">trustworthiness</dfn></dt>
<dd>
            (Data) trustworthiness denotes the subjective judgment of the data correctness by the data user.
            The term <em>correctness</em> here includes integrity and authenticity, but is not limited to it.
            Rather, it covers the complete data pipeline, and thus, for example, also considers errors in measurement,
            inaccuracies, or intentional forgery or manipulation by the (authentic) data source.
          </dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" id="dfn-reliability" tabindex="0">reliability</dfn></dt>
<dd>
            Data reliability denotes the guarantees available to a data user to prove aspects of data correctness before, at, and after the initial use of the data.
          </dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" id="dfn-immutability" tabindex="0">immutability</dfn></dt>
<dd>
<p>
              We define data to be immutable if it can be uniquely referenced, and that reference always refers to exactly the same data at any point in time.
              This directly implicates that once published, data cannot be manipulated afterward without assigning a different identifier.
            </p>
<p>
              We further differentiate between <em>weak</em> and <em>strong</em> data immutability:
            </p><ul>
<li>In a <em>weak</em> data immutability system, an identifier scheme defines how data can be created and published in an immutable manner.
                However, such a system does not protect against misuse of the immutability scheme, and has no in-built mechanisms to immediately notice or resolve misuses.
              </li>
<li>
                In a <em>strong</em> immutability system, any action violating the immutability property leads to an inconsistent state of the system.
                The system provides mechanisms to both recognize such inconsistencies, and resolve them to a consistent state.
                Therefore, at any point in time, one can unambiguously determine the correct state of any immutable data point.
                <div class="note" id="issue-container-generatedID" role="note"><div aria-level="5" class="note-title marker" id="h-note" role="heading"><span>Note</span></div><p class="">
                  It is unclear whether a perfect strong immutability system can practically exist.
                  Most systems striving at providing strong data immutability come with practical assumptions and limitations.
                  For example, the consensus state of a distributed consensus mechanism can be determined with a high probability, but not with full certainty.
                  Furthermore, if a large proportion of the participants of a consensus network collude, the immutability guarantee cannot hold.
                </p></div>
</li>
</ul>
</dd>
</dl>
</section>
<section class="informative" id="primer-terminology-process"><div class="header-wrapper"><h4 id="x3-2-2-process-and-agents-of-data-sharing"><bdi class="secno">3.2.2 </bdi>Process and Agents of Data Sharing</h4><a aria-label="Permalink for Section 3.2.2" class="self-link" href="#primer-terminology-process"></a></div><p><em>This section is non-normative.</em></p>
<dl>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" data-plurals="iris" id="dfn-iri" tabindex="0">IRI</dfn></dt>
<dd>
            An <em>Internationalized Resource Identifier</em> (IRI) [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3987" title="Internationalized Resource Identifiers (IRIs)">RFC3987</a></cite>] is a globally unique identifier in the form of a sequence of characters from the Universal Character Set, as defined in <cite><a data-matched-text="[[[RFC3987]]]" href="https://www.rfc-editor.org/rfc/rfc3987">Internationalized Resource Identifiers (IRIs)</a></cite>.
          </dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" data-plurals="senders" id="dfn-sender" tabindex="0">sender</dfn></dt>
<dd>
            Denotes the sending party in a data transmission.
            This term is always used in the context of a data transmission and refers to the direction of dataflow.
            Each sender has an associated globally unique identifier in the form of an <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-1">IRI</a>.
            Means by which this <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-2">IRI</a> can unambiguously identify a party are further discussed in Section <a class="sec-ref" href="#considerations-iricertlink"><bdi class="secno">A.2 </bdi>Identity Management</a>.
          </dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" data-plurals="receivers" id="dfn-receiver" tabindex="0">receiver</dfn></dt>
<dd>
            Denotes the receiving party in a data transmission.
            This term is always used in the context of a data transmission and refers to the direction of dataflow.
            Each sender has an associated globally unique identifier in the form of an <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-3">IRI</a>.
            Means by which this <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-4">IRI</a> can unambiguously identify a party are further discussed in Section <a class="sec-ref" href="#considerations-iricertlink"><bdi class="secno">A.2 </bdi>Identity Management</a>.
          </dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" id="dfn-resource" tabindex="0">resource</dfn></dt>
<dd>
            A data point or object which can be uniquely identified through an <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-5">IRI</a>.
          </dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" data-plurals="facts" id="dfn-fact" tabindex="0">fact</dfn></dt>
<dd>
<p>
              An immutable revision of a <a class="internalDFN" data-link-type="dfn" href="#dfn-resource" id="ref-for-dfn-resource-1">resource</a>, uniquely and persistently referenced through an <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-6">IRI</a>
              specific to the revision.
              This implies that given the <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-7">IRI</a>, the data identified by the <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-8">IRI</a> cannot be altered.
              In this context, the persistent <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-9">IRI</a> of a fact can also be referred to as a <dfn aria-haspopup="dialog" data-dfn-type="dfn" id="dfn-factid" tabindex="0">FactID</dfn>.
            </p>
<div class="note" id="issue-container-generatedID-0" role="note"><div aria-level="5" class="note-title marker" id="h-note-0" role="heading"><span>Note</span></div><p class="">
              The term originated from <em>FactDAG</em>, a formalization model of data interoperability which was proposed in a research paper by Gleim et al. [<cite><a class="bibref" data-link-type="biblio" href="#bib-factdag" title="FactDAG: Formalizing Data Interoperability in an Internet of Production">FactDAG</a></cite>], where it denotes a data point that was explicitly made immutable by means of a revisioning system.
            </p></div>
</dd>
</dl>
</section>
</section>
<section class="informative" id="primer-example-scenario"><div class="header-wrapper"><h3 id="x3-3-example-scenario"><bdi class="secno">3.3 </bdi>Example Scenario</h3><a aria-label="Permalink for Section 3.3" class="self-link" href="#primer-example-scenario"></a></div><p><em>This section is non-normative.</em></p>
<div class="tlcontent">
<p>
          We employ an example scenario of inter-organizational data sharing in aircraft manufacturing to clarify the concepts and terminology introduced above.
        </p>
<section class="notoc">
<div class="header-wrapper"><h4 id="setup">Setup</h4><a aria-label="Permalink for this Section" class="self-link" href="#setup"></a></div>
<p>
            This example considers the supplier-manufacturer relation in the highly-regulated and safety-critical process of aircraft engineering.
          </p>
<p>
            Three parties are involved in the scenario: Two part suppliers, <i>A-Corp</i> and <i>B-Tech</i>, as well as a manufacturer <i>C-Aviation</i>, which assembles the final product (here: aircraft).
          </p>
<p>
            In this simple scenario, both A-Corp and B-Tech supply parts (wings and propellers) to C-Aviation.
            Additionally, besides a flow of physical products, a dataflow exists in parallel.
            The data might include relevant production data, conformance certificates, etc.
          </p>
<p>In this dataflow, A-Corp and B-Tech are the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-3">senders</a>, and C-Aviation is the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-4">receiver</a>.</p>
<p>
            Further, the precision of the placement of a certain rivet used in a wing by A-Corp might be a <a class="internalDFN" data-link-type="dfn" href="#dfn-resource" id="ref-for-dfn-resource-2">resource</a> as part of the production data shared with C-Aviation.
            By using a revision identifier, e.g., the timestamp of measurement, the <a class="internalDFN" data-link-type="dfn" href="#dfn-resource" id="ref-for-dfn-resource-3">resource</a> can be lifted to an immutable resource revision, i.e., a <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-1">fact</a>.
          </p>
<p>
            The scenario, including the flow of physical goods and data, is visualized below.
          </p>
<figure id="fig-example-scenario-1" style="text-align: center;">
<object aria-describedby="fig-example-scenario-1" data="figures/example-scenario-1.svg" style="width:100%;" type="image/svg+xml"></object>
<p id="fig-example-scenario-1-alt">
              Example scenario in aircraft manufacturing.
            </p>
<figcaption><a class="self-link" href="#fig-example-scenario-1">Figure <bdi class="figno">1</bdi></a> <span class="fig-title">
              The example scenario in aircraft manufacturing.
              Besides a physical dataflow of the suppliers (A and B) to the manufacturer (C), production data is shared with C.
            </span></figcaption>
</figure>
</section>
<section class="notoc">
<div class="header-wrapper"><h4 id="trustworthiness-reliability-through-common-methods">Trustworthiness &amp; Reliability through Common Methods</h4><a aria-label="Permalink for this Section" class="self-link" href="#trustworthiness-reliability-through-common-methods"></a></div>
<p>
            Data shared between the parties is used in processes such as production and audits, which are critical for product safety.
            Thus, it is extremely important that C-Aviation assesses the trustworthiness and reliability of the data.
            These properties can reduce the risk of data-caused damage or shift liability for said damage to the suppliers.
          </p>
<p>
            To establish a common ground of trustworthiness and reliability, C-Aviation agrees upon a conformance agreement in the form of a paper-based contract with its suppliers.
            This practice naturally is a labor-intensive process, as such documents have to be created, sent between the companies, and archived physically.
            Here, the data storage layer comprises physical archives, where the paper-based contracts are stored.
          </p>
</section>
<p>After describing the concept of DTCs in the following, we will discuss an application to this scenario together with corresponding benefits in Section <a class="sec-ref" href="#dtc-example-application"><bdi class="secno">4.2 </bdi>Application to the Example Scenario</a></p>
</div>
</section>
</section>
<section id="digital-transmission-contracts"><div class="header-wrapper"><h2 id="x4-digital-transmission-contracts-dtcs"><bdi class="secno">4. </bdi>Digital Transmission Contracts (DTCs)</h2><a aria-label="Permalink for Section 4." class="self-link" href="#digital-transmission-contracts"></a></div>
<section class="informative" id="dtc-signature-paradigm"><div class="header-wrapper"><h3 id="x4-1-mutual-commitment-through-bilateral-signatures"><bdi class="secno">4.1 </bdi>Mutual Commitment through Bilateral Signatures</h3><a aria-label="Permalink for Section 4.1" class="self-link" href="#dtc-signature-paradigm"></a></div><p><em>This section is non-normative.</em></p>
<div class="tlcontent">
<p>
          DTCs leverage digital signatures to create <a class="internalDFN" data-link-type="dfn" data-lt="immutability" href="#dfn-immutability" id="ref-for-dfn-immutability-1">strong data immutability</a> within a defined scope, which we further describe below.
          DTCs deviate from the common paradigm of document signatures by enforcing the signatures to be created during data transmission, thus allowing to involve a second party, the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-5">receiver</a>, in the signature process.
        </p>
<p>
          For a clear differentiation, we can classify common uses of signatures into one of the following two paradigms:
        </p>
<dl>
<dt><dfn aria-haspopup="dialog" class="lint-ignore" data-dfn-type="dfn" id="dfn-pre-created-signatures" tabindex="0">pre-created signatures</dfn></dt>
<dd>
            Also known as <dfn aria-haspopup="dialog" class="lint-ignore" data-dfn-type="dfn" id="dfn-document-signatures" tabindex="0">document signatures</dfn>, are signatures that are created by the data source (or publisher) and are not bound to a specific transmission.
            Thus, such signatures can be efficiently created on publication and only need to be created once in the lifetime of the document.
            This type of signatures is usually used on data platforms, document stores, etc.
          </dd>
<dt><dfn aria-haspopup="dialog" class="lint-ignore" data-dfn-type="dfn" id="dfn-on-demand-signatures" tabindex="0">on-demand signatures</dfn></dt>
<dd>
            Also known as <dfn aria-haspopup="dialog" class="lint-ignore" data-dfn-type="dfn" id="dfn-message-signatures" tabindex="0">message signatures</dfn>, are signatures that are specific to a single data transmission or communication process.
            Therefore, On-demand signatures cannot be pre-computed in most cases, as they are bound to that specific transmission or communication process.
            On-demand signatures are commonly used to establish authenticity and non-repudiation in messaging and communication protocols, e.g., <a href="https://datatracker.ietf.org/doc/html/rfc4880">OpenPGP</a>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4880" title="OpenPGP Message Format">RFC4880</a></cite>].
          </dd>
</dl>
<div class="note" id="issue-container-generatedID-1" role="note"><div aria-level="4" class="note-title marker" id="h-note-1" role="heading"><span>Note</span></div><p class="">
          The terms of pre-created and on-demand signatures are not canonical, as a clear differentiation between these signature paradigms can rarely be found in literature.
        </p></div>
<p>
          DTCs are linked to a specific data transmission and comprise a signature by both the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-4">sender</a> and the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-6">receiver</a>.
          Therefore, the signatures cannot be pre-computed during publishing, i.e., they are <a class="internalDFN" data-link-type="dfn" href="#dfn-on-demand-signatures" id="ref-for-dfn-on-demand-signatures-1">on-demand signatures</a>.
        </p>
<p>
          Because the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-7">receiver</a> signs the state of the data, the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-5">sender</a> alone cannot forge a valid DTC by itself.
          Therefore, as long as <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-6">sender</a> and <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-8">receiver</a> do not collude to forge rogue signature pairs, the valid DTC can unambiguously be determined by the pair of valid signatures by both parties.
          Thus, this approach provides <a class="internalDFN" data-link-type="dfn" data-lt="immutability" href="#dfn-immutability" id="ref-for-dfn-immutability-2">strong data immutability</a> under the assumption of no inter-party collusion.
        </p>
<p>
          While the assumption of no inter-party collusion may seem limiting at first, it still covers a substantial set of use cases, i.e., inter-party conflicts of <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-7">sender</a> and <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-9">receiver</a>.
          Thus, DTCs can be applied wherever <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-8">sender</a> and <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-10">receiver</a> do not trust each other and want to have mutual proof of the data sharing process.
          In our example from Section <a class="sec-ref" href="#primer-example-scenario"><bdi class="secno">3.3 </bdi>Example Scenario</a>, this assumption covers a variety of possible scenarios, including proving data authenticity in liability conflicts and creating secure and non-repudiable product conformance and quality certificates between C-Aviation and the two suppliers.
        </p>
<p>
          If the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-11">receiver</a> would not sign the DTC, the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-9">sender</a> could create signatures for arbitrary data.
          If a rogue <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-10">sender</a> would now sign different versions of the same <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-2">fact</a>, the correct version of the <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-3">fact</a> would become ambiguous, thus violating the <a class="internalDFN" data-link-type="dfn" data-lt="immutability" href="#dfn-immutability" id="ref-for-dfn-immutability-3">data immutability</a>.
        </p>
<p>
          In the example from Section <a class="sec-ref" href="#primer-example-scenario"><bdi class="secno">3.3 </bdi>Example Scenario</a>, the production data of a propeller supplied by B-Tech may hint at a production fault that leads to an incident with the respective airplane.
          During the incident inspection and liability process, B-Tech might now supply corrected data together with valid certificates and thereby claim that the supplied parts were not faulty to the best of their knowledge.
          The data immutability is violated in this case, as one cannot unambiguously determine the original version of B-Tech's production data.
        </p>
</div>
</section>
<section class="informative" id="dtc-example-application"><div class="header-wrapper"><h3 id="x4-2-application-to-the-example-scenario"><bdi class="secno">4.2 </bdi>Application to the Example Scenario</h3><a aria-label="Permalink for Section 4.2" class="self-link" href="#dtc-example-application"></a></div><p><em>This section is non-normative.</em></p>
<div class="tlcontent">
<p>
          In Section <a class="sec-ref" href="#primer-example-scenario"><bdi class="secno">3.3 </bdi>Example Scenario</a>, we introduced an exemplary scenario from the aviation industry.
          The original process relied on costly and management-intensive paper-based contracting and archiving methods.
        </p>
<p>
          If the concept of DTCs is applied to the exemplary data sharing process, substantial parts of the system can be implemented digitally.
          These parts comprise of
        </p><ul>
<li>the contracts, in which an agreement about the data transmission is made, including the signatures by both parties, and</li>
<li>the storage system for storing and archiving the transmission contracts.</li>
</ul>
<p>
          The application of DTCs within the data sharing process is visualized below.
        </p>
<figure id="fig-example-scenario-2" style="text-align: center;">
<object aria-describedby="fig-example-scenario-2" data="figures/example-scenario-2.svg" style="width:100%;" type="image/svg+xml"></object>
<p id="fig-example-scenario-2-alt">
            Application of DTCs to the example scenario in aviation.
          </p>
<figcaption><a class="self-link" href="#fig-example-scenario-2">Figure <bdi class="figno">2</bdi></a> <span class="fig-title">
            The application of DTCs to the example scenario in the aviation industry.
            DTCs (1) are certified by sender and receiver, (2) secure the transmitted data, and (3) are stored (longtime) in digital secure storage systems.
          </span></figcaption>
</figure>
<p>
          In the example scenario, a DTC is linked to all three layers of the data sharing process:
        </p><ol>
<li>
<b>Physical layer:</b> <br/>
            The parties A-Corp and C-Aviation both certify (1) the DTC by adding a digital signature.
            Both parties are linked to their physical identities by a public key certificate (see Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a> for details).
            Further, the production data produced by factories is secured in the DTC (2).
          </li>
<li>
<b>Data Storage layer:</b> <br/>
            Both parties can store the DTC to profit from its benefits in later situations, including audits and liability conflicts.
            In the example of aircraft manufacturing, the parties are even required legally to securely store the contracts for several years.
          </li>
<li>
<b>Dataflow layer:</b> <br/>
            The DTC itself is constructed in parallel to the underlying production data transmission in a generation handshake (see Section <a class="sec-ref" href="#dtcgenver-generation"><bdi class="secno">6.1 </bdi>DTC Generation Handshake</a> for details).
          </li>
</ol>
</div>
</section>
<section id="dtc-data-structure"><div class="header-wrapper"><h3 id="x4-3-dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</h3><a aria-label="Permalink for Section 4.3" class="self-link" href="#dtc-data-structure"></a></div>
<div class="tlcontent">
<p>
          DTCs have a defined object structure.
          Its components are defined as <dfn aria-haspopup="dialog" data-dfn-type="dfn" id="dfn-contract-fields" tabindex="0">contract fields</dfn>.
        </p>
<p>
          In the following, we define the content and substructure of the <a class="internalDFN" data-link-type="dfn" href="#dfn-contract-fields" id="ref-for-dfn-contract-fields-1">contract fields</a>.
          All fields not explicitly marked as optional <em class="rfc2119">MUST</em> be present in any valid DTC.
          A valid DTC <em class="rfc2119">MUST NOT</em> contain any fields which are not specified below.
        </p>
<div class="note" id="issue-container-generatedID-2" role="note"><div aria-level="4" class="note-title marker" id="h-note-2" role="heading"><span>Note</span></div><p class="">
          To disambiguate between the terms defined in Section <a class="sec-ref" href="#primer-terminology"><bdi class="secno">3.2 </bdi>Terminology</a> and the contract fields above, contract fields are always typeset as red-orange monospace font, e.g., <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-11">sender</a>
          vs <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-1"><code>sender</code></a>).
        </p></div>
<dl>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" data-lt="dtc-baseIRI" data-lt-nodefault="" id="dfn-dtc-baseiri" tabindex="0"><code>baseIRI</code></dfn></dt>
<dd>
<p>
              The base <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-10">IRI</a> which can be used to uniquely identify the DTC.
            </p>
<p>
              The base <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-11">IRI</a> is selected by the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-12">sender</a> or <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-12">receiver</a> during the DTC generation handshake (see Section <a class="sec-ref" href="#dtcgenver-generation"><bdi class="secno">6.1 </bdi>DTC Generation Handshake</a>) and is used as both the <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-12">IRI</a> for the DTC itself, as well as an <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-13">IRI</a> prefix for its subcomponents in the JSON-LD representation (see Section <a class="sec-ref" href="#dtc-representations-jsonld"><bdi class="secno">4.4.2 </bdi>JSON-LD</a>)
            </p>
<p>
              The base <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-14">IRI</a> <em class="rfc2119">SHOULD</em> end with a <code>#</code> delimiter, i.e., the <code>"#" ifragment</code> part,
              where <code>ifragment</code> is empty, such that the sub-IRIs assigned in the <a href="#dtc-representations-jsonld">JSON-LD representation</a> (Section <a class="sec-ref" href="#dtc-representations-jsonld"><bdi class="secno">4.4.2 </bdi>JSON-LD</a>) use the <code>ifragment</code> part to identify the subcomponent.
            </p>
</dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" data-lt="dtc-sender" data-lt-nodefault="" id="dfn-dtc-sender" tabindex="0"><code>sender</code></dfn></dt>
<dd>
<p>
              Identity of the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-13">sender</a>, i.e., the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-14">sender</a>'s <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-15">IRI</a> and a public key certificate.
              The <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-16">IRI</a> uniquely links the DTC to the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-15">sender</a>, and the public key certificate contains the public key needed to verify the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-16">sender</a>'s signature contained in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-senderSig" href="#dfn-dtc-sendersig" id="ref-for-dfn-dtc-sendersig-1"><code><code>senderSig</code></code></a>.
            </p>
<p>The <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-2"><code><code>sender</code></code></a> field has the following subcomponents:</p>
<dl>
<dt><code>authID</code></dt>
<dd>
                The <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-17">IRI</a> of the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-17">sender</a>.
                <em class="rfc2119">SHOULD</em> be related to the public key certificate contained in the <code>cert</code> field.
                A discussion on linking the certificate to the authority <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-18">IRI</a> can be found in Section <a class="sec-ref" href="#considerations-iricertlink"><bdi class="secno">A.2 </bdi>Identity Management</a>.
              </dd>
<dt><code>cert</code></dt>
<dd>
                An X.509 public key certificate or certificate chain of the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-18">sender</a>.
                The verification of the certificate (chain) requires a shared trust anchor (e.g., a commonly trusted root CA).
              </dd>
<dt><code>type</code></dt>
<dd><code>"X509"</code>/<code>"X509-single"</code> for a single X.509 certificate,
                <code>"PKCS7"</code>/<code>"X509-PKCS7-chain"</code> for a certificate chain bundled into a <a href="https://datatracker.ietf.org/doc/html/rfc2315">PKCS #7</a> message [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2315" title="PKCS #7: Cryptographic Message Syntax Version 1.5">RFC2315</a></cite>].
                These two types <em class="rfc2119">MUST</em> be implemented.
                While we do not specify other types in this document, this field can be used to implement different certificate types in future extensions.
              </dd>
<dt><code>encoding</code></dt>
<dd>Encoding of the certificate.
                Always set to <code>"base64"</code>, which refers to the certificate (chain) in DER notation encoded using <a href="https://datatracker.ietf.org/doc/html/rfc4648#section-4">Base64</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4648" title="The Base16, Base32, and Base64 Data Encodings">RFC4648</a></cite>].
                The purpose of this field is both for the data structure to be self-describing and to allow for possible extensions of other encodings.
              </dd>
</dl>
</dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" data-lt="dtc-receiver" data-lt-nodefault="" id="dfn-dtc-receiver" tabindex="0"><code>receiver</code></dfn></dt>
<dd>
<p>
              Identity of the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-13">receiver</a>, i.e., an <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-19">IRI</a> and a public key certificate.
              The <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-20">IRI</a> uniquely links the DTC to the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-14">receiver</a>, and the public key certificate contains the public key needed to verify the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-15">receiver</a>'s signature contained in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiverSig" href="#dfn-dtc-receiversig" id="ref-for-dfn-dtc-receiversig-1"><code><code>receiverSig</code></code></a>.
            </p>
<p>The substructure is equivalent to the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-3"><code><code>sender</code></code></a> field.</p>
</dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" data-lt="dtc-senderSig" data-lt-nodefault="" id="dfn-dtc-sendersig" tabindex="0"><code>senderSig</code></dfn></dt>
<dd>
<p>
              The contract signature created by the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-19">sender</a> according to Section <a class="sec-ref" href="#dtc-signatures-creation"><bdi class="secno">4.5.3 </bdi>Signature Creation</a>.
            </p>
<p>
              The <a class="internalDFN" data-link-type="dfn" data-lt="dtc-senderSig" href="#dfn-dtc-sendersig" id="ref-for-dfn-dtc-sendersig-2"><code><code>senderSig</code></code></a> field has the following subcomponents:
            </p>
<dl>
<dt><code>sig</code></dt>
<dd>The signature data, encoded as a string according to the <code>encoding</code> field (see below).</dd>
<dt><code>type</code></dt>
<dd>
                The signature type used.
                <em class="rfc2119">MUST</em> always be set to <code>"urn:oid:1.2.840.113549.1.1.10"</code>, which is the <a href="https://datatracker.ietf.org/doc/html/rfc3061">Object Identifier (OID)</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3061" title="A URN Namespace of Object Identifiers">RFC3061</a></cite>] of the <a href="https://datatracker.ietf.org/doc/html/rfc8017#section-8.1"><code>RSASSA-PSS</code></a>
                signature scheme as defined in <a href="https://datatracker.ietf.org/doc/html/rfc8017#section-8.1">PKCS #1 v2.2</a>
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8017" title="PKCS #1: RSA Cryptography Specifications Version 2.2">RFC8017</a></cite>].
                We use the <a href="https://www.rfc-editor.org/rfc/rfc3001">URN Namespace of Object Identifiers</a>
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3001" title="A URN Namespace of Object Identifiers">RFC3001</a></cite>] to make the identifier interpretable as an IRI.
                The purpose of this field is both for the data structure to be self-describing and to allow for possible extensions of other signature schemes.
              </dd>
<dt><code>encoding</code></dt>
<dd>
                Encoding of the signature data.
                <em class="rfc2119">MUST</em> always be set to <code>"base64"</code>, specifying that the signature value is encoded using <a href="https://datatracker.ietf.org/doc/html/rfc4648#section-4">Base64</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4648" title="The Base16, Base32, and Base64 Data Encodings">RFC4648</a></cite>] according to Section <a class="sec-ref" href="#dtc-signatures-creation"><bdi class="secno">4.5.3 </bdi>Signature Creation</a>.
                The purpose of this field is both for the data structure to be self-describing and to allow for possible extensions of other encodings.
              </dd>
</dl>
</dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" data-lt="dtc-receiverSig" data-lt-nodefault="" id="dfn-dtc-receiversig" tabindex="0"><code>receiverSig</code></dfn></dt>
<dd>
            Contract signature created by the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-16">receiver</a>.
            Analogous to <a class="internalDFN" data-link-type="dfn" data-lt="dtc-senderSig" href="#dfn-dtc-sendersig" id="ref-for-dfn-dtc-sendersig-3"><code>senderSig</code></a>.
          </dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" data-lt="dtc-facts" data-lt-nodefault="" id="dfn-dtc-facts" tabindex="0"><code>facts</code></dfn></dt>
<dd>
<p>
              A set of one or more <em>fact checksums</em>.
            </p>
<p>
              This field binds the DTC to the state of the transmitted data by including <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-4">fact</a> checksums, which are implemented using cryptographic hash functions.
            </p>
<p>
              Any implementation <em class="rfc2119">SHOULD</em> interpret this field as an unordered list.
              Whenever a canonical representation is needed, the set <em class="rfc2119">MUST</em> be transformed into an ordered list by sorting the elements lexicographically by <a class="internalDFN" data-link-type="dfn" data-lt="dtc-factID" href="#dfn-factid" id="ref-for-dfn-factid-1">factID</a> in the <a href="https://datatracker.ietf.org/doc/html/rfc3629">UTF-8</a> encoding [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3629" title="UTF-8, a transformation format of ISO 10646">RFC3629</a></cite>] (e.g., see Section <a class="sec-ref" href="#dtc-signatures-preprocessing"><bdi class="secno">4.5.2 </bdi>Pre-Processing</a>).
            </p>
<p>A single <em>fact checksum</em> has the following subcomponents:</p>
<dl>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" data-lt="dtc-facts-factID" data-lt-nodefault="" id="dfn-dtc-facts-factid" tabindex="0"><code>factID</code></dfn></dt>
<dd>
                The <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-21">IRI</a> of the <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-5">fact</a>.
                <em class="rfc2119">MUST</em> be unique in the set of <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-1"><code>facts</code></a>.
              </dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" data-lt="dtc-facts-requestedID" data-lt-nodefault="" id="dfn-dtc-facts-requestedid" tabindex="0"><code>requestedID</code></dfn></dt>
<dd>
<em>(Optional)</em>
                During the DTC generation mechanism (cf. Section <a class="sec-ref" href="#dtcgenver-generation"><bdi class="secno">6.1 </bdi>DTC Generation Handshake</a>), the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-20">sender</a> <em class="rfc2119">MAY</em> update the <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-22">IRI</a> in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-factID" href="#dfn-dtc-facts-factid" id="ref-for-dfn-dtc-facts-factid-1"><code>factID</code></a> (e.g., in order to provide a persistent fact IRI for long-term referenceability).
                In this case, this field contains the <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-23">IRI</a> which was originally requested.

                <div class="note" id="issue-container-generatedID-3" role="note"><div aria-level="4" class="note-title marker" id="h-note-3" role="heading"><span>Note</span></div><div class="">
<p>
                    The procedure of updating the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-factID" href="#dfn-dtc-facts-factid" id="ref-for-dfn-dtc-facts-factid-2"><code>factID</code></a> is included to support <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-factIR" href="#dfn-factid" id="ref-for-dfn-factid-2">factID</a> negotiation.
                    Example scenarios:
                  </p>
<ul>
<li>
                      The <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-17">receiver</a> does not know the revision ID, which transforms a <a class="internalDFN" data-link-type="dfn" href="#dfn-resource" id="ref-for-dfn-resource-4">resource</a> to a <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-6">fact</a> by means of an immutable revisioning scheme, and thus only requests the latest revision of a <a class="internalDFN" data-link-type="dfn" href="#dfn-resource" id="ref-for-dfn-resource-5">resource</a>.
                      The <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-21">sender</a> adds the latest revision ID to the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-factID" href="#dfn-dtc-facts-factid" id="ref-for-dfn-dtc-facts-factid-3"><code>factID</code></a> to identify an immutable <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-7">fact</a>.
                    </li>
<li>
                      The <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-18">receiver</a> uses a deprecated <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-8">fact</a> identification scheme.
                      The <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-22">sender</a> can transform the deprecated <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-factID" href="#dfn-dtc-facts-factid" id="ref-for-dfn-dtc-facts-factid-4"><code>factID</code></a> into a new one.
                    </li>
</ul>
</div></div>
</dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" data-lt="dtc-facts-alg" data-lt-nodefault="" id="dfn-dtc-facts-alg" tabindex="0"><code>&lt;alg&gt;</code></dfn></dt>
<dd>
<p>
                  The checksum, created by hashing a serialization of the <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-9">fact</a>.
                </p>
<p>
                  The hash algorithm <em class="rfc2119">MUST</em> be specified through the field name, i.e., <code>&lt;alg&gt;</code> <em class="rfc2119">MUST</em> be replaced by one of the supported algorithms listed below.
                </p>
<p>
                  The hash values <em class="rfc2119">MUST</em> be encoded as a hexadecimal string, i.e., using digits and the letters a-f or A-F.
                  The encoding <em class="rfc2119">SHOULD</em> use lowercase letters.
                </p>
<p>
                  The supported hash algorithms are cryptographic hash functions, so that an attacker cannot forge data that collides with the checksum.
                  Such a vulnerability could lead to misuse of existing DTCs, or ambiguity w.r.t. the verifiability of the underlying data.
                </p>
<p>
                  Currently supported algorithms:
                </p><ul>
<li><code>sha256</code>, <code>sha384</code>, <code>sha512</code>: Variants of <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">SHA-2</a> <cite><a data-matched-text="[[[FIPS-180-4]]]" href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">FIPS PUB 180-4: Secure Hash Standard (SHS)</a></cite></li>
</ul>
</dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" data-lt="dtc-facts-serialization" data-lt-nodefault="" id="dfn-dtc-facts-serialization" tabindex="0"><code>serialization</code></dfn></dt>
<dd>
                A serialization identifier.
                In this document, we specify a baseline set of serialization identifiers.
                Every implementation <em class="rfc2119">MUST</em> be able to interpret these serialization identifiers.
                Extensions to these identifiers <em class="rfc2119">MAY</em> be specified in the future.
                <ul>
<li><code>"binary"</code>: A (trivial) binary representation of the <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-10">fact</a></li>
<li><code>"string"</code>: A (trivial) string representation of the <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-11">fact</a></li>
<li><code>"canonical_json"</code>: A representation of the <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-12">fact</a> as canonicalized JSON according to the <a href="https://datatracker.ietf.org/doc/html/rfc8785">JSON Canonicalization Scheme (JCS)</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8785" title="JSON Canonicalization Scheme (JCS)">RFC8785</a></cite>].</li>
<li><code>"URDNA2015"</code>: The Linked Data associated with a <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-13">fact</a>, serialized as normalized N-Quads [<cite><a class="bibref" data-link-type="biblio" href="#bib-n-quads" title="RDF 1.1 N-Quads">N-Quads</a></cite>] according to the <a href="https://json-ld.github.io/rdf-dataset-canonicalization/spec/index.html">URDNA2015</a>
                    algorithm.
                    <div class="note" id="issue-container-generatedID-4" role="note"><div aria-level="4" class="note-title marker" id="h-note-4" role="heading"><span>Note</span></div><p class="">
                      We recognize that Linked Data canonicalization is an open issue, and the specification of the specified algorithm is at a draft status.
                      As the algorithm is not a direct component of <em>ReShare</em>, and we argue for an extensible serialization identifier scheme, we consider this remark to be tolerable.
                    </p></div>
</li>
</ul>
                A <em>trivial</em> serialization of a given resource <em class="rfc2119">MUST</em> be interpretable without the need to perform any transformations.
                E.g., if the fact is a JPEG image, the binary serialization (identified by the <code>"binary"</code>
                identifier) can be considered trivial, as JPEG is a binary file format and does not need to be transformed.
                A JSON document, however, cannot be trivially serialized as a binary object without transformations, as the choice of the character set, the canonicalization scheme, etc. are ambiguous.
              </dd>
</dl>
</dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" data-lt="dtc-customContent|senderCustomContent/receiverCustomContent" id="dfn-dtc-customcontent" tabindex="0"><code>senderCustomContent</code>/<code>receiverCustomContent</code></dfn>
</dt>
<dd>
<p><em>(Optional)</em> DTC fields that <em class="rfc2119">MAY</em> be used to add custom content or metadata to a DTC as a JSON object.</p>
<p>If one of these fields is present, it <em class="rfc2119">MUST</em> contain exactly one JSON object (i.e., enclosed by curly brackets).</p>
</dd>
<dt><dfn aria-haspopup="dialog" data-dfn-type="dfn" data-lt="dtc-timestamp" data-lt-nodefault="" id="dfn-dtc-timestamp" tabindex="0"><code>timestamp</code></dfn></dt>
<dd>
            A timestamp that binds the DTC to the time of transmission. Specifically, it binds to the point in time during DTC generation, where one of the two involved parties adds the fact checksums to the DTC.
            The timestamp is encoded as a string in the <a href="https://datatracker.ietf.org/doc/html/rfc3339#section-5.6">Internet date/time format</a>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3339" title="Date and Time on the Internet: Timestamps">RFC3339</a></cite>], which is a profile of <a href="http://www.iso.org/iso/catalogue_detail?csnumber=40874">ISO 8601</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso8601" title="Representation of dates and times. ISO 8601:2004.">ISO8601</a></cite>].
          </dd>
</dl>
</div>
</section>
<section id="dtc-representations"><div class="header-wrapper"><h3 id="x4-4-dtc-representations"><bdi class="secno">4.4 </bdi>DTC Representations</h3><a aria-label="Permalink for Section 4.4" class="self-link" href="#dtc-representations"></a></div>
<div class="tlcontent">
<p>
          By default, DTCs are represented as JSON [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC8259</a></cite>].
          To make DTCs interpretable as Linked Data, we further define an associated JSON-LD [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>] context.
          We deem JSON the default representation, as it can be transformed to the JSON-LD representation without context by the procedure defined below, and thus reduces the overhead in storage and transmission of (partial)
          DTCs.
        </p>
<p>
          Any implementation <em class="rfc2119">MUST</em> support the creation, validation, and interpretation of the JSON DTC representation, which we describe in Section <a class="sec-ref" href="#dtc-representations-json"><bdi class="secno">4.4.1 </bdi>JSON</a>.
        </p>
<p>
          Implementations <em class="rfc2119">MAY</em> support the transformations from and to JSON-LD.
          In this case, these transformations <em class="rfc2119">MUST</em> be implemented according to Section <a class="sec-ref" href="#dtc-representations-jsonld"><bdi class="secno">4.4.2 </bdi>JSON-LD</a>.
        </p>
</div>
<section id="dtc-representations-json"><div class="header-wrapper"><h4 id="x4-4-1-json"><bdi class="secno">4.4.1 </bdi>JSON</h4><a aria-label="Permalink for Section 4.4.1" class="self-link" href="#dtc-representations-json"></a></div>
<p>
          We define a default JSON representation for DTCs.
          Every contract field is represented by a root-level submember of a JSON object.
          The content of each field and sub-field is described above in Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
        </p>
<p>
          To specify the structure of the JSON representation of a DTC, we build upon the specification of <a href="https://json-schema.org/draft/2020-12/json-schema-core.html">JSON Schema</a>
          [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-schema" title="JSON Schema: A Media Type for Describing JSON Documents">JSON-SCHEMA</a></cite>][<cite><a class="bibref" data-link-type="biblio" href="#bib-json-schema-validation" title="JSON Schema Validation: A Vocabulary for Structural Validation of JSON">JSON-SCHEMA-VALIDATION</a></cite>].
          While we recognize that this specification is still in a draft state, we find this tolerable due to the nature of this document being a member submission.
          We further specifically use the <code>2020-12</code> version of the draft of <a href="https://json-schema.org/draft/2020-12/json-schema-core.html">JSON Schema</a> to avoid ambiguities.
        </p>
<p>
          We define three schemas: The schema for a <a class="external" href="schemas/partial_dtc.schema.json" target="_blank">partial DTC</a>, the schema for a <a class="external" href="schemas/dtc.schema.json" target="_blank">complete DTC</a>, and the schema for a <a class="external" href="schemas/dtc_only_signatures_missing.schema.json" target="_blank">partial DTC, where only the two signatures may be missing</a>.
          The two latter schemas extend the <a class="external" href="schemas/partial_dtc.schema.json" target="_blank">partial DTC schema</a> by requiring the fields to be present.
        </p>
<p>
          For a JSON representation of a DTC to be syntactically valid, a JSON schema validator implemented according to the <code>2020-12</code> version of JSON schema <em class="rfc2119">MUST</em> successfully test the JSON representation to the JSON schema of a complete DTC.
        </p>
<p>
          In the following, we give an example of a complete DTC as a JSON object, according to the descriptions above.
          The contract contains four <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-14">fact</a> checksums (in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-2"><code>facts</code></a>), where the <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-15">fact</a>
          itself could trivially be serialized as a string.
          The public key certificates (in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-4"><code>sender</code></a> and <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-5"><code>receiver</code></a>)
          are single X.509 certificates directly signed by an imaginary root CA.
        </p>
<div class="example" id="example-example-dtc-json-non-normative">
<div class="marker">
<a class="self-link" href="#example-example-dtc-json-non-normative">Example<bdi> 1</bdi></a><span class="example-title">: Example DTC (JSON) (non-normative)</span>
</div> <pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"baseIRI"</span>: <span class="hljs-string">"https://example.com/contracts/2021-09-24/134"</span>,
  <span class="hljs-attr">"sender"</span>: {
    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"X509"</span>,
    <span class="hljs-attr">"encoding"</span>: <span class="hljs-string">"base64"</span>,
    <span class="hljs-attr">"cert"</span>: <span class="hljs-string">"MIIEkTCCAnmgAwIBAgIUTpTAugWv4ZYQX9nk2zETfVcMi38wDQYJKoZIhvcNAQELBQAwTDELMAkGA1UEBhMCREUxEzARBgNVBAgMClNvbWUtU3RhdGUxEzARBgNVBAoMCkV4YW1wbGUgQ0ExEzARBgNVBAMMCkV4YW1wbGUgQ0EwHhcNMjEwNDE1MjExMTExWhcNMjIwNDE1MjExMTExWjAzMR0wGwYDVQQKDBRFeGFtcGxlIGNoYWluIGNlcnQgMTESMBAGA1UEAwwJbG9jYWxob3N0MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvw8C6sqLUVSOwFPbZsqS/1cL/+7aaaxVPwXs7TjPVombwNLyJW8yPyyQLbsTN5evVCpNdzciYc9Nhh77AYrqCiOsZBb7hu/PMqNqDvU2FAHeTH9KZ1PSpsOdgzG4i9widL6FBKGrxvlyj0G5ztQoGtymJFdmQ8K/ZN2W5Bi27H24UgITO+mX5MGmzFfyib7bDnvNqZUMJEgpSGt+jUf/7pMtuQqusrE1bfg5vvCbHIPHx2KXqzQEjNiioDafzKjIY2NSakis1AZe+J46o/Za0L8TUMXPvO1nSX4VMm9w5Qqf8auKdlUnT7fVqGKxQvPgX/JM/ksduZqZdTE1giWDgQIDAQABo4GDMIGAMB0GA1UdDgQWBBQtTnbTodwlQnP0QXA2VRv6DBWgzzAfBgNVHSMEGDAWgBR+/85DLJ8v0EP1y6kv/I9XPsHQ5TAPBgNVHRMBAf8EBTADAQH/MA4GA1UdDwEB/wQEAwIBhjAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUHAwEwDQYJKoZIhvcNAQELBQADggIBAG47hxcjEY6kXojCadK15iW5t6P2p2NCfXpymeRuVaHiI7hhMwQEPymGqXZe0MKUKaRxb9BssG9UvndJw7PWdLx55Y498dgEVXWp7UWUg+VmLxE0wrS+7odJ6ZwsSTPhlgQVF3y9SOP18UX1Iy+ipkdPVbeiQB2QJOYLdxj3h26a/BevyWJU7jTbZO9fNX3FlopyQbB64QPJKJyQiYrT1td7lOcreyBJUS2e5p+hifW/ukxHQ9QtfN+mE/MlnUSHar6LgXPX3AoiVKc14L5E7jRHLDCvFWO1PfVCsS6RWIKdoWsEUytDnMYLHb2TmMJWQf8S69BLyqgEhKXNS9hZceGr32jM9O6TepYKZNH5A1QLjZcuHHKUAzXMjM9loNLra/VGcqrMTdZYautGl8EdEURqE063qDd+Hsp3Vqw0iALQHcbEb6R1b2o5dIrczo+PINTSvnFv+4GyqznXEYjcueLrR/R6kE9GNOiPUxpont+0s1JCAKPaaZk97Z09ldtD47rPQLQgWopDadVOm3Gu9+ef7uqqpJw9+q384mqgw4P1Yws6aVkXLdvh8MCXcMEYi2AeQVCCZv2CjAh8CZQC+0P2JtkhWlCxPoSDk4jbm6koCxcpL3CRcc5LtTTrev5+Mi0oDMiLzx09GNls3SQzdKdP9PM+Y7E7y4Xi2LW3FtoG"</span>,
    <span class="hljs-attr">"authID"</span>: <span class="hljs-string">"http://example.com/sender"</span>
  },
  <span class="hljs-attr">"receiver"</span>: {
    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"X509"</span>,
    <span class="hljs-attr">"encoding"</span>: <span class="hljs-string">"base64"</span>,
    <span class="hljs-attr">"cert"</span>: <span class="hljs-string">"MIIEkTCCAnmgAwIBAgIUTpTAugWv4ZYQX9nk2zETfVcMi4AwDQYJKoZIhvcNAQELBQAwTDELMAkGA1UEBhMCREUxEzARBgNVBAgMClNvbWUtU3RhdGUxEzARBgNVBAoMCkV4YW1wbGUgQ0ExEzARBgNVBAMMCkV4YW1wbGUgQ0EwHhcNMjEwNDE1MjExNDM1WhcNMjIwNDE1MjExNDM1WjAzMR0wGwYDVQQKDBRFeGFtcGxlIGNoYWluIGNlcnQgMTESMBAGA1UEAwwJbG9jYWxob3N0MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuKe4H5GwuaKS02s6oAnQF0e30TLyB3joT5GNzwa94WXuLjU8SWKqOjLQyIN2ZBtZW1jNI3By6nsPoU3t181SBStFI25JZ8PUvJ9/Skf/adRmrtXHX8MYRBqN4d1JIRdOoLxwq+bI0UIyMmMNMTjvhnWwTx4FkXwup5fna9FFBbtOGP+7vMVl98L2/bDMJwwLdnzUs0CKLyqDRx0XWAnp6R6CN9YDeMgpdDviMkBfeY74AJ084v6pWnx+K0PlUuQAkiuPvcRsDxgjHRO18rq4wA6Dxh6My7Xh/uHFzb5cmLT7C7kfr+WN26va8IRGCF8NWdOYQ0HSo/vbY/eIOB/G0wIDAQABo4GDMIGAMB0GA1UdDgQWBBSmlyw0Ht9gF3rnI42Us1dK9+jZ/DAfBgNVHSMEGDAWgBR+/85DLJ8v0EP1y6kv/I9XPsHQ5TAPBgNVHRMBAf8EBTADAQH/MA4GA1UdDwEB/wQEAwIBhjAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUHAwEwDQYJKoZIhvcNAQELBQADggIBABMLMfSOAwk34LEK9L/A1qtHTJPQ2BF3XjnbswINNao0oOI3PSWKU0weWYlITH29hgyzrwO8A9ifaOFPtsRxe9/UNv6RNqwObLpxF+f2U3ulu2hTzd7l/ZXUGYaBUHLL3Cu1JlZWMRoTUBUHAvkwnQlUkQLJZ7A+N9y+FfV5apIMTwPA+C2lwiVtEd3Hje5Z9lUmjwiARRnsliRuCm2ZY0IHvneQN7NnOFCFFQQnu/7wMEywNWR3NMtj5AcMugs56OqcAglwq+HqYNCUkelt1/I7A/NwitaPEYu/1TDjQBckR6nbtJwHKFx2M9heB+E5iMI65r+ae01jBr+r7tes6UdEz7SCF3xHks3ubKfRQykZzTZ7ixeHYG5XjaUSSk8EDuBCdZOJ/AUAA+Rar/UPODUd1YQUZDUqs0MvB9zXQYBtEhwii75pCmkFBpZewo6xyktdP3964q7MZPZQZTZimh02CxcWdXZj6JkoL6ihuM36UciS9rXUgIGGdJcbhC5mP/PqRYsAzipOvQiRL7mGRB9L8H0Wt08yl3H0KFwGcgasML8tOOkf+4MsGIHJZaJ20cVfdWm1StOtLN1Bn+gAppq8nlvDgPiQ3NxSsvY+Qpb0WSVWknc1VyOPKexKaM20/alMv/fykVhVmmAcNVshIMAuKV5TnhqeZyg8L02pVAHL"</span>,
    <span class="hljs-attr">"authID"</span>: <span class="hljs-string">"http://example.com/receiver"</span>
  },
  <span class="hljs-attr">"senderSig"</span>: {
    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"urn:oid:1.2.840.113549.1.1.10"</span>,
    <span class="hljs-attr">"encoding"</span>: <span class="hljs-string">"base64"</span>,
    <span class="hljs-attr">"sig"</span>: <span class="hljs-string">"S82Al/YgpfjywjagQ03tjr8WT2oiMSkuYGA5hoXL/LCZHJhR4UGuXyQe1lJ6+yDRiN8FbKcp6ZrClb645rKpIK9UP/Y50wOo/vXCdeUGRqWj4NduoJsBKAP9O4QfQQkT9POHwcbYDsbvEGm3M7fh7mrOn6PzQQgq8vNGayVP5VmFLofxhArc2cy7/TthDl5sBwngpIokHUGOIE+RXasifJ/KS+DALU2s51EZzP2NuTbOvC2328UD5yhvHTopwqn3OrMWbKjF8UUDFjQHYx383hrK3VPjqfrMMNT3OHiJB6t9pJwZ3lmD3PV0Axp6k1XV+oxckBaYN7dCNneQn+zkcw=="</span>
  },
  <span class="hljs-attr">"receiverSig"</span>: {
    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"urn:oid:1.2.840.113549.1.1.10"</span>,
    <span class="hljs-attr">"encoding"</span>: <span class="hljs-string">"base64"</span>,
    <span class="hljs-attr">"sig"</span>: <span class="hljs-string">"P70POEihM3V+pX+lPmvyoDzhERRuuat4P+jGIN/ME1n4hrl9vHb7l8yXy04iT2lNRXv2wkPfPC55nNCTCjWkPhF9Ca6KM6km0BHanPT9J7DZYuCes3RiPwEqO2UsVVZMxj/kMpwu0X23+SHjpAycGY7M/ZRG5iasQiu4N4f/O6pmNTOE6AqpgdhqACqUInbCN3afbdIUnFdbQSRn16VKmrmgUtus5XrVMsCEEZ3xlw8Pl+1toHgWllK4bnm3+DO4wdNb9wvM5TMrqCGHGZOkkxdlZ2pK3uSHuWtvifA49Ks113giNz6ZNjbWvmq9AJRY8/qVQUCBwZaBeSBqZRUMMw=="</span>
  },
  <span class="hljs-attr">"facts"</span>: [
    {
      <span class="hljs-attr">"factID"</span>: <span class="hljs-string">"http://example.com/facts/fact1"</span>,
      <span class="hljs-attr">"sha256"</span>: <span class="hljs-string">"5fc62b0e99a143ff2b99b56a6953f07e96f52023aa3739bba3fec1194292f48e"</span>,
      <span class="hljs-attr">"serialization"</span>: <span class="hljs-string">"string"</span>
    },
    {
      <span class="hljs-attr">"factID"</span>: <span class="hljs-string">"http://example.com/facts/fact2"</span>,
      <span class="hljs-attr">"sha256"</span>: <span class="hljs-string">"828bbc97b5b866992dc8bc532265e3094bc9e17cce05e16d90844d2160ad99cf"</span>,
      <span class="hljs-attr">"serialization"</span>: <span class="hljs-string">"string"</span>
    },
    {
      <span class="hljs-attr">"factID"</span>: <span class="hljs-string">"http://example.com/facts/fact3"</span>,
      <span class="hljs-attr">"sha256"</span>: <span class="hljs-string">"c646cfa0feda9af766e6eca97f8578f3eb2b126d2349ea7ce1fd2d3b3fe2d456"</span>,
      <span class="hljs-attr">"serialization"</span>: <span class="hljs-string">"string"</span>
    },
    {
      <span class="hljs-attr">"factID"</span>: <span class="hljs-string">"http://example.com/facts/fact4"</span>,
      <span class="hljs-attr">"sha256"</span>: <span class="hljs-string">"5845f61bccd9c5631dee29f9e87830b11eb5b531081a8888db42e80e2f153fc0"</span>,
      <span class="hljs-attr">"serialization"</span>: <span class="hljs-string">"string"</span>
    }
  ],
  <span class="hljs-attr">"timestamp"</span>: <span class="hljs-string">"2021-04-15T21:50:29.940Z"</span>,
  <span class="hljs-attr">"senderCustomContent"</span>: {
    <span class="hljs-attr">"authMethod"</span>: <span class="hljs-string">"PublicKey"</span>,
    <span class="hljs-attr">"authSuccessful"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">"authUserId"</span>: <span class="hljs-string">"user123456"</span>
  },
  <span class="hljs-attr">"receiverCustomContent"</span>: {
    <span class="hljs-attr">"dbStorageId"</span>: <span class="hljs-string">"StorageCluster5"</span>
  }
}</code></pre>
</div>
</section>
<section id="dtc-representations-jsonld"><div class="header-wrapper"><h4 id="x4-4-2-json-ld"><bdi class="secno">4.4.2 </bdi>JSON-LD</h4><a aria-label="Permalink for Section 4.4.2" class="self-link" href="#dtc-representations-jsonld"></a></div>
<p>We use the <a href="https://w3id.org/reshare/ontology/0.3/">ReShare ontology v0.3</a>, which we describe in Section <a class="sec-ref" href="#reshare-ontology"><bdi class="secno">5. </bdi>The ReShare Ontology</a>, for defining the semantics of the JSON structure in a JSON-LD [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>] representation for DTCs.</p>
<p>
          Instead of defining a schema for the JSON-LD representation of DTCs, we specify a procedure to transform a JSON representation of a DTC into a JSON-LD representation, and a procedure to transform a JSON-LD representation to a JSON representation.
        </p>
<section class="notoc"><div class="header-wrapper"><h5 id="json-to-json-ld">JSON to JSON-LD</h5><a aria-label="Permalink for this Section" class="self-link" href="#json-to-json-ld"></a></div>
<p>To raise a valid JSON DTC serialization to JSON-LD, the following transformation steps <em class="rfc2119">MUST</em> be conducted:
          </p>
<ol>
<li>Add the static <code>@context</code> object</li>
<li>Add <code>@type</code> keywords to the non-literal (sub-)objects</li>
<li>Add the contract base IRI to the <code>@context</code> object as an IRI prefix</li>
<li>Add <code>@id</code> keywords to the non-literal sub-objects
          </li></ol>
<p>
            Details about the steps are presented in the following and <em class="rfc2119">MUST</em> be followed when creating a JSON-LD representation of a DTC.
          </p>
<div class="note" id="issue-container-generatedID-5" role="note"><div aria-level="6" class="note-title marker" id="h-note-5" role="heading"><span>Note</span></div><p class="">In the following examples, the misuse of the triple-dot notation denotes that the rest of the JSON structure is not changed.
            As it is only used in informative examples, it does not violate the normative character of this section.</p></div>
<ol>
<li>The following static <code>@context</code> object (corresponding to version 0.3 of the ReShare ontology)
              <em class="rfc2119">MUST</em> be added to the root of the DTC object:
              <div class="example" id="example-dtc-json-ld-context">
<div class="marker">
<a class="self-link" href="#example-dtc-json-ld-context">Example<bdi> 2</bdi></a><span class="example-title">: DTC JSON-LD context</span>
</div> <pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"@context"</span>: {
    <span class="hljs-attr">"fc"</span>: <span class="hljs-string">"https://w3id.org/reshare/ontology/0.3/#"</span>,
    <span class="hljs-attr">"xsd"</span>: <span class="hljs-string">"http://www.w3.org/2001/XMLSchema#"</span>,
    <span class="hljs-attr">"facts"</span>: {
      <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:fact"</span>,
      <span class="hljs-attr">"@context"</span>: {
        <span class="hljs-attr">"factID"</span>: {
          <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:factOrigin"</span>,
          <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"@id"</span>
        },
        <span class="hljs-attr">"sha256"</span>: {
          <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:sha256Sum"</span>,
          <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"xsd:hexBinary"</span>
        },
        <span class="hljs-attr">"sha384"</span>: {
          <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:sha384Sum"</span>,
          <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"xsd:hexBinary"</span>
        },
        <span class="hljs-attr">"sha512"</span>: {
          <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:sha512Sum"</span>,
          <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"xsd:hexBinary"</span>
        },
        <span class="hljs-attr">"serialization"</span>: <span class="hljs-string">"fc:serialization"</span>
      }
    },
    <span class="hljs-attr">"sender"</span>: {
      <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:sender"</span>,
      <span class="hljs-attr">"@context"</span>: {
        <span class="hljs-attr">"authID"</span>: {
          <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:identifies"</span>,
          <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"@id"</span>
        },
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"fc:certType"</span>,
        <span class="hljs-attr">"cert"</span>: {
          <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:x509Cert"</span>,
          <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"xsd:base64Binary"</span>
        },
        <span class="hljs-attr">"encoding"</span>: <span class="hljs-string">"fc:certEncoding"</span>
      }
    },
    <span class="hljs-attr">"receiver"</span>: {
      <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:receiver"</span>,
      <span class="hljs-attr">"@context"</span>: {
        <span class="hljs-attr">"authID"</span>: {
          <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:identifies"</span>,
          <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"@id"</span>
        },
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"fc:certType"</span>,
        <span class="hljs-attr">"cert"</span>: {
          <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:x509Cert"</span>,
          <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"xsd:base64Binary"</span>
        },
        <span class="hljs-attr">"encoding"</span>: <span class="hljs-string">"fc:certEncoding"</span>
      }
    },
    <span class="hljs-attr">"senderSig"</span>: {
      <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:senderSig"</span>,
      <span class="hljs-attr">"@context"</span>: {
        <span class="hljs-attr">"type"</span>: {
          <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:sigType"</span>,
          <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"@id"</span>
        },
        <span class="hljs-attr">"sig"</span>: {
          <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:sigData"</span>,
          <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"xsd:base64Binary"</span>
        },
        <span class="hljs-attr">"encoding"</span>: <span class="hljs-string">"fc:sigEncoding"</span>
      }
    },
    <span class="hljs-attr">"receiverSig"</span>: {
      <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:receiverSig"</span>,
      <span class="hljs-attr">"@context"</span>: {
        <span class="hljs-attr">"type"</span>: {
          <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:sigType"</span>,
          <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"@id"</span>
        },
        <span class="hljs-attr">"sig"</span>: {
          <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:sigData"</span>,
          <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"xsd:base64Binary"</span>
        },
        <span class="hljs-attr">"encoding"</span>: <span class="hljs-string">"fc:sigEncoding"</span>
      }
    },
    <span class="hljs-attr">"senderCustomContent"</span>: {
      <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:senderCustomContent"</span>,
      <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"@json"</span>
    },
    <span class="hljs-attr">"receiverCustomContent"</span>: {
      <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:receiverCustomContent"</span>,
      <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"@json"</span>
    },
    <span class="hljs-attr">"timestamp"</span>: {
      <span class="hljs-attr">"@id"</span>: <span class="hljs-string">"fc:timestamp"</span>,
      <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"xsd:dateTimeStamp"</span>
    }
  }
}</code></pre>
</div>
</li>
<li>
<p>
                The following (sub-)objects of the DTC object <em class="rfc2119">MUST</em> be typed explicitly with the following types by adding a <code>@type</code> attribute to their root-level attributes:
              </p>
<table class="customtable" id="tab-jsonld-typing">
<thead>
<tr>
<th>JSON object</th>
<th>Type IRI</th>
</tr>
</thead>
<tbody><tr>
<td>Root DTC object</td>
<td><code>fc:DTC</code></td>
</tr>
<tr>
<td>Each entry of <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-3"><code>facts</code></a></td>
<td><code>fc:Fact</code></td>
</tr>
<tr>
<td><a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-6"><code>sender</code></a></td>
<td><code>fc:Sender</code></td>
</tr>
<tr>
<td><a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-1"><code>receiver</code></a></td>
<td><code>fc:Receiver</code></td>
</tr>
<tr>
<td><a class="internalDFN" data-link-type="dfn" data-lt="dtc-senderSig" href="#dfn-dtc-sendersig" id="ref-for-dfn-dtc-sendersig-4"><code>senderSig</code></a></td>
<td><code>fc:Signature</code></td>
</tr>
<tr>
<td><a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiverSig" href="#dfn-dtc-receiversig" id="ref-for-dfn-dtc-receiversig-2"><code>receiverSig</code></a></td>
<td><code>fc:Signature</code></td>
</tr>
</tbody></table>
<div class="note" id="issue-container-generatedID-6" role="note"><div aria-level="6" class="note-title marker" id="h-note-6" role="heading"><span>Note</span></div><p class="">
                All other contract fields do not need to be typed, as they are represented as literals in JSON-LD, and are typed through the <code>@context</code> objects.
              </p></div>
<p>
                The assignment of <code>@type</code> attributes is illustrated with the following example.
              </p>
<div class="example" id="typing-a-dtc">
<div class="marker">
<a class="self-link" href="#typing-a-dtc">Example<bdi> 3</bdi></a><span class="example-title">: Explicitly typing a DTC using @type (non-normative)</span>
</div> <pre aria-busy="false"><code class="hljs javascript">{
  <span class="hljs-string">"@type"</span>: <span class="hljs-string">"fc:DTC"</span>,
  <span class="hljs-string">"facts"</span>: [
    {
      <span class="hljs-string">"@type"</span>: <span class="hljs-string">"fc:Fact"</span>,
      ...
    },
    ...
  ],
  <span class="hljs-string">"receiver"</span>: {
    <span class="hljs-string">"@type"</span>: <span class="hljs-string">"fc:Receiver"</span>,
    ...
  },
  <span class="hljs-string">"receiverSig"</span>: {
    <span class="hljs-string">"@type"</span>: <span class="hljs-string">"fc:Signature"</span>,
    ...
  },
  <span class="hljs-string">"sender"</span>: {
    <span class="hljs-string">"@type"</span>: <span class="hljs-string">"fc:Sender"</span>,
    ...
  },
  <span class="hljs-string">"senderSig"</span>: {
    <span class="hljs-string">"@type"</span>: <span class="hljs-string">"fc:Signature"</span>,
    ...
  },
  ...
}</code></pre>
</div>
</li>
<li>
<p>
                An IRI prefix for the keyword <code>contract</code> <em class="rfc2119">MUST</em> be added to the <code>@context</code> object.
                The prefix <em class="rfc2119">MUST</em> be set to the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-baseIRI" href="#dfn-dtc-baseiri" id="ref-for-dfn-dtc-baseiri-1"><code>baseIRI</code></a> of the contract.
              </p>
<p>
                The step is illustrated with the following example.
                Note that the <code>baseIRI</code> attribute existed beforehand. Its value is simply copied to the IRI prefix definition.
              </p>
<div class="example" id="adding-baseiri-prefix">
<div class="marker">
<a class="self-link" href="#adding-baseiri-prefix">Example<bdi> 4</bdi></a><span class="example-title">: Adding the base IRI of the DTC to its context as an IRI prefix (non-normative)</span>
</div> <pre aria-busy="false"><code class="hljs javascript">{
  <span class="hljs-string">"@context"</span>: {
    <span class="hljs-string">"contract"</span>: <span class="hljs-string">"http://example.com/contracts/1#"</span>,
    ...
  },
  <span class="hljs-string">"baseIRI"</span>: <span class="hljs-string">"http://example.com/contracts/1#"</span>,
  ...
}</code></pre>
</div>
</li>
<li>
<p>
                The following (sub-)objects of the DTC object <em class="rfc2119">MUST</em> be made identifiable with the following <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-24">IRIs</a>
                (relative to the root DTC IRI) by adding a <code>@id</code> attribute to their root-level attributes:
              </p>
<table class="customtable" id="tab-jsonld-ids">
<thead>
<tr>
<th style="min-width: 15em;">JSON object</th>
<th>Resource IRI</th>
</tr>
</thead>
<tbody><tr>
<td>Each entry of <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-4"><code>facts</code></a></td>
<td>
<code>contract:fact-&lt;i&gt;</code>, where <code>&lt;i&gt;</code> is the index of the entry within <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-5"><code>facts</code></a> when sorted lexicographically by <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-factID" href="#dfn-dtc-facts-factid" id="ref-for-dfn-dtc-facts-factid-5"><code>factID</code></a> (starting with <code>contract:fact-0</code>)
                  </td>
</tr>
<tr>
<td><a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-7"><code>sender</code></a></td>
<td><code>contract:sender</code></td>
</tr>
<tr>
<td><a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-2"><code>receiver</code></a></td>
<td><code>contract:receiver</code></td>
</tr>
<tr>
<td><a class="internalDFN" data-link-type="dfn" data-lt="dtc-senderSig" href="#dfn-dtc-sendersig" id="ref-for-dfn-dtc-sendersig-5"><code>senderSig</code></a></td>
<td><code>contract:senderSig</code></td>
</tr>
<tr>
<td><a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiverSig" href="#dfn-dtc-receiversig" id="ref-for-dfn-dtc-receiversig-3"><code>receiverSig</code></a></td>
<td><code>contract:senderSig</code></td>
</tr>
</tbody></table>
<div class="note" id="issue-container-generatedID-7" role="note"><div aria-level="6" class="note-title marker" id="h-note-7" role="heading"><span>Note</span></div><p class="">
                All other contract fields are not assigned an IRI, as they are represented as literals in JSON-LD, and thus do not have their own IRIs.
                Instead, they can be queried through the data properties of the DTC resource.
              </p></div>
<p>The assignment of <code>@id</code> attributes is illustrated with the following example.</p>
<div class="example" id="adding-compact-iris">
<div class="marker">
<a class="self-link" href="#adding-compact-iris">Example<bdi> 5</bdi></a><span class="example-title">: Explicitly adding IRIs to the DTC subcomponents using @id (non-normative)</span>
</div> <pre aria-busy="false"><code class="hljs javascript">{
  <span class="hljs-string">"facts"</span>: [
    {
      <span class="hljs-string">"@id"</span>: <span class="hljs-string">"contract:fact-0"</span>,
      ...
    },
    {
      <span class="hljs-string">"@id"</span>: <span class="hljs-string">"contract:fact-1"</span>,
      ...
    },
    {
      <span class="hljs-string">"@id"</span>: <span class="hljs-string">"contract:fact-2"</span>,
      ...
    },
    {
      <span class="hljs-string">"@id"</span>: <span class="hljs-string">"contract:fact-3"</span>,
      ...
    }
  ],
  <span class="hljs-string">"receiver"</span>: {
    <span class="hljs-string">"@id"</span>: <span class="hljs-string">"contract:receiver"</span>,
    ...
  },
  <span class="hljs-string">"receiverSig"</span>: {
    <span class="hljs-string">"@id"</span>: <span class="hljs-string">"contract:receiverSig"</span>,
    ...
  },
  <span class="hljs-string">"sender"</span>: {
    <span class="hljs-string">"@id"</span>: <span class="hljs-string">"contract:sender"</span>,
    ...
  },
  <span class="hljs-string">"senderSig"</span>: {
    <span class="hljs-string">"@id"</span>: <span class="hljs-string">"contract:senderSig"</span>,
    ...
  },
  ...
}</code></pre>
</div>
</li>
</ol>
<p>In the following, we give the example of a DTC represented in JSON-LD, where the static part of the <code>@context</code> object is omitted for readability.
          </p>
<div class="example" id="example-contract-jsonld">
<div class="marker">
<a class="self-link" href="#example-contract-jsonld">Example<bdi> 6</bdi></a><span class="example-title">: Example DTC (JSON-LD) (non-normative)</span>
</div> <pre aria-busy="false"><code class="hljs javascript">{
  <span class="hljs-string">"@context"</span>: {
    ...
  },
  <span class="hljs-string">"@id"</span>: <span class="hljs-string">"http://example.com/contracts/1"</span>,
  <span class="hljs-string">"@type"</span>: <span class="hljs-string">"fc:DTC"</span>,
  <span class="hljs-string">"facts"</span>: [
    {
      <span class="hljs-string">"@id"</span>: <span class="hljs-string">"contract:fact-0"</span>,
      <span class="hljs-string">"@type"</span>: <span class="hljs-string">"fc:Fact"</span>,
      <span class="hljs-string">"factID"</span>: <span class="hljs-string">"http://example.com/facts/fact1"</span>,
      <span class="hljs-string">"serialization"</span>: <span class="hljs-string">"string"</span>,
      <span class="hljs-string">"sha256"</span>: <span class="hljs-string">"5fc62b0e99a143ff2b99b56a6953f07e96f52023aa3739bba3fec1194292f48e"</span>
    },
    {
      <span class="hljs-string">"@id"</span>: <span class="hljs-string">"contract:fact-1"</span>,
      <span class="hljs-string">"@type"</span>: <span class="hljs-string">"fc:Fact"</span>,
      <span class="hljs-string">"factID"</span>: <span class="hljs-string">"http://example.com/facts/fact2"</span>,
      <span class="hljs-string">"serialization"</span>: <span class="hljs-string">"string"</span>,
      <span class="hljs-string">"sha256"</span>: <span class="hljs-string">"828bbc97b5b866992dc8bc532265e3094bc9e17cce05e16d90844d2160ad99cf"</span>
    },
    {
      <span class="hljs-string">"@id"</span>: <span class="hljs-string">"contract:fact-2"</span>,
      <span class="hljs-string">"@type"</span>: <span class="hljs-string">"fc:Fact"</span>,
      <span class="hljs-string">"factID"</span>: <span class="hljs-string">"http://example.com/facts/fact3"</span>,
      <span class="hljs-string">"serialization"</span>: <span class="hljs-string">"string"</span>,
      <span class="hljs-string">"sha256"</span>: <span class="hljs-string">"c646cfa0feda9af766e6eca97f8578f3eb2b126d2349ea7ce1fd2d3b3fe2d456"</span>
    },
    {
      <span class="hljs-string">"@id"</span>: <span class="hljs-string">"contract:fact-3"</span>,
      <span class="hljs-string">"@type"</span>: <span class="hljs-string">"fc:Fact"</span>,
      <span class="hljs-string">"factID"</span>: <span class="hljs-string">"http://example.com/facts/fact4"</span>,
      <span class="hljs-string">"serialization"</span>: <span class="hljs-string">"string"</span>,
      <span class="hljs-string">"sha256"</span>: <span class="hljs-string">"5845f61bccd9c5631dee29f9e87830b11eb5b531081a8888db42e80e2f153fc0"</span>
    }
  ],
  <span class="hljs-string">"receiver"</span>: {
    <span class="hljs-string">"@id"</span>: <span class="hljs-string">"contract:receiver"</span>,
    <span class="hljs-string">"@type"</span>: <span class="hljs-string">"fc:Receiver"</span>,
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"X509"</span>,
    <span class="hljs-string">"encoding"</span>: <span class="hljs-string">"base64"</span>,
    <span class="hljs-string">"authID"</span>: <span class="hljs-string">"http://example.com/receiver"</span>,
    <span class="hljs-string">"cert"</span>: <span class="hljs-string">"MIIEkTCCAnmgAwIBAgIUTpTAugWv4ZYQX9nk2zETfVcMi4AwDQYJKoZIhvcNAQELBQAwTDELMAkGA1UEBhMCREUxEzARBgNVBAgMClNvbWUtU3RhdGUxEzARBgNVBAoMCkV4YW1wbGUgQ0ExEzARBgNVBAMMCkV4YW1wbGUgQ0EwHhcNMjEwNDE1MjExNDM1WhcNMjIwNDE1MjExNDM1WjAzMR0wGwYDVQQKDBRFeGFtcGxlIGNoYWluIGNlcnQgMTESMBAGA1UEAwwJbG9jYWxob3N0MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuKe4H5GwuaKS02s6oAnQF0e30TLyB3joT5GNzwa94WXuLjU8SWKqOjLQyIN2ZBtZW1jNI3By6nsPoU3t181SBStFI25JZ8PUvJ9/Skf/adRmrtXHX8MYRBqN4d1JIRdOoLxwq+bI0UIyMmMNMTjvhnWwTx4FkXwup5fna9FFBbtOGP+7vMVl98L2/bDMJwwLdnzUs0CKLyqDRx0XWAnp6R6CN9YDeMgpdDviMkBfeY74AJ084v6pWnx+K0PlUuQAkiuPvcRsDxgjHRO18rq4wA6Dxh6My7Xh/uHFzb5cmLT7C7kfr+WN26va8IRGCF8NWdOYQ0HSo/vbY/eIOB/G0wIDAQABo4GDMIGAMB0GA1UdDgQWBBSmlyw0Ht9gF3rnI42Us1dK9+jZ/DAfBgNVHSMEGDAWgBR+/85DLJ8v0EP1y6kv/I9XPsHQ5TAPBgNVHRMBAf8EBTADAQH/MA4GA1UdDwEB/wQEAwIBhjAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUHAwEwDQYJKoZIhvcNAQELBQADggIBABMLMfSOAwk34LEK9L/A1qtHTJPQ2BF3XjnbswINNao0oOI3PSWKU0weWYlITH29hgyzrwO8A9ifaOFPtsRxe9/UNv6RNqwObLpxF+f2U3ulu2hTzd7l/ZXUGYaBUHLL3Cu1JlZWMRoTUBUHAvkwnQlUkQLJZ7A+N9y+FfV5apIMTwPA+C2lwiVtEd3Hje5Z9lUmjwiARRnsliRuCm2ZY0IHvneQN7NnOFCFFQQnu/7wMEywNWR3NMtj5AcMugs56OqcAglwq+HqYNCUkelt1/I7A/NwitaPEYu/1TDjQBckR6nbtJwHKFx2M9heB+E5iMI65r+ae01jBr+r7tes6UdEz7SCF3xHks3ubKfRQykZzTZ7ixeHYG5XjaUSSk8EDuBCdZOJ/AUAA+Rar/UPODUd1YQUZDUqs0MvB9zXQYBtEhwii75pCmkFBpZewo6xyktdP3964q7MZPZQZTZimh02CxcWdXZj6JkoL6ihuM36UciS9rXUgIGGdJcbhC5mP/PqRYsAzipOvQiRL7mGRB9L8H0Wt08yl3H0KFwGcgasML8tOOkf+4MsGIHJZaJ20cVfdWm1StOtLN1Bn+gAppq8nlvDgPiQ3NxSsvY+Qpb0WSVWknc1VyOPKexKaM20/alMv/fykVhVmmAcNVshIMAuKV5TnhqeZyg8L02pVAHL"</span>
  },
  <span class="hljs-string">"receiverCustomContent"</span>: {
    <span class="hljs-string">"dbStorageId"</span>: <span class="hljs-string">"StorageCluster5"</span>
  },
  <span class="hljs-string">"receiverSig"</span>: {
    <span class="hljs-string">"@id"</span>: <span class="hljs-string">"contract:receiverSig"</span>,
    <span class="hljs-string">"@type"</span>: <span class="hljs-string">"fc:Signature"</span>,
    <span class="hljs-string">"sig"</span>: <span class="hljs-string">"JepGwNLofxFFCvewKe+OBFm7G+YOvfqrAz3+z+jEAiPlpNtuXrQo3WM8g9SHyMpccu4BBPlKflSynI/OC6X7JL9kuJchg93gRBk/PjfTj8bUSaewCW3CVPe50zznJC7R9rcjUVtyLDIva558RJaJwVzgwO6YH+1/+hU4qKVHUyUuxBJSbWrBuOHBjavQQdq2utaja6h8dx1bLcBHAMjKxM4rIfUzXgjzkJk/D/DEZvSIRMnBafnqDQFvjB/eSZQa+oSSxKXS6dXskOKlxS9HvnRn2CsWEjhDrCIyphwEUj8qqhv1rsPWpiIXYVewWcsRxaYDfoe6+5hgquXR1i3nrg=="</span>,
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"urn:oid:1.2.840.113549.1.1.10"</span>,
    <span class="hljs-string">"encoding"</span>: <span class="hljs-string">"base64"</span>
  },
  <span class="hljs-string">"sender"</span>: {
    <span class="hljs-string">"@id"</span>: <span class="hljs-string">"contract:sender"</span>,
    <span class="hljs-string">"@type"</span>: <span class="hljs-string">"fc:Sender"</span>,
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"X509"</span>,
    <span class="hljs-string">"encoding"</span>: <span class="hljs-string">"base64"</span>,
    <span class="hljs-string">"authID"</span>: <span class="hljs-string">"http://example.com/sender"</span>,
    <span class="hljs-string">"cert"</span>: <span class="hljs-string">"MIIEkTCCAnmgAwIBAgIUTpTAugWv4ZYQX9nk2zETfVcMi38wDQYJKoZIhvcNAQELBQAwTDELMAkGA1UEBhMCREUxEzARBgNVBAgMClNvbWUtU3RhdGUxEzARBgNVBAoMCkV4YW1wbGUgQ0ExEzARBgNVBAMMCkV4YW1wbGUgQ0EwHhcNMjEwNDE1MjExMTExWhcNMjIwNDE1MjExMTExWjAzMR0wGwYDVQQKDBRFeGFtcGxlIGNoYWluIGNlcnQgMTESMBAGA1UEAwwJbG9jYWxob3N0MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvw8C6sqLUVSOwFPbZsqS/1cL/+7aaaxVPwXs7TjPVombwNLyJW8yPyyQLbsTN5evVCpNdzciYc9Nhh77AYrqCiOsZBb7hu/PMqNqDvU2FAHeTH9KZ1PSpsOdgzG4i9widL6FBKGrxvlyj0G5ztQoGtymJFdmQ8K/ZN2W5Bi27H24UgITO+mX5MGmzFfyib7bDnvNqZUMJEgpSGt+jUf/7pMtuQqusrE1bfg5vvCbHIPHx2KXqzQEjNiioDafzKjIY2NSakis1AZe+J46o/Za0L8TUMXPvO1nSX4VMm9w5Qqf8auKdlUnT7fVqGKxQvPgX/JM/ksduZqZdTE1giWDgQIDAQABo4GDMIGAMB0GA1UdDgQWBBQtTnbTodwlQnP0QXA2VRv6DBWgzzAfBgNVHSMEGDAWgBR+/85DLJ8v0EP1y6kv/I9XPsHQ5TAPBgNVHRMBAf8EBTADAQH/MA4GA1UdDwEB/wQEAwIBhjAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUHAwEwDQYJKoZIhvcNAQELBQADggIBAG47hxcjEY6kXojCadK15iW5t6P2p2NCfXpymeRuVaHiI7hhMwQEPymGqXZe0MKUKaRxb9BssG9UvndJw7PWdLx55Y498dgEVXWp7UWUg+VmLxE0wrS+7odJ6ZwsSTPhlgQVF3y9SOP18UX1Iy+ipkdPVbeiQB2QJOYLdxj3h26a/BevyWJU7jTbZO9fNX3FlopyQbB64QPJKJyQiYrT1td7lOcreyBJUS2e5p+hifW/ukxHQ9QtfN+mE/MlnUSHar6LgXPX3AoiVKc14L5E7jRHLDCvFWO1PfVCsS6RWIKdoWsEUytDnMYLHb2TmMJWQf8S69BLyqgEhKXNS9hZceGr32jM9O6TepYKZNH5A1QLjZcuHHKUAzXMjM9loNLra/VGcqrMTdZYautGl8EdEURqE063qDd+Hsp3Vqw0iALQHcbEb6R1b2o5dIrczo+PINTSvnFv+4GyqznXEYjcueLrR/R6kE9GNOiPUxpont+0s1JCAKPaaZk97Z09ldtD47rPQLQgWopDadVOm3Gu9+ef7uqqpJw9+q384mqgw4P1Yws6aVkXLdvh8MCXcMEYi2AeQVCCZv2CjAh8CZQC+0P2JtkhWlCxPoSDk4jbm6koCxcpL3CRcc5LtTTrev5+Mi0oDMiLzx09GNls3SQzdKdP9PM+Y7E7y4Xi2LW3FtoG"</span>
  },
  <span class="hljs-string">"senderCustomContent"</span>: {
    <span class="hljs-string">"authMethod"</span>: <span class="hljs-string">"PublicKey"</span>,
    <span class="hljs-string">"authSuccessful"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-string">"authUserId"</span>: <span class="hljs-string">"user123456"</span>
  },
  <span class="hljs-string">"senderSig"</span>: {
    <span class="hljs-string">"@id"</span>: <span class="hljs-string">"contract:senderSig"</span>,
    <span class="hljs-string">"@type"</span>: <span class="hljs-string">"fc:Signature"</span>,
    <span class="hljs-string">"sig"</span>: <span class="hljs-string">"XW5nUNXY+06Llu9i4vUABpm4CpTHTPBy7rAYjGV/FG8CIuYffr4xYZkm6VIDApWQ3F38CwLDzEgy4bAT/u+kQshCM4MzIyGnqTzatvV8ZM3gfBJ6307h+t8VdBW3siXYcqexpA5CWVtqNWhCIme/sXEXkJQDQl1q5NljIcWiaJMHNUwg0IvCP1LLL8fcMr0Yj0sVKN5l8WuBpr6lLIsxOJgN6iWt/wM43pBO2G62/BR7FCWY1jE72gedGy16BBpn/KNkCRIr0ACcZNArZPYlISsHXpjOk3QoiUMakxgvdbdlpKZNFchbXU6ZlZTu3xyc67uddy6QzNID3yJ35Kcp3w=="</span>,
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"urn:oid:1.2.840.113549.1.1.10"</span>,
    <span class="hljs-string">"encoding"</span>: <span class="hljs-string">"base64"</span>
  },
  <span class="hljs-string">"timestamp"</span>: <span class="hljs-string">"2021-04-15T21:53:24.446Z"</span>
}</code></pre>
</div>
</section>
<section class="notoc"><div class="header-wrapper"><h5 id="json-ld-to-json">JSON-LD to JSON</h5><a aria-label="Permalink for this Section" class="self-link" href="#json-ld-to-json"></a></div>
<p>To transfer a JSON-LD representation of a DTC to a JSON representation, one <em class="rfc2119">MUST</em> execute the following steps:</p>
<ol>
<li>Build the <code>@context</code> object by adding a <code>contract</code> IRI prefix to the static <code>@context</code> object from the JSON-to-JSON-LD transformation by copying the IRI of the DTC,
              similarly to step 3 of the JSON-to-JSON-LD transformation.
            </li>
<li>Use the JSON-LD <a href="https://www.w3.org/TR/json-ld11-api/#compaction-algorithm">compaction algorithm</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11-api" title="JSON-LD 1.1 Processing Algorithms and API">JSON-LD11-API</a></cite>] to compact the JSON-LD document together with the context built in Step 1.</li>
<li>Remove all <code>@type</code>, <code>@id</code>, and <code>@context</code> attributes.
              <span class="note">Note: The <code>baseIRI</code> of the DTC is unaffected by this, as it is aliased as <code>@id</code>, and thus is not removed!</span>
</li>
</ol>
</section>
</section>
</section>
<section id="dtc-signatures"><div class="header-wrapper"><h3 id="x4-5-signature-creation-verification"><bdi class="secno">4.5 </bdi>Signature Creation &amp; Verification</h3><a aria-label="Permalink for Section 4.5" class="self-link" href="#dtc-signatures"></a></div>
<div class="tlcontent">
<p>
          A valid DTC <em class="rfc2119">MUST</em> always contain two signatures, one by the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-23">sender</a>, and one by the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-19">receiver</a>.
          These signatures constitute a central component of the trust chain of a DTC, connecting the information included in DTCs (e.g., the checksums in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-6"><code>facts</code></a>) to the public keys of <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-24">sender</a>
          and <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-20">receiver</a>.
          The signatures are included in the DTC itself in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-senderSig" href="#dfn-dtc-sendersig" id="ref-for-dfn-dtc-sendersig-6"><code>senderSig</code></a> and <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiverSig" href="#dfn-dtc-receiversig" id="ref-for-dfn-dtc-receiversig-4"><code>receiverSig</code></a> fields (see <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>).
        </p>
<p>
          The processes of creating and verifying DTC signatures, which are specified in the following, are the same for any party (<a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-25">sender</a> or <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-21">receiver</a>).
          Thus, we only consider the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-26">sender</a> in the following.
          For <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-22">receiver</a> signatures, analogous steps apply.
        </p>
<p>
          Each party (<a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-27">sender</a> and <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-23">receiver</a>) <em class="rfc2119">MUST</em> have an RSA public/private key pair which they use for creating DTC signatures.
          The public key of the key pair used to create DTC signatures <em class="rfc2119">MUST</em> be included in the <code>cert</code>
          property of the respective identity field of the DTC, i.e., <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-8"><code>sender</code></a> or <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-3"><code>receiver</code></a> (see <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>).
        </p>
</div>
<section id="dtc-signatures-overview"><div class="header-wrapper"><h4 id="x4-5-1-overview"><bdi class="secno">4.5.1 </bdi>Overview</h4><a aria-label="Permalink for Section 4.5.1" class="self-link" href="#dtc-signatures-overview"></a></div>
<div class="tlcontent">
<p>
            The processes of signature creation and verification can be divided into three low-level processes:
            A <a href="#dtc-signatures-preprocessing">pre-processing pipeline</a> for generating a normalized binary serialization of a DTC (further described in Section <a class="sec-ref" href="#dtc-signatures-preprocessing"><bdi class="secno">4.5.2 </bdi>Pre-Processing</a>), and both a <a href="#dtc-signatures-creation">signature creation</a> and <a href="#dtc-signatures-verification">verification</a> process based on the pre-processed form of a DTC (further described in Sections <a class="sec-ref" href="#dtc-signatures-creation"><bdi class="secno">4.5.3 </bdi>Signature Creation</a> and <a class="sec-ref" href="#dtc-signatures-verification"><bdi class="secno">4.5.4 </bdi>Signature Verification</a> respectively).
          </p>
<p>
            The integration of said low-level processes into the high-level processes of signature creation and verification is visualized in the two figures below.
          </p>
<figure id="fig-dtc-sigproc-pipeline-creation" style="text-align: center;">
<object aria-describedby="fig-dtc-sigproc-pipeline-creation" data="figures/signature-process-pipeline-creation.svg" style="width:80%;" type="image/svg+xml"></object>
<p id="fig-dtc-sigproc-pipeline-creation-alt">
              DTC signature creation process (high-level)
            </p>
<figcaption><a class="self-link" href="#fig-dtc-sigproc-pipeline-creation">Figure <bdi class="figno">3</bdi></a> <span class="fig-title">
              The high-level process of creating a DTC signature.
              The DTC is pre-processed first before creating the DTC signature using the signer's private key.
            </span></figcaption>
</figure>
<figure id="fig-dtc-sigproc-pipeline-verification" style="text-align: center;">
<object aria-describedby="fig-dtc-sigproc-pipeline-verification" data="figures/signature-process-pipeline-verification.svg" style="width: 75%;" type="image/svg+xml"></object>
<p id="fig-dtc-sigproc-pipeline-verification-alt">
              DTC signature verification process (high-level)
            </p>
<figcaption><a class="self-link" href="#fig-dtc-sigproc-pipeline-verification">Figure <bdi class="figno">4</bdi></a> <span class="fig-title">
              The high-level process of verifying a DTC signature.
              The DTC is pre-processed first before verifiying the given DTC signature using the signer's public key.
            </span></figcaption>
</figure>
</div>
</section>
<section id="dtc-signatures-preprocessing"><div class="header-wrapper"><h4 id="x4-5-2-pre-processing"><bdi class="secno">4.5.2 </bdi>Pre-Processing</h4><a aria-label="Permalink for Section 4.5.2" class="self-link" href="#dtc-signatures-preprocessing"></a></div>
<div class="tlcontent">
<p>
            The DTC pre-processing pipeline, as visualized below, consists of four steps and starts with the implementation-dependent internal representation of the DTC.
          </p>
<figure id="fig-dtc-sigproc-preprocessing" style="text-align: center;">
<object aria-describedby="fig-dtc-sigproc-preprocessing" data="figures/signature-process-preprocessing.svg" style="width:80%;" type="image/svg+xml"></object>
<p id="fig-dtc-sigproc-preprocessing-alt">
              The pre-processing steps for creating and verifying DTC signatures </p>
<figcaption><a class="self-link" href="#fig-dtc-sigproc-preprocessing">Figure <bdi class="figno">5</bdi></a> <span class="fig-title">
              The pre-processing steps for creating and verifying DTC signatures.
              The internal DTC is serialized as specified by the JSON DTC represenation, pruned by removing unsigned material, normalized, and encoded as a <a href="https://datatracker.ietf.org/doc/html/rfc3629">UTF-8</a>
              string [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3629" title="UTF-8, a transformation format of ISO 10646">RFC3629</a></cite>].
            </span></figcaption>
</figure>
<p>
            The four pre-processing steps <em class="rfc2119">MUST</em> be executed as follows in order to uniquely serialize and normalize the DTC.
          </p>
<ol>
<li>
<b>Serialize:</b>
              The (potentially incomplete) DTC <em class="rfc2119">MUST</em> be serialized as JSON according to Section <a class="sec-ref" href="#dtc-representations"><bdi class="secno">4.4 </bdi>DTC Representations</a>.
              This representation <em class="rfc2119">MUST</em> match the schema of a <a class="external" href="schemas/dtc_only_signatures_missing.schema.json" target="_blank">partial DTC, where only the two signatures may be missing</a>, as defined in Section <a class="sec-ref" href="#dtc-representations"><bdi class="secno">4.4 </bdi>DTC Representations</a>.
            </li>
<li>
<b>Remove unsigned content:</b>
              To not impose a dependency on the ordering of signatures by the parties, pre-existing signature material <em class="rfc2119">MUST NOT</em> be included in the signature.
              Thus, both the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-senderSig" href="#dfn-dtc-sendersig" id="ref-for-dfn-dtc-sendersig-7"><code>senderSig</code></a> and <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiverSig" href="#dfn-dtc-receiversig" id="ref-for-dfn-dtc-receiversig-5"><code>receiverSig</code></a>
              fields (if existing) <em class="rfc2119">MUST</em> be removed in this step.
            </li>
<li>
<b>Normalize:</b>
              First, in order to achieve a unique order of the included facts, the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-7"><code>facts</code></a>
              array <em class="rfc2119">MUST</em> be sorted by the ascending lexicographic order of the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-factID" href="#dfn-dtc-facts-factid" id="ref-for-dfn-dtc-facts-factid-6"><code>factID</code></a>
              subproperty in <a href="https://datatracker.ietf.org/doc/html/rfc3629">UTF-8</a> encoding [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3629" title="UTF-8, a transformation format of ISO 10646">RFC3629</a></cite>].
              Afterward, the JSON document <em class="rfc2119">MUST</em> be canonicalized according to the <a href="https://datatracker.ietf.org/doc/html/rfc8785">JSON Canonicalization Scheme (JCS)</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8785" title="JSON Canonicalization Scheme (JCS)">RFC8785</a></cite>].
            </li>
<li>
<b>Encode:</b>
              To discretize the string encoding of the normalized JSON contract, it <em class="rfc2119">MUST</em> be encoded using <a href="https://datatracker.ietf.org/doc/html/rfc3629">UTF-8</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3629" title="UTF-8, a transformation format of ISO 10646">RFC3629</a></cite>].
            </li>
</ol>
</div>
</section>
<section id="dtc-signatures-creation"><div class="header-wrapper"><h4 id="x4-5-3-signature-creation"><bdi class="secno">4.5.3 </bdi>Signature Creation</h4><a aria-label="Permalink for Section 4.5.3" class="self-link" href="#dtc-signatures-creation"></a></div>
<div class="tlcontent">
<figure id="fig-dtc-sigproc-creation" style="text-align: center;">
<object aria-describedby="fig-dtc-sigproc-creation" data="figures/signature-process-creation.svg" style="width: 70%;" type="image/svg+xml"></object>
<p id="fig-dtc-sigproc-creation-alt">
              The process of creating a DTC signature, based on its pre-processed form.
            </p>
<figcaption><a class="self-link" href="#fig-dtc-sigproc-creation">Figure <bdi class="figno">6</bdi></a> <span class="fig-title">
              The process of creating a DTC signature, based on its pre-processed form.
              Using said pre-processed DTC and its own private key, the signing party creates an RSA signature, which is encoded as <a href="https://datatracker.ietf.org/doc/html/rfc4648#section-4">Base64</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4648" title="The Base16, Base32, and Base64 Data Encodings">RFC4648</a></cite>].
            </span></figcaption>
</figure>
<p>
            The signature <em class="rfc2119">MUST</em> be created using the pre-processed form of the DTC as described in Section <a class="sec-ref" href="#dtc-signatures-preprocessing"><bdi class="secno">4.5.2 </bdi>Pre-Processing</a> as the input to the <a href="https://datatracker.ietf.org/doc/html/rfc8017#section-8.1.1"><code>RSASSA-PSS-SIGN</code></a>
            operation specified in <a href="https://datatracker.ietf.org/doc/html/rfc8017">PKCS #1</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8017" title="PKCS #1: RSA Cryptography Specifications Version 2.2">RFC8017</a></cite>].
          </p>
<p>
            For the <a href="https://datatracker.ietf.org/doc/html/rfc8017#section-9.1.1"><code>EMSA-PSS-ENCODE</code></a>
            encoding operation used in the <a href="https://datatracker.ietf.org/doc/html/rfc8017#section-8.1.1"><code>RSASSA-PSS-SIGN</code></a>
            operation, the following parameters <em class="rfc2119">MUST</em> be selected:
          </p>
<ul>
<li>
              Hash function (<code>Hash</code>): SHA-256 [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-180-4" title="FIPS PUB 180-4: Secure Hash Standard (SHS)">FIPS-180-4</a></cite>]
            </li>
<li>
              Mask generation function (<code>MGF</code>): <a href="https://datatracker.ietf.org/doc/html/rfc8017#appendix-B.2.1">MGF1</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8017" title="PKCS #1: RSA Cryptography Specifications Version 2.2">RFC8017</a></cite>]
            </li>
<li>
              Salt length (<code>sLen</code>): 32 (=<code>hLen</code>, i.e., the length of a SHA-256 hash in octets)
            </li>
</ul>
<p>
            The binary output of the <code>RSASSA-PSS</code> signature creation primitive <em class="rfc2119">MUST</em> be encoded as <a href="https://datatracker.ietf.org/doc/html/rfc4648#section-4">Base64</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4648" title="The Base16, Base32, and Base64 Data Encodings">RFC4648</a></cite>].
          </p>
<p>
            The encoded signature can be used as the <code>sig</code> subfield of the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-senderSig" href="#dfn-dtc-sendersig" id="ref-for-dfn-dtc-sendersig-8"><code>senderSig</code></a> or <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiverSig" href="#dfn-dtc-receiversig" id="ref-for-dfn-dtc-receiversig-6"><code>receiverSig</code></a> DTC fields (the field associated with the signer), as specified in Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
          </p>
</div>
</section>
<section id="dtc-signatures-verification"><div class="header-wrapper"><h4 id="x4-5-4-signature-verification"><bdi class="secno">4.5.4 </bdi>Signature Verification</h4><a aria-label="Permalink for Section 4.5.4" class="self-link" href="#dtc-signatures-verification"></a></div>
<div class="tlcontent">
<figure id="fig-dtc-sigproc-verification" style="text-align: center;">
<object aria-describedby="fig-dtc-sigproc-verification" data="figures/signature-process-verification.svg" style="width: 70%;" type="image/svg+xml"></object>
<p id="fig-dtc-sigproc-verification-alt">
              The process of verifying a DTC signature, based on its pre-processed form.
            </p>
<figcaption><a class="self-link" href="#fig-dtc-sigproc-verification">Figure <bdi class="figno">7</bdi></a> <span class="fig-title">
              The process of verifying a DTC signature, based on its pre-processed form.
              Requires said pre-processed DTC, the DTC signature encoded as <a href="https://datatracker.ietf.org/doc/html/rfc4648#section-4">Base64</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4648" title="The Base16, Base32, and Base64 Data Encodings">RFC4648</a></cite>], and the signing party's public key.
              The signature is first decoded into a binary form, and then verified using the pre-processed DTC and the public key.
            </span></figcaption>
</figure>
<p>
            To verify a given signature, as included in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-senderSig" href="#dfn-dtc-sendersig" id="ref-for-dfn-dtc-sendersig-9"><code>senderSig</code></a> or <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiverSig" href="#dfn-dtc-receiversig" id="ref-for-dfn-dtc-receiversig-7"><code>receiverSig</code></a> DTC fields (see <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>), the encoded signature (here: <code>senderSig</code>) <em class="rfc2119">MUST</em> be decoded as <a href="https://datatracker.ietf.org/doc/html/rfc4648#section-4">Base64</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4648" title="The Base16, Base32, and Base64 Data Encodings">RFC4648</a></cite>].
          </p>
<p>The DTC <em class="rfc2119">MUST</em> be pre-processed according to <a class="sec-ref" href="#dtc-signatures-preprocessing"><bdi class="secno">4.5.2 </bdi>Pre-Processing</a>.</p>
<p>Together with the pre-processed DTC, and the public key associated with the signature, the signature <em class="rfc2119">MUST</em> then be verified according to the <a href="https://datatracker.ietf.org/doc/html/rfc8017#section-8.1.2"><code>RSASSA-PSS-VERIFY</code></a>
            operation as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8017">PKCS #1</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8017" title="PKCS #1: RSA Cryptography Specifications Version 2.2">RFC8017</a></cite>].
          </p>
<p>For the <a href="https://datatracker.ietf.org/doc/html/rfc8017#section-9.1.2"><code>EMSA-PSS-VERIFY</code></a>
            operation, which is used in the <a href="https://datatracker.ietf.org/doc/html/rfc8017#section-8.1.2"><code>RSASSA-PSS-VERIFY</code></a>
            operation, the same parameters as for <a href="https://datatracker.ietf.org/doc/html/rfc8017#section-9.1.1"><code>EMSA-PSS-ENCODE</code></a> (see <a class="sec-ref" href="#dtc-signatures-creation"><bdi class="secno">4.5.3 </bdi>Signature Creation</a>) <em class="rfc2119">MUST</em> be used.
          </p>
</div>
</section>
</section>
</section>
<section id="reshare-ontology"><div class="header-wrapper"><h2 id="x5-the-reshare-ontology"><bdi class="secno">5. </bdi>The ReShare Ontology</h2><a aria-label="Permalink for Section 5." class="self-link" href="#reshare-ontology"></a></div>
<div id="download-serialization">
<dl>
<dt>Standalone documentation:</dt>
<dd>
<a href="https://w3id.org/reshare/ontology/0.3" target="_blank"><img alt="Documentation v0.3" src="resources/badges/Documentation-v0.3-blue.svg"/></a>
</dd>
<dt>Revision:</dt>
<dd>0.3</dd>
<dt>Download serialization:</dt>
<dd><span><a href="https://w3id.org/reshare/ontology/0.3/ontology.jsonld" target="_blank"><img alt="JSON-LD" src="resources/badges/Format-JSON_LD-blue.svg"/></a>
</span><span><a href="https://w3id.org/reshare/ontology/0.3/ontology.rdf" target="_blank"><img alt="RDF/XML" src="resources/badges/Format-RDF-XML-blue.svg"/></a>
</span><span><a href="https://w3id.org/reshare/ontology/0.3/ontology.nt" target="_blank"><img alt="N-Triples" src="resources/badges/Format-N_Triples-blue.svg"/></a>
</span><span><a href="https://w3id.org/reshare/ontology/0.3/ontology.ttl" target="_blank"><img alt="TTL" src="resources/badges/Format-TTL-blue.svg"/></a> </span></dd>
<dt>Visualization:</dt>
<dd><a href="webvowl/index.html#" target="_blank"><img alt="Visualize with WebVowl" src="resources/badges/Visualize_with-WebVowl-blue.svg"/></a>
</dd>
</dl>
</div>
<p>
      To enable the interpretation of DTCs as Linked Data, we propose the <em>ReShare ontology</em>.
      The ontology defines the properties and classes used in the <a href="#dtc-representations-jsonld">JSON-LD representation</a> of DTCs as specified in Section <a class="sec-ref" href="#dtc-representations"><bdi class="secno">4.4 </bdi>DTC Representations</a>.
    </p>
<section id="overview-0"><div class="header-wrapper"><h3 id="x5-1-overview"><bdi class="secno">5.1 </bdi>Overview</h3><a aria-label="Permalink for Section 5.1" class="self-link" href="#overview-0"></a></div>
<div class="widoco" id="overview">
<p>This ontology has the following classes and properties.</p>
<div class="header-wrapper"><h4 id="classes-0">Classes</h4><a aria-label="Permalink for this Section" class="self-link" href="#overview"></a></div>
<ul class="hlist">
<li>
<a href="#DTC" title="http://w3id.org/reshare/ontology/0.3/#DTC">Digital Transmission Contract</a>
</li>
<li>
<a href="#Fact" title="http://w3id.org/reshare/ontology/0.3/#Fact">Fact</a>
</li>
<li>
<a href="#Identity" title="http://w3id.org/reshare/ontology/0.3/#Identity">Identity</a>
</li>
<li>
<a href="#Receiver" title="http://w3id.org/reshare/ontology/0.3/#Receiver">Receiver</a>
</li>
<li>
<a href="#Sender" title="http://w3id.org/reshare/ontology/0.3/#Sender">Sender</a>
</li>
<li>
<a href="#Signature" title="http://w3id.org/reshare/ontology/0.3/#Signature">Signature</a>
</li>
</ul><div class="header-wrapper"><h4 id="object-properties-0">Object Properties</h4><a aria-label="Permalink for this Section" class="self-link" href="#overview"></a></div><ul class="hlist">
<li>
<a href="#factOrigin" title="http://w3id.org/reshare/ontology/0.3/#factOrigin">fact origin</a>
</li>
<li>
<a href="#fact" title="http://w3id.org/reshare/ontology/0.3/#fact">has fact</a>
</li>
<li>
<a href="#identifies" title="http://w3id.org/reshare/ontology/0.3/#identifies">identifies</a>
</li>
<li>
<a href="#receiver" title="http://w3id.org/reshare/ontology/0.3/#receiver">receiver</a>
</li>
<li>
<a href="#receiverSig" title="http://w3id.org/reshare/ontology/0.3/#receiverSig">receiver signature</a>
</li>
<li>
<a href="#requestedFactOrigin" title="http://w3id.org/reshare/ontology/0.3/#requestedFactOrigin">requested fact origin</a>
</li>
<li>
<a href="#sender" title="http://w3id.org/reshare/ontology/0.3/#sender">sender</a>
</li>
<li>
<a href="#senderSig" title="http://w3id.org/reshare/ontology/0.3/#senderSig">sender signature</a>
</li>
<li>
<a href="#sigType" title="http://w3id.org/reshare/ontology/0.3/#sigType">signature type</a>
</li>
</ul><div class="header-wrapper"><h4 id="data-properties-0">Data Properties</h4><a aria-label="Permalink for this Section" class="self-link" href="#overview"></a></div><ul class="hlist">
<li>
<a href="#certEncoding" title="http://w3id.org/reshare/ontology/0.3/#certEncoding">certificate encoding</a>
</li>
<li>
<a href="#certType" title="http://w3id.org/reshare/ontology/0.3/#certType">certificate type</a>
</li>
<li>
<a href="#customContent" title="http://w3id.org/reshare/ontology/0.3/#customContent">custom content</a>
</li>
<li>
<a href="#sha256Sum" title="http://w3id.org/reshare/ontology/0.3/#sha256Sum">fact checksum (sha256)</a>
</li>
<li>
<a href="#sha384Sum" title="http://w3id.org/reshare/ontology/0.3/#sha384Sum">fact checksum (sha384)</a>
</li>
<li>
<a href="#sha512Sum" title="http://w3id.org/reshare/ontology/0.3/#sha512Sum">fact checksum (sha512)</a>
</li>
<li>
<a href="#serialization" title="http://w3id.org/reshare/ontology/0.3/#serialization">fact serialization</a>
</li>
<li>
<a href="#receiverCustomContent" title="http://w3id.org/reshare/ontology/0.3/#receiverCustomContent">receiver custom content</a>
</li>
<li>
<a href="#senderCustomContent" title="http://w3id.org/reshare/ontology/0.3/#senderCustomContent">sender custom content</a>
</li>
<li>
<a href="#sigData" title="http://w3id.org/reshare/ontology/0.3/#sigData">signature data</a>
</li>
<li>
<a href="#sigEncoding" title="http://w3id.org/reshare/ontology/0.3/#sigEncoding">signature encoding</a>
</li>
<li>
<a href="#timestamp" title="http://w3id.org/reshare/ontology/0.3/#timestamp">timestamp</a>
</li>
<li>
<a href="#x509Cert" title="http://w3id.org/reshare/ontology/0.3/#x509Cert">X.509 certificate</a>
</li>
</ul><iframe height="500" src="webvowl/index.html" style="width: 100%;"></iframe>
</div>
</section>
<section id="sec-classes"><div class="header-wrapper"><h3 id="x5-2-classes"><bdi class="secno">5.2 </bdi>Classes</h3><a aria-label="Permalink for Section 5.2" class="self-link" href="#sec-classes"></a></div>
<div class="widoco" id="classes"><ul class="hlist">
<li>
<a href="#DTC" title="http://w3id.org/reshare/ontology/0.3/#DTC">Digital Transmission Contract</a>
</li>
<li>
<a href="#Fact" title="http://w3id.org/reshare/ontology/0.3/#Fact">Fact</a>
</li>
<li>
<a href="#Identity" title="http://w3id.org/reshare/ontology/0.3/#Identity">Identity</a>
</li>
<li>
<a href="#Receiver" title="http://w3id.org/reshare/ontology/0.3/#Receiver">Receiver</a>
</li>
<li>
<a href="#Sender" title="http://w3id.org/reshare/ontology/0.3/#Sender">Sender</a>
</li>
<li>
<a href="#Signature" title="http://w3id.org/reshare/ontology/0.3/#Signature">Signature</a>
</li>
</ul><div class="entity" id="DTC">
<div class="header-wrapper"><h3 id="digital-transmission-contractc">Digital Transmission Contract<sup class="type-c" title="class">c</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#DTC"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#DTC</p>
<div class="comment">
<p>A Digital Transmisson Contract (DTC), used to create data immutability through bilateral signatures.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<dl class="description">
<dt>is in domain of</dt>
<dd>
<a href="#customContent" title="http://w3id.org/reshare/ontology/0.3/#customContent">custom content</a>
<sup class="type-dp" title="data property">dp</sup>, <a href="#fact" title="http://w3id.org/reshare/ontology/0.3/#fact">has fact</a>
<sup class="type-op" title="object property">op</sup>, <a href="#receiver" title="http://w3id.org/reshare/ontology/0.3/#receiver">receiver</a>
<sup class="type-op" title="object property">op</sup>, <a href="#receiverCustomContent" title="http://w3id.org/reshare/ontology/0.3/#receiverCustomContent">receiver custom content</a>
<sup class="type-dp" title="data property">dp</sup>, <a href="#receiverSig" title="http://w3id.org/reshare/ontology/0.3/#receiverSig">receiver signature</a>
<sup class="type-op" title="object property">op</sup>, <a href="#sender" title="http://w3id.org/reshare/ontology/0.3/#sender">sender</a>
<sup class="type-op" title="object property">op</sup>, <a href="#senderCustomContent" title="http://w3id.org/reshare/ontology/0.3/#senderCustomContent">sender custom content</a>
<sup class="type-dp" title="data property">dp</sup>, <a href="#senderSig" title="http://w3id.org/reshare/ontology/0.3/#senderSig">sender signature</a>
<sup class="type-op" title="object property">op</sup>, <a href="#timestamp" title="http://w3id.org/reshare/ontology/0.3/#timestamp">timestamp</a>
<sup class="type-dp" title="data property">dp</sup>
</dd>
</dl>
</div><div class="entity" id="Fact">
<div class="header-wrapper"><h3 id="factc">Fact<sup class="type-c" title="class">c</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#Fact"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#Fact</p>
<div class="comment">
<p>A resource checksum which is included in a DTC.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<dl class="description">
<dt>is in domain of</dt>
<dd>
<a href="#sha256Sum" title="http://w3id.org/reshare/ontology/0.3/#sha256Sum">fact checksum (sha256)</a>
<sup class="type-dp" title="data property">dp</sup>, <a href="#sha384Sum" title="http://w3id.org/reshare/ontology/0.3/#sha384Sum">fact checksum (sha384)</a>
<sup class="type-dp" title="data property">dp</sup>, <a href="#sha512Sum" title="http://w3id.org/reshare/ontology/0.3/#sha512Sum">fact checksum (sha512)</a>
<sup class="type-dp" title="data property">dp</sup>, <a href="#factOrigin" title="http://w3id.org/reshare/ontology/0.3/#factOrigin">fact origin</a>
<sup class="type-op" title="object property">op</sup>, <a href="#serialization" title="http://w3id.org/reshare/ontology/0.3/#serialization">fact serialization</a>
<sup class="type-dp" title="data property">dp</sup>, <a href="#requestedFactOrigin" title="http://w3id.org/reshare/ontology/0.3/#requestedFactOrigin">requested fact origin</a>
<sup class="type-op" title="object property">op</sup>
</dd>
<dt>is in range of</dt>
<dd>
<a href="#fact" title="http://w3id.org/reshare/ontology/0.3/#fact">has fact</a>
<sup class="type-op" title="object property">op</sup>
</dd>
</dl>
</div><div class="entity" id="Identity">
<div class="header-wrapper"><h3 id="identityc">Identity<sup class="type-c" title="class">c</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#Identity"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#Identity</p>
<div class="comment">
<p>An identity of a transmission party.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<dl class="description">
<dt>has sub-classes</dt>
<dd>
<a href="#Receiver" title="http://w3id.org/reshare/ontology/0.3/#Receiver">Receiver</a>
<sup class="type-c" title="class">c</sup>, <a href="#Sender" title="http://w3id.org/reshare/ontology/0.3/#Sender">Sender</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>is in domain of</dt>
<dd>
<a href="#x509Cert" title="http://w3id.org/reshare/ontology/0.3/#x509Cert">X.509 certificate</a>
<sup class="type-dp" title="data property">dp</sup>, <a href="#certEncoding" title="http://w3id.org/reshare/ontology/0.3/#certEncoding">certificate encoding</a>
<sup class="type-dp" title="data property">dp</sup>, <a href="#certType" title="http://w3id.org/reshare/ontology/0.3/#certType">certificate type</a>
<sup class="type-dp" title="data property">dp</sup>, <a href="#identifies" title="http://w3id.org/reshare/ontology/0.3/#identifies">identifies</a>
<sup class="type-op" title="object property">op</sup>
</dd>
</dl>
</div><div class="entity" id="Receiver">
<div class="header-wrapper"><h3 id="receiverc">Receiver<sup class="type-c" title="class">c</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#Receiver"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#Receiver</p>
<div class="comment">
<p>The receiver of a transmission.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<dl class="description">
<dt>has super-classes</dt>
<dd>
<a href="#Identity" title="http://w3id.org/reshare/ontology/0.3/#Identity">Identity</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>is in range of</dt>
<dd>
<a href="#receiver" title="http://w3id.org/reshare/ontology/0.3/#receiver">receiver</a>
<sup class="type-op" title="object property">op</sup>
</dd>
</dl>
</div><div class="entity" id="Sender">
<div class="header-wrapper"><h3 id="senderc">Sender<sup class="type-c" title="class">c</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#Sender"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#Sender</p>
<div class="comment">
<p>The data source (sender) of a transmission.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<dl class="description">
<dt>has super-classes</dt>
<dd>
<a href="#Identity" title="http://w3id.org/reshare/ontology/0.3/#Identity">Identity</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>is in range of</dt>
<dd>
<a href="#sender" title="http://w3id.org/reshare/ontology/0.3/#sender">sender</a>
<sup class="type-op" title="object property">op</sup>
</dd>
</dl>
</div><div class="entity" id="Signature">
<div class="header-wrapper"><h3 id="signaturec">Signature<sup class="type-c" title="class">c</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#Signature"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#Signature</p>
<div class="comment">
<p>A contract signature created by one of the transmission parties.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<dl class="description">
<dt>is in domain of</dt>
<dd>
<a href="#sigData" title="http://w3id.org/reshare/ontology/0.3/#sigData">signature data</a>
<sup class="type-dp" title="data property">dp</sup>, <a href="#sigEncoding" title="http://w3id.org/reshare/ontology/0.3/#sigEncoding">signature encoding</a>
<sup class="type-dp" title="data property">dp</sup>, <a href="#sigType" title="http://w3id.org/reshare/ontology/0.3/#sigType">signature type</a>
<sup class="type-op" title="object property">op</sup>
</dd>
<dt>is in range of</dt>
<dd>
<a href="#receiverSig" title="http://w3id.org/reshare/ontology/0.3/#receiverSig">receiver signature</a>
<sup class="type-op" title="object property">op</sup>, <a href="#senderSig" title="http://w3id.org/reshare/ontology/0.3/#senderSig">sender signature</a>
<sup class="type-op" title="object property">op</sup>
</dd>
</dl>
</div></div>
</section>
<section id="object-properties"><div class="header-wrapper"><h3 id="x5-3-object-properties"><bdi class="secno">5.3 </bdi>Object Properties</h3><a aria-label="Permalink for Section 5.3" class="self-link" href="#object-properties"></a></div>
<div class="widoco" id="objectproperties"><ul class="hlist">
<li>
<a href="#factOrigin" title="http://w3id.org/reshare/ontology/0.3/#factOrigin">fact origin</a>
</li>
<li>
<a href="#fact" title="http://w3id.org/reshare/ontology/0.3/#fact">has fact</a>
</li>
<li>
<a href="#identifies" title="http://w3id.org/reshare/ontology/0.3/#identifies">identifies</a>
</li>
<li>
<a href="#receiver" title="http://w3id.org/reshare/ontology/0.3/#receiver">receiver</a>
</li>
<li>
<a href="#receiverSig" title="http://w3id.org/reshare/ontology/0.3/#receiverSig">receiver signature</a>
</li>
<li>
<a href="#requestedFactOrigin" title="http://w3id.org/reshare/ontology/0.3/#requestedFactOrigin">requested fact origin</a>
</li>
<li>
<a href="#sender" title="http://w3id.org/reshare/ontology/0.3/#sender">sender</a>
</li>
<li>
<a href="#senderSig" title="http://w3id.org/reshare/ontology/0.3/#senderSig">sender signature</a>
</li>
<li>
<a href="#sigType" title="http://w3id.org/reshare/ontology/0.3/#sigType">signature type</a>
</li>
</ul><div class="entity" id="factOrigin">
<div class="header-wrapper"><h3 id="fact-originop">fact origin<sup class="type-op" title="object property">op</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#factOrigin"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#factOrigin</p>
<div class="comment">
<p>The resource which is referenced by the fact.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#Fact" title="http://w3id.org/reshare/ontology/0.3/#Fact">Fact</a>
<sup class="type-c" title="class">c</sup>
</dd>
</dl>
</div>
</div><div class="entity" id="fact">
<div class="header-wrapper"><h3 id="has-factop">has fact<sup class="type-op" title="object property">op</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#fact"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#fact</p>
<div class="comment">
<p>A fact included in a DTC.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#DTC" title="http://w3id.org/reshare/ontology/0.3/#DTC">Digital Transmission Contract</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="#Fact" title="http://w3id.org/reshare/ontology/0.3/#Fact">Fact</a>
<sup class="type-c" title="class">c</sup>
</dd>
</dl>
</div>
</div><div class="entity" id="identifies">
<div class="header-wrapper"><h3 id="identifiesop">identifies<sup class="type-op" title="object property">op</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#identifies"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#identifies</p>
<div class="comment">
<p>Links an identity of a receiver or sender as part of a contract to that entity. It is best practice to use an instance of foaf:Agent as the object to this property.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#Identity" title="http://w3id.org/reshare/ontology/0.3/#Identity">Identity</a>
<sup class="type-c" title="class">c</sup>
</dd>
</dl>
</div>
</div><div class="entity" id="receiver">
<div class="header-wrapper"><h3 id="receiverop">receiver<sup class="type-op" title="object property">op</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#receiver"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#receiver</p>
<div class="comment">
<p>The data receiver of the underlying transmission of a DTC.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#DTC" title="http://w3id.org/reshare/ontology/0.3/#DTC">Digital Transmission Contract</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="#Receiver" title="http://w3id.org/reshare/ontology/0.3/#Receiver">Receiver</a>
<sup class="type-c" title="class">c</sup>
</dd>
</dl>
</div>
</div><div class="entity" id="receiverSig">
<div class="header-wrapper"><h3 id="receiver-signatureop">receiver signature<sup class="type-op" title="object property">op</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#receiverSig"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#receiverSig</p>
<div class="comment">
<p>The contract signature created by the receiver of the DTC.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#DTC" title="http://w3id.org/reshare/ontology/0.3/#DTC">Digital Transmission Contract</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="#Signature" title="http://w3id.org/reshare/ontology/0.3/#Signature">Signature</a>
<sup class="type-c" title="class">c</sup>
</dd>
</dl>
</div>
</div><div class="entity" id="requestedFactOrigin">
<div class="header-wrapper"><h3 id="requested-fact-originop">requested fact origin<sup class="type-op" title="object property">op</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#requestedFactOrigin"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#requestedFactOrigin</p>
<div class="comment">
<p>The resource which was referenced by the receiver when initially requesting a contract. This property is used when the resource reference is updated by the sender during the contract generation handshake.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#Fact" title="http://w3id.org/reshare/ontology/0.3/#Fact">Fact</a>
<sup class="type-c" title="class">c</sup>
</dd>
</dl>
</div>
</div><div class="entity" id="sender">
<div class="header-wrapper"><h3 id="senderop">sender<sup class="type-op" title="object property">op</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#sender"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#sender</p>
<div class="comment">
<p>The data source (sender) of the underlying transmission of a DTC.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#DTC" title="http://w3id.org/reshare/ontology/0.3/#DTC">Digital Transmission Contract</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="#Sender" title="http://w3id.org/reshare/ontology/0.3/#Sender">Sender</a>
<sup class="type-c" title="class">c</sup>
</dd>
</dl>
</div>
</div><div class="entity" id="senderSig">
<div class="header-wrapper"><h3 id="sender-signatureop">sender signature<sup class="type-op" title="object property">op</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#senderSig"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#senderSig</p>
<div class="comment">
<p>The contract signature created by the sender of the DTC.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#DTC" title="http://w3id.org/reshare/ontology/0.3/#DTC">Digital Transmission Contract</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="#Signature" title="http://w3id.org/reshare/ontology/0.3/#Signature">Signature</a>
<sup class="type-c" title="class">c</sup>
</dd>
</dl>
</div>
</div><div class="entity" id="sigType">
<div class="header-wrapper"><h3 id="signature-typeop">signature type<sup class="type-op" title="object property">op</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#sigType"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#sigType</p>
<div class="comment">
<p>The type of a contract signature. The object should be an OID URN to a cryptographic signature scheme. As of now, 'urn:oid:1.2.840.113549.1.1.10' is considered the default value, identifying the RSASSA-PSS signature scheme as specified in PKCS #1 v2.2.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#Signature" title="http://w3id.org/reshare/ontology/0.3/#Signature">Signature</a>
<sup class="type-c" title="class">c</sup>
</dd>
</dl>
</div>
</div></div>
</section>
<section id="data-properties"><div class="header-wrapper"><h3 id="x5-4-data-properties"><bdi class="secno">5.4 </bdi>Data Properties</h3><a aria-label="Permalink for Section 5.4" class="self-link" href="#data-properties"></a></div>
<div class="widoco" id="dataproperties"><ul class="hlist">
<li>
<a href="#certEncoding" title="http://w3id.org/reshare/ontology/0.3/#certEncoding">certificate encoding</a>
</li>
<li>
<a href="#certType" title="http://w3id.org/reshare/ontology/0.3/#certType">certificate type</a>
</li>
<li>
<a href="#customContent" title="http://w3id.org/reshare/ontology/0.3/#customContent">custom content</a>
</li>
<li>
<a href="#sha256Sum" title="http://w3id.org/reshare/ontology/0.3/#sha256Sum">fact checksum (sha256)</a>
</li>
<li>
<a href="#sha384Sum" title="http://w3id.org/reshare/ontology/0.3/#sha384Sum">fact checksum (sha384)</a>
</li>
<li>
<a href="#sha512Sum" title="http://w3id.org/reshare/ontology/0.3/#sha512Sum">fact checksum (sha512)</a>
</li>
<li>
<a href="#serialization" title="http://w3id.org/reshare/ontology/0.3/#serialization">fact serialization</a>
</li>
<li>
<a href="#receiverCustomContent" title="http://w3id.org/reshare/ontology/0.3/#receiverCustomContent">receiver custom content</a>
</li>
<li>
<a href="#senderCustomContent" title="http://w3id.org/reshare/ontology/0.3/#senderCustomContent">sender custom content</a>
</li>
<li>
<a href="#sigData" title="http://w3id.org/reshare/ontology/0.3/#sigData">signature data</a>
</li>
<li>
<a href="#sigEncoding" title="http://w3id.org/reshare/ontology/0.3/#sigEncoding">signature encoding</a>
</li>
<li>
<a href="#timestamp" title="http://w3id.org/reshare/ontology/0.3/#timestamp">timestamp</a>
</li>
<li>
<a href="#x509Cert" title="http://w3id.org/reshare/ontology/0.3/#x509Cert">X.509 certificate</a>
</li>
</ul><div class="entity" id="certEncoding">
<div class="header-wrapper"><h3 id="certificate-encodingdp">certificate encoding<sup class="type-dp" title="data property">dp</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#certEncoding"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#certEncoding</p>
<div class="comment">
<p>Encoding of the (binary) certificate data object to the x509Cert property. 'base64' is considered the default value, expressing that the (binary) certificate data which is object to the x509Cert property is encoded using Base64.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#Identity" title="http://w3id.org/reshare/ontology/0.3/#Identity">Identity</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="http://www.w3.org/2000/01/rdf-schema#Literal" target="_blank" title="http://www.w3.org/2000/01/rdf-schema#Literal">literal</a>
</dd>
</dl>
</div>
</div><div class="entity" id="certType">
<div class="header-wrapper"><h3 id="certificate-typedp">certificate type<sup class="type-dp" title="data property">dp</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#certType"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#certType</p>
<div class="comment">
<p>The type of the certificate provided by the Identity. 'X509'/'X509-single' identify single X.509 certificates in ASN.1 DER notation, and 'PKCS7'/'X509-PKCS7-chain' identify an X.509 certificate chain encoded as a PKCS#7 message.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#Identity" title="http://w3id.org/reshare/ontology/0.3/#Identity">Identity</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="http://www.w3.org/2000/01/rdf-schema#Literal" target="_blank" title="http://www.w3.org/2000/01/rdf-schema#Literal">literal</a>
</dd>
</dl>
</div>
</div><div class="entity" id="customContent">
<div class="header-wrapper"><h3 id="custom-contentdp">custom content<sup class="type-dp" title="data property">dp</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#customContent"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#customContent</p>
<div class="comment">
<p>The property linking a DTC to the custom content included by one of the parties. The object should be a literal with the JSON type (<a href="http://www.w3.org/1999/02/22-rdf-syntax-ns#JSON">http://www.w3.org/1999/02/22-rdf-syntax-ns#JSON</a>). Abstract property, use the sub-properties instead.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has sub-properties</dt>
<dd>
<a href="#receiverCustomContent" title="http://w3id.org/reshare/ontology/0.3/#receiverCustomContent">receiver custom content</a>
<sup class="type-dp" title="data property">dp</sup>, <a href="#senderCustomContent" title="http://w3id.org/reshare/ontology/0.3/#senderCustomContent">sender custom content</a>
<sup class="type-dp" title="data property">dp</sup>
</dd>
<dt>has domain</dt>
<dd>
<a href="#DTC" title="http://w3id.org/reshare/ontology/0.3/#DTC">Digital Transmission Contract</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="http://www.w3.org/2000/01/rdf-schema#Literal" target="_blank" title="http://www.w3.org/2000/01/rdf-schema#Literal">literal</a>
</dd>
</dl>
</div>
</div><div class="entity" id="sha256Sum">
<div class="header-wrapper"><h3 id="fact-checksum-sha256-dp">fact checksum (sha256)<sup class="type-dp" title="data property">dp</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#sha256Sum"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#sha256Sum</p>
<div class="comment">
<p>A SHA-256 checksum of a fact. Should be encoded as a hex stream using the xsd:hexBinary literal type.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#Fact" title="http://w3id.org/reshare/ontology/0.3/#Fact">Fact</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="http://www.w3.org/2000/01/rdf-schema#Literal" target="_blank" title="http://www.w3.org/2000/01/rdf-schema#Literal">literal</a>
</dd>
</dl>
</div>
</div><div class="entity" id="sha384Sum">
<div class="header-wrapper"><h3 id="fact-checksum-sha384-dp">fact checksum (sha384)<sup class="type-dp" title="data property">dp</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#sha384Sum"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#sha384Sum</p>
<div class="comment">
<p>A SHA-384 checksum of a fact. Should be encoded as a hex stream using the xsd:hexBinary literal type.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#Fact" title="http://w3id.org/reshare/ontology/0.3/#Fact">Fact</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="http://www.w3.org/2000/01/rdf-schema#Literal" target="_blank" title="http://www.w3.org/2000/01/rdf-schema#Literal">literal</a>
</dd>
</dl>
</div>
</div><div class="entity" id="sha512Sum">
<div class="header-wrapper"><h3 id="fact-checksum-sha512-dp">fact checksum (sha512)<sup class="type-dp" title="data property">dp</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#sha512Sum"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#sha512Sum</p>
<div class="comment">
<p>A SHA-512 checksum of a fact. Should be encoded as a hex stream using the xsd:hexBinary literal type.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#Fact" title="http://w3id.org/reshare/ontology/0.3/#Fact">Fact</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="http://www.w3.org/2000/01/rdf-schema#Literal" target="_blank" title="http://www.w3.org/2000/01/rdf-schema#Literal">literal</a>
</dd>
</dl>
</div>
</div><div class="entity" id="serialization">
<div class="header-wrapper"><h3 id="fact-serializationdp">fact serialization<sup class="type-dp" title="data property">dp</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#serialization"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#serialization</p>
<div class="comment">
<p>The serialization method used to create a verifiable fact checksum. Some string identifiers are defined in the specification of ReShare (see TODO: ref to ReShare)</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#Fact" title="http://w3id.org/reshare/ontology/0.3/#Fact">Fact</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="http://www.w3.org/2000/01/rdf-schema#Literal" target="_blank" title="http://www.w3.org/2000/01/rdf-schema#Literal">literal</a>
</dd>
</dl>
</div>
</div><div class="entity" id="receiverCustomContent">
<div class="header-wrapper"><h3 id="receiver-custom-contentdp">receiver custom content<sup class="type-dp" title="data property">dp</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#receiverCustomContent"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#receiverCustomContent</p>
<div class="comment">
<p>The receiver's custom content.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has super-properties</dt>
<dd>
<a href="#customContent" title="http://w3id.org/reshare/ontology/0.3/#customContent">custom content</a>
<sup class="type-dp" title="data property">dp</sup>
</dd>
<dt>has domain</dt>
<dd>
<a href="#DTC" title="http://w3id.org/reshare/ontology/0.3/#DTC">Digital Transmission Contract</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="http://www.w3.org/2000/01/rdf-schema#Literal" target="_blank" title="http://www.w3.org/2000/01/rdf-schema#Literal">literal</a>
</dd>
</dl>
</div>
</div><div class="entity" id="senderCustomContent">
<div class="header-wrapper"><h3 id="sender-custom-contentdp">sender custom content<sup class="type-dp" title="data property">dp</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#senderCustomContent"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#senderCustomContent</p>
<div class="comment">
<p>The sender's custom content.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has super-properties</dt>
<dd>
<a href="#customContent" title="http://w3id.org/reshare/ontology/0.3/#customContent">custom content</a>
<sup class="type-dp" title="data property">dp</sup>
</dd>
<dt>has domain</dt>
<dd>
<a href="#DTC" title="http://w3id.org/reshare/ontology/0.3/#DTC">Digital Transmission Contract</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="http://www.w3.org/2000/01/rdf-schema#Literal" target="_blank" title="http://www.w3.org/2000/01/rdf-schema#Literal">literal</a>
</dd>
</dl>
</div>
</div><div class="entity" id="sigData">
<div class="header-wrapper"><h3 id="signature-datadp">signature data<sup class="type-dp" title="data property">dp</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#sigData"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#sigData</p>
<div class="comment">
<p>The signature data, encoded as a character sequence. More information about the type and encoding can be provided with the sigType and sigEncoding properties. If Base64 is used for the character encoding, the literal type should be xsd:base64Binary.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#Signature" title="http://w3id.org/reshare/ontology/0.3/#Signature">Signature</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="http://www.w3.org/2000/01/rdf-schema#Literal" target="_blank" title="http://www.w3.org/2000/01/rdf-schema#Literal">literal</a>
</dd>
</dl>
</div>
</div><div class="entity" id="sigEncoding">
<div class="header-wrapper"><h3 id="signature-encodingdp">signature encoding<sup class="type-dp" title="data property">dp</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#sigEncoding"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#sigEncoding</p>
<div class="comment">
<p>The signature encoding. 'base64' is considered the default value, expressing that the (binary) signature data which is object to the sigData property is encoded using Base64.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#Signature" title="http://w3id.org/reshare/ontology/0.3/#Signature">Signature</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="http://www.w3.org/2000/01/rdf-schema#Literal" target="_blank" title="http://www.w3.org/2000/01/rdf-schema#Literal">literal</a>
</dd>
</dl>
</div>
</div><div class="entity" id="timestamp">
<div class="header-wrapper"><h3 id="timestampdp">timestamp<sup class="type-dp" title="data property">dp</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#timestamp"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#timestamp</p>
<div class="comment">
<p>The timestamp of a DTC. Should be in the RFC3339 profile of ISO 8601, and should have the xsd:dateTimeStamp literal type.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#DTC" title="http://w3id.org/reshare/ontology/0.3/#DTC">Digital Transmission Contract</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="http://www.w3.org/2000/01/rdf-schema#Literal" target="_blank" title="http://www.w3.org/2000/01/rdf-schema#Literal">literal</a>
</dd>
</dl>
</div>
</div><div class="entity" id="x509Cert">
<div class="header-wrapper"><h3 id="x-509-certificatedp">X.509 certificate<sup class="type-dp" title="data property">dp</sup>
</h3><a aria-label="Permalink for this Section" class="self-link" href="#x509Cert"></a></div>
<p>
<strong>IRI:</strong> http://w3id.org/reshare/ontology/0.3/#x509Cert</p>
<div class="comment">
<p>The public key certificate of a transmission party. Should be the full certificate chain,     excluding the root certificate, encoded as a character sequence. Further information about the certificate can be included in the certType and certEncoding properties. If Base64 is used for the character encoding, the xsd:base64Binary literal type should be used.</p>
</div>
<dl class="definedBy">
<dt>Is defined by</dt>
<dd>
<a href="http://w3id.org/reshare/ontology/0.3/">http://w3id.org/reshare/ontology/0.3/</a>
</dd>
</dl>
<dl>
<dt>Term status</dt>
<dd>stable</dd>
</dl>
<div class="description">
<dl>
<dt>has domain</dt>
<dd>
<a href="#Identity" title="http://w3id.org/reshare/ontology/0.3/#Identity">Identity</a>
<sup class="type-c" title="class">c</sup>
</dd>
<dt>has range</dt>
<dd>
<a href="http://www.w3.org/2000/01/rdf-schema#Literal" target="_blank" title="http://www.w3.org/2000/01/rdf-schema#Literal">literal</a>
</dd>
</dl>
</div>
</div></div>
</section>
<section class="notoc" id="legend"><div class="header-wrapper"><h3 id="legend-0">Legend</h3><a aria-label="Permalink for this Section" class="self-link" href="#legend"></a></div>
<div class="widoco entity">
<sup class="type-c" title="Classes">c</sup>: Classes <br/>
<sup class="type-op" title="Object Properties">op</sup>: Object Properties <br/>
<sup class="type-dp" title="Datatype Properties">dp</sup>: Datatype Properties <br/>
<sup class="type-ni" title="Named Individuals">ni</sup>: Named Individuals
      </div>
</section>
</section>
<section id="dtc-generation-and-verification"><div class="header-wrapper"><h2 id="x6-dtc-generation-verification"><bdi class="secno">6. </bdi>DTC Generation &amp; Verification</h2><a aria-label="Permalink for Section 6." class="self-link" href="#dtc-generation-and-verification"></a></div>
<div class="tlcontent">
<p>
        Two core mechanisms are defined as part of ReShare:
      </p>
<ul>
<li>A <a href="#dtcgenver-generation"><em>generation mechanism</em></a> to generate valid DTCs between parties.
        </li>
<li>A <a href="#dtcgenver-verification"><em>verification mechanism</em></a> to reliably verify both the validity of the dtc and the contained resource checksums.</li>
</ul>
<p>
        Any implementation <em class="rfc2119">MUST</em> implement the <a href="#dtcgenver-verification">verification mechanism</a> mechanism according to Section <a class="sec-ref" href="#dtcgenver-verification"><bdi class="secno">6.2 </bdi>DTC Verification</a>.
      </p>
<p>
        The <a href="#dtcgenver-generation">generation mechanism</a>, which is specified in Section <a class="sec-ref" href="#dtcgenver-generation"><bdi class="secno">6.1 </bdi>DTC Generation Handshake</a>, follows a client-server-paradigm.
        To allow for application-dependent lightweight implementations, the client and server parts of the <a href="#dtcgenver-generation">generation mechanism</a> <em class="rfc2119">MAY</em> not be implemented.
        The following combinations are possible:
      </p>
<table class="customtable">
<thead>
<tr>
<th>Server implemented</th>
<th>Client implemented</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Yes</td>
<td>Yes</td>
<td>Full implementation</td>
</tr>
<tr>
<td>Yes</td>
<td>No</td>
<td>Only supports <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-28">sender</a> role &amp; DTC verification</td>
</tr>
<tr>
<td>No</td>
<td>Yes</td>
<td>Only supports <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-24">receiver</a> role &amp; DTC verification</td>
</tr>
<tr>
<td>No</td>
<td>No</td>
<td>Only supports DTC verification</td>
</tr>
</tbody>
</table>
</div>
<section id="dtcgenver-generation"><div class="header-wrapper"><h3 id="x6-1-dtc-generation-handshake"><bdi class="secno">6.1 </bdi>DTC Generation Handshake</h3><a aria-label="Permalink for Section 6.1" class="self-link" href="#dtcgenver-generation"></a></div>
<div class="tlcontent">
<p>
          The DTC generation mechanism constitutes a handshake, in which <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-29">sender</a> and <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-25">receiver</a> jointly create and sign a DTC in a client-server paradigm.
        </p>
<p>
          We specify two versions of this generation handshake:
          A complete 3-way version, which can be carried out completely in parallel to the underlying data transmission,
          and an abbreviated 2-way handshake, which can be used if the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-26">receiver</a> has access to the complete underlying data of the DTC (i.e., the data transmission has to be completed already).
        </p>
<p>
          The benefits of the independence of DTC generation to the data transmission are expected to outweigh the effects of the increased overhead in most use cases.
          Thus, we consider the complete 3-way handshake the default handshake version.
          A brief elaboration on this discussion can be found in Section <a class="sec-ref" href="#considerations-2or3wayhs"><bdi class="secno">A.3 </bdi>DTC Generation: Two Handshake Versions</a>.
        </p>
<p>
          We do not specify any mechanism to separate handshake versions or negotiate the handshake version.
          Instead, such a mechanism <em class="rfc2119">MAY</em> be implemented on a lower layer (e.g., by using HTTP content negotiation or using two ports for separating the two handshake versions).
        </p>
</div>
<section class="informative" id="dtcgenver-generation-overview"><div class="header-wrapper"><h4 id="x6-1-1-overview"><bdi class="secno">6.1.1 </bdi>Overview</h4><a aria-label="Permalink for Section 6.1.1" class="self-link" href="#dtcgenver-generation-overview"></a></div><p><em>This section is non-normative.</em></p>
<p>
          The specification of the DTC generation mechanism is divided into the following components:
        </p>
<ul>
<li>
<i>Client and server implementations:</i>
            Define the behavior which implements the handshake itself, depending on the handshake version (i.e.,
            complete or abbreviated).
            The client and server implementations receive messages from the abstraction components for the lower-layer communication stack, build new messages, and send these messages to the abstraction components of the communication stack.
          </li>
<li>
<i>Helper components:</i>
            We define a <i>message builder</i>, a <i>message validator</i>, and an <i>error message builder</i>, which are used by the client and server implementations to validate and build message objects.
          </li>
<li>
<i>Communication abstraction components:</i>
            Directly communicate with the deployment-specific communication stack, such that the client and server implementations can be transparent w.r.t. the underlying communication stack.
          </li>
</ul>
<p>The DTC generation components are visualized in the following figure.</p>
<figure id="fig-dtcgen-overview" style="text-align: center;">
<object aria-describedby="fig-dtcgen-overview" data="figures/dtc-generation-overview.svg" style="width:100%;" type="image/svg+xml"></object>
<p id="fig-dtcgen-overview-alt">
            Overview of the components of the DTC generation mechanism.
          </p>
<figcaption><a class="self-link" href="#fig-dtcgen-overview">Figure <bdi class="figno">8</bdi></a> <span class="fig-title">
            A schematic overview of the components of the DTC generation mechanism.
          </span></figcaption>
</figure>
</section>
<section id="dtcgenver-generation-complete"><div class="header-wrapper"><h4 id="x6-1-2-complete-3-way-handshake"><bdi class="secno">6.1.2 </bdi>Complete (3-way) Handshake</h4><a aria-label="Permalink for Section 6.1.2" class="self-link" href="#dtcgenver-generation-complete"></a></div>
<div class="tlcontent">
<p>
            The complete DTC generation handshake consists of the following three steps, which are described in detail in the following:
          </p>
<ol>
<li>
              The <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-27">receiver</a> initiates the DTC generation by stating its identity and the set of facts to be included in the DTC.
              The current version of the DTC only contains the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-4"><code>receiver</code></a>, <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-8"><code>facts</code></a> (only <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-25">IRIs</a>, no checksums), and <a class="internalDFN" data-link-type="dfn" data-lt="dtc-customContent" href="#dfn-dtc-customcontent" id="ref-for-dfn-dtc-customcontent-1"><code>receiverCustomContent</code></a> fields.
            </li>
<li>
              Upon receipt of the initiation message, the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-30">sender</a> compiles and signs the contract.
              The current version of the DTC is only missing the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiverSig" href="#dfn-dtc-receiversig" id="ref-for-dfn-dtc-receiversig-8"><code>receiverSig</code></a> field.
            </li>
<li>
              Upon receipt of the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-31">sender</a>-signed (partial) DTC, the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-28">receiver</a> verifies the current state of the DTC and signs it afterward.
              The DTC is now complete and valid, and is sent back to the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-32">sender</a> for mutual storage.
            </li>
</ol>
<p>
            The following figure gives an overview of the handshake messages and computations.
            Note that only the differential message contents are listed, as the previously existing DTC content is carried over to the next messages.
            The caption includes a mapping from the message abbreviations used in the figure to the message identifiers defined in Section <a class="sec-ref" href="#dtcgenver-generation-msgids"><bdi class="secno">6.1.4 </bdi>Message Identifiers</a>.
          </p>
<figure id="fig-dtc-generation-handshake" style="text-align:center">
<object aria-describedby="fig-dtc-generation-handshake" data="figures/contract-generation-handshake.svg" style="width:100%;" type="image/svg+xml"></object>
<p id="fig-contract-generation-handshake-alt">
              The 3-way contract generation handshake </p>
<figcaption><a class="self-link" href="#fig-dtc-generation-handshake">Figure <bdi class="figno">9</bdi></a> <span class="fig-title">
              A message diagram of the 3-way contract generation handshake, initiated by the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-29">receiver</a> (<span class="fig-agent">R</span>).
              Upon a request (<i>R1</i>=<code>ContractRequest</code>), the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-33">sender</a> (<span class="fig-agent">S</span>) assembles the DTC, signs it, and sends it to the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-30">receiver</a> (<i>S1</i>=<code>SenderContract</code>).
              Finally, the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-31">receiver</a> verifies and signs the DTC, and sends its own signature to the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-34">sender</a>
              (<i>R2</i>=<code>ReceiverContract</code>).
            </span></figcaption>
</figure>
<p>
            In the following, we define the behavior of client and server implementations in detail.
          </p>
<section class="notoc">
<div class="header-wrapper"><h5 id="handshake-initiation-client-side">Handshake Initiation (Client-side)</h5><a aria-label="Permalink for this Section" class="self-link" href="#handshake-initiation-client-side"></a></div>
<p>
              The client is responsible for initiating the DTC generation handshake.
              For this, an appropriate user interface (manual trigger) or interface to the data-sharing system (automatic trigger) <em class="rfc2119">SHOULD</em> be implemented.
            </p>
<p>
              To initiate the DTC generation, the client <em class="rfc2119">MUST</em> first compile a partial DTC only consisting of the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-5"><code>receiver</code></a>, the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-9"><code>facts</code></a>, and the (optional) <a class="internalDFN" data-link-type="dfn" data-lt="dtc-customContent" href="#dfn-dtc-customcontent" id="ref-for-dfn-dtc-customcontent-2"><code>receiverCustomContent</code></a> fields.
              The content of the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-6"><code>receiver</code></a> and <a class="internalDFN" data-link-type="dfn" data-lt="dtc-customContent" href="#dfn-dtc-customcontent" id="ref-for-dfn-dtc-customcontent-3"><code>receiverCustomContent</code></a> fields <em class="rfc2119">MUST</em> comply with the contents specified in Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
              The content of <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-10"><code>facts</code></a> <em class="rfc2119">MUST</em> comply with its definition in Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>, except that the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-requestedID" href="#dfn-dtc-facts-requestedid" id="ref-for-dfn-dtc-facts-requestedid-1"><code>requestedID</code></a>, <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-alg" href="#dfn-dtc-facts-alg" id="ref-for-dfn-dtc-facts-alg-1"><code>&lt;alg&gt;</code></a>, and <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-serialization" href="#dfn-dtc-facts-serialization" id="ref-for-dfn-dtc-facts-serialization-1"><code>serialization</code></a>
              sub-fields <em class="rfc2119">MUST NOT</em> be present for any entry.
            </p>
<p>
              The client then <em class="rfc2119">MUST</em> use the partial DTC to build the <code>ContractRequest</code> message by passing the partial DTC to the message builder defined in Section <a class="sec-ref" href="#dtcgenver-generation-msgbuilder"><bdi class="secno">6.1.5 </bdi>Message Builder</a>, and use the <a class="internalDFN" data-link-type="dfn" href="#dfn-outgoing-message-interface" id="ref-for-dfn-outgoing-message-interface-1">outgoing message interface</a> (see Section <a class="sec-ref" href="#dtcgenver-generation-protocol"><bdi class="secno">6.1.9 </bdi>Protocol Stack</a>) to send it to the server.
            </p>
</section>
<section class="notoc">
<div class="header-wrapper"><h5 id="client-side-incoming-message-handling">Client-side Incoming Message Handling</h5><a aria-label="Permalink for this Section" class="self-link" href="#client-side-incoming-message-handling"></a></div>
<p>
              Once the client implementation is called by the <a class="internalDFN" data-link-type="dfn" href="#dfn-incoming-message-handler" id="ref-for-dfn-incoming-message-handler-1">incoming message handler</a> (see Section <a class="sec-ref" href="#dtcgenver-generation-protocol"><bdi class="secno">6.1.9 </bdi>Protocol Stack</a>), the following procedure <em class="rfc2119">MUST</em> be carried out.
            </p>
<p>Start with step 1.
              If no "continue with step x" phrase is hit, the procedure is finished.</p>
<ol>
<li>
                The client <em class="rfc2119">MUST</em> pass the received message, together with an arbitrarily ordered list of the tuples <code>(id,schema)</code> of all <a class="internalDFN" data-link-type="dfn" href="#dfn-error-message-identifiers" id="ref-for-dfn-error-message-identifiers-1">error message identifiers</a> (defined in Section <a class="sec-ref" href="#dtcgenver-generation-msgids"><bdi class="secno">6.1.4 </bdi>Message Identifiers</a>) and their respective schemas (defined in Section <a class="sec-ref" href="#dtcgenver-generation-msgschemas"><bdi class="secno">6.1.6 </bdi>Message Schemas</a>), to the message validator (see Section <a class="sec-ref" href="#dtcgenver-generation-msgvalidator"><bdi class="secno">6.1.7 </bdi>Message Validator</a>).
                If the validation returns <code>None</code>, continue with step 2.
                If the validation returns one of the error message identifiers, the implementation <em class="rfc2119">MAY</em> behave arbitrarily (see the discussion and behavior recommendation in Section <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>).
              </li>
<li>
                The client <em class="rfc2119">MUST</em> pass the message, along with the schema for an <code>S1</code> message (defined in Section <a class="sec-ref" href="#dtcgenver-generation-msgschemas"><bdi class="secno">6.1.6 </bdi>Message Schemas</a>), to the message validator (see Section <a class="sec-ref" href="#dtcgenver-generation-msgvalidator"><bdi class="secno">6.1.7 </bdi>Message Validator</a>).
                If <code>None</code> is returned by the message validator, the client <em class="rfc2119">SHOULD</em> send an <code>UnknownMessage</code> error to the server according to Section <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>.
                If the validator returns <code>S1</code>, continue with step 3.
              </li>
<li>
                The client <em class="rfc2119">SHOULD</em> check whether the received <code>S1</code> message belongs to an unanswered previous <code>ContractRequest</code> message.
                The implementation of this check is not further specified, but <em class="rfc2119">MAY</em> be implemented by matching HTTP requests and responses (see Section <a class="sec-ref" href="#dtcgenver-generation-protocol"><bdi class="secno">6.1.9 </bdi>Protocol Stack</a> for a specification of the protocol stack) or by implementing a custom caching mechanism.
                If the check fails, the client <em class="rfc2119">SHOULD</em> send an <code>UnexpectedSenderContract</code> error to the server according to Section <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>.
                If the check succeeds, or if no check was executed, continue with step 4.
              </li>
<li>
<p>
                  The client <em class="rfc2119">MUST</em> extract and parse the partial DTC contained in the <code>content</code> attribute of the JSON message, and verify </p>
<ul>
<li>that the sender's identity (in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-9"><code>sender</code></a>) is as expected</li>
<li>
                    that the sender's public key certificate (in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-10"><code>sender</code></a>) is valid and trusted <div class="note" id="issue-container-generatedID-8" role="note"><div aria-level="6" class="note-title marker" id="h-note-8" role="heading"><span>Note</span></div><p class="">
                      This step <em class="rfc2119">SHOULD</em> include checking whether the public key certificate has been issued for the authority identified by the <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-26">IRI</a> contained in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-11"><code>sender</code></a> field.
                      We further discuss this verification step in Section <a class="sec-ref" href="#considerations-iricertlink"><bdi class="secno">A.2 </bdi>Identity Management</a>.
                    </p></div>
</li>
<li>that the sender's signature (in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-senderSig" href="#dfn-dtc-sendersig" id="ref-for-dfn-dtc-sendersig-10"><code>senderSig</code></a>) is valid by verifying the signature according to Section <a class="sec-ref" href="#dtc-signatures-verification"><bdi class="secno">4.5.4 </bdi>Signature Verification</a>.
                    The sender's public key contained in the public key certificate in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-12"><code>sender</code></a> <em class="rfc2119">MUST</em> be used for the verification procedure.</li>
<li><i>(optional)</i> that the <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-16">fact</a> checksums contained in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-11"><code>facts</code></a> are valid.
                    This is dependent on a completed data transaction and an interface to the data within the client-side handshake implementation, and thus, is not mandatory to implement.</li>
</ul>
                If any of these verifications fail, the client <em class="rfc2119">MUST</em> send an <code>InvalidSenderContract</code> error message to the server according to Section <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>, and <em class="rfc2119">SHOULD</em> consider the <code>ContractRequest</code> message, to which the <code>S1</code> message was matched, as unanswered, such that the server can retry sending a valid matching <code>S1</code> message.
                If all of the verifications succeeded, continue with step 5.
              </li>
<li>
                The client <em class="rfc2119">MUST</em> create a signature according to Section <a class="sec-ref" href="#dtc-signatures-creation"><bdi class="secno">4.5.3 </bdi>Signature Creation</a> using the partial DTC from the <code>S1</code> message and the private key associated with the public key included in the public key certificate in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-7"><code>receiver</code></a> field, and add it as the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiverSig" href="#dfn-dtc-receiversig" id="ref-for-dfn-dtc-receiversig-9"><code>receiverSig</code></a> field according to Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                The client <em class="rfc2119">SHOULD</em> accept the complete DTC and <em class="rfc2119">SHOULD</em> forward it so a DTC storage system.
                Finally, the client <em class="rfc2119">MUST</em> build the <code>R2</code> message by passing the now-complete DTC to the message builder (see Section <a class="sec-ref" href="#dtcgenver-generation-msgbuilder"><bdi class="secno">6.1.5 </bdi>Message Builder</a>), and use the <a class="internalDFN" data-link-type="dfn" href="#dfn-outgoing-message-interface" id="ref-for-dfn-outgoing-message-interface-2">outgoing message interface</a> (see Section <a class="sec-ref" href="#dtcgenver-generation-protocol"><bdi class="secno">6.1.9 </bdi>Protocol Stack</a>) to send it to the server.
              </li>
</ol>
</section>
<section class="notoc">
<div class="header-wrapper"><h5 id="server-side-incoming-message-handling">Server-side Incoming Message Handling</h5><a aria-label="Permalink for this Section" class="self-link" href="#server-side-incoming-message-handling"></a></div>
<p>
              Once the server implementation is called by the <a class="internalDFN" data-link-type="dfn" href="#dfn-incoming-message-handler" id="ref-for-dfn-incoming-message-handler-2">incoming message handler</a> (see Section <a class="sec-ref" href="#dtcgenver-generation-protocol"><bdi class="secno">6.1.9 </bdi>Protocol Stack</a>), the following procedure <em class="rfc2119">MUST</em> be carried out.
            </p>
<p>Start with step 1.
              If no "continue with step x" phrase is hit, the procedure is finished.</p>
<ol>
<li>
                The server <em class="rfc2119">MUST</em> pass the received message, together with an arbitrarily ordered list of the tuples <code>(id,schema)</code> of all <a class="internalDFN" data-link-type="dfn" href="#dfn-error-message-identifiers" id="ref-for-dfn-error-message-identifiers-2">error message identifiers</a> (defined in Section <a class="sec-ref" href="#dtcgenver-generation-msgids"><bdi class="secno">6.1.4 </bdi>Message Identifiers</a>) and their respective schemas (defined in Section <a class="sec-ref" href="#dtcgenver-generation-msgschemas"><bdi class="secno">6.1.6 </bdi>Message Schemas</a>), to the message validator (see Section <a class="sec-ref" href="#dtcgenver-generation-msgvalidator"><bdi class="secno">6.1.7 </bdi>Message Validator</a>).
                If the validation returns <code>None</code>, continue with step 2.
                If the validation returns one of the error message identifiers, the implementation <em class="rfc2119">MAY</em> behave arbitrarily (see the discussion and behavior recommendation in Section <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>).
              </li>
<li>
                The server <em class="rfc2119">MUST</em> pass the message, together with the list containing the <code>ContractRequest</code> and <code>R2</code> message schemas (in this order, defined in Section <a class="sec-ref" href="#dtcgenver-generation-msgschemas"><bdi class="secno">6.1.6 </bdi>Message Schemas</a>) to the message validator (see <a class="sec-ref" href="#dtcgenver-generation-msgvalidator"><bdi class="secno">6.1.7 </bdi>Message Validator</a>).
                If the validator returns <code>None</code>, the server <em class="rfc2119">MUST</em> send an <code>UnknownMessage</code> error to the client according to Section <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>.
                If the validator returns <code>ContractRequest</code>, continue with step 3.
                If the validator returns <code>R2</code>, continue with step 6.
              </li>
<li>
                The server <em class="rfc2119">MUST</em> parse the partial DTC in the <code>contract</code> attribute of the JSON message.
                Then, the server <em class="rfc2119">MAY</em> verify that the client is authorized to request the DTC for the <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-17">facts</a>
                contained in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-12"><code>facts</code></a> field.
                <div class="note" id="issue-container-generatedID-9" role="note"><div aria-level="6" class="note-title marker" id="h-note-9" role="heading"><span>Note</span></div><p class="">
                  Such an access-control mechanism is not specified, but could be implemented on a lower layer (e.g.,
                  using the HTTP Authorization header).
                  Therefore, error handling for access control should also be implemented on a lower layer.
                </p></div>
                Subsequently, the server compiles the DTC.
                Therefore, it <em class="rfc2119">MUST</em> carry out the following steps on the received partial DTC in any order:
                <ul>
<li>
                    The server adds the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-13"><code>sender</code></a> field with its own information, such that the content complies with Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                  </li>
<li>
                    The server looks up or computes the checksums for the <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-18">facts</a> identified by the <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-27">IRIs</a>
                    contained in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-factID" href="#dfn-dtc-facts-factid" id="ref-for-dfn-dtc-facts-factid-7"><code>factID</code></a> sub-fields of the entries of <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-13"><code>facts</code></a>.
                    During this process, the server <em class="rfc2119">MAY</em> resolve some of the <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-28">IRIs</a> to concretized <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-29">IRIs</a> (see the documentation <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-requestedID" href="#dfn-dtc-facts-requestedid" id="ref-for-dfn-dtc-facts-requestedid-2"><code>requestedID</code></a> for details).
                    In this case, the server <em class="rfc2119">MUST</em> copy the content of <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-factID" href="#dfn-dtc-facts-factid" id="ref-for-dfn-dtc-facts-factid-8"><code>factID</code></a> to <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-requestedID" href="#dfn-dtc-facts-requestedid" id="ref-for-dfn-dtc-facts-requestedid-3"><code>requestedID</code></a>, and subsequently overwrite the content of <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-factID" href="#dfn-dtc-facts-factid" id="ref-for-dfn-dtc-facts-factid-9"><code>factID</code></a> with the new <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-30">IRI</a> in accordance with Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                    It then adds each checksum to the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-alg" href="#dfn-dtc-facts-alg" id="ref-for-dfn-dtc-facts-alg-2"><code><code>&lt;alg&gt;</code></code></a> sub-field of the respective <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-14"><code>facts</code></a> entry in accordance with Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                    As specified in Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>, the checksum is associated with a specific serialization of the <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-19">fact</a>.
                    The server <em class="rfc2119">MUST</em> add the serialization identifier to the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-serialization" href="#dfn-dtc-facts-serialization" id="ref-for-dfn-dtc-facts-serialization-2"><code>serialization</code></a> sub-field of each entry of <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-15"><code>facts</code></a> according to Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                  </li>
<li>
                    The server creates a timestamp of its current time and adds it to the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-timestamp" href="#dfn-dtc-timestamp" id="ref-for-dfn-dtc-timestamp-1"><code>timestamp</code></a> field according to Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                  </li>
<li>
                    The server creates a base <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-31">IRI</a>, which can be used to uniquely identify the created DTC.
                    For this, the server <em class="rfc2119">MAY</em> use the previously created timestamp, or any other custom identification scheme.
                    The server then adds the <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-32">IRI</a> to the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-baseIRI" href="#dfn-dtc-baseiri" id="ref-for-dfn-dtc-baseiri-2"><code>baseIRI</code></a> field according to Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                  </li>
<li>
<i>(Optional)</i>
                    The server adds content to the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-customContent" href="#dfn-dtc-customcontent" id="ref-for-dfn-dtc-customcontent-4"><code>senderCustomContent</code></a>
                    field according to <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                  </li>
</ul>
<p>Continue with step 4.</p>
</li>
<li>
                The server creates a signature according to Section <a class="sec-ref" href="#dtc-signatures-creation"><bdi class="secno">4.5.3 </bdi>Signature Creation</a> for the compiled DTC and the private key associated with the public key included in the public key certificate in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-14"><code>sender</code></a> field.
                The server then adds it as the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-senderSig" href="#dfn-dtc-sendersig" id="ref-for-dfn-dtc-sendersig-11"><code>senderSig</code></a> field according to Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                Continue with step 5.
              </li>
<li>
                The server <em class="rfc2119">MUST</em> build the <code>S2</code> message by passing the compiled (partial) DTC to the message builder (see Section <a class="sec-ref" href="#dtcgenver-generation-msgbuilder"><bdi class="secno">6.1.5 </bdi>Message Builder</a>), and <em class="rfc2119">MUST</em> then use the <a class="internalDFN" data-link-type="dfn" href="#dfn-outgoing-message-interface" id="ref-for-dfn-outgoing-message-interface-3">outgoing message interface</a> (see Section <a class="sec-ref" href="#dtcgenver-generation-protocol"><bdi class="secno">6.1.9 </bdi>Protocol Stack</a>) to send the resulting message to the client.
              </li>
<li>
                The server <em class="rfc2119">MUST</em> parse the DTC contained in the <code>contract</code> field of the JSON message.
                Then, the server <em class="rfc2119">MUST</em> verify that its own public key certificate is contained in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-15"><code>sender</code></a> field.
                If not, the server <em class="rfc2119">MUST</em> send a <code>BogusSenderCert</code> error to the client according to Section <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>.
                <div class="note" id="issue-container-generatedID-10" role="note"><div aria-level="6" class="note-title marker" id="h-note-10" role="heading"><span>Note</span></div><p class="">
                  This step prevents the client from simply replacing the sender's public key certificate with a bogus certificate, for which it controls the private key, and can thus create a signature (and thus a valid DTC) independent of the sender.
                  While such an attack would not lead to a valid DTC issued by the sender, it would lead to an invaluable DTC, which is not recognized by the sender by simply verifying the DTC using the procedure specified in Section <a class="sec-ref" href="#dtcgenver-verification"><bdi class="secno">6.2 </bdi>DTC Verification</a>.
                </p></div>
                If the public key certificate is correct, continue with step 7.
              </li>
<li>
                The server <em class="rfc2119">MUST</em> verify <ul>
<li>that the receiver's identity (in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-8"><code>receiver</code></a>) is as expected</li>
<li>
                    that the receiver's public key certificate (in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-9"><code>receiver</code></a>) is valid and trusted <div class="note" id="issue-container-generatedID-11" role="note"><div aria-level="6" class="note-title marker" id="h-note-11" role="heading"><span>Note</span></div><p class="">
                      This step <em class="rfc2119">SHOULD</em> include checking whether the public key certificate has been issued for the authority identified by the <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-33">IRI</a> contained in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-10"><code>receiver</code></a> field.
                      We further discuss this verification step in Section <a class="sec-ref" href="#considerations-iricertlink"><bdi class="secno">A.2 </bdi>Identity Management</a>.
                    </p></div>
</li>
<li>that the receiver's signature (in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiverSig" href="#dfn-dtc-receiversig" id="ref-for-dfn-dtc-receiversig-10"><code>receiverSig</code></a> is valid by verifying the signature according to Section <a class="sec-ref" href="#dtc-signatures-verification"><bdi class="secno">4.5.4 </bdi>Signature Verification</a>.
                    The receiver's public key contained in the public key certificate in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-11"><code>receiver</code></a> <em class="rfc2119">MUST</em> be used for the verification procedure.</li>
</ul>
                If any of these verifications fail, the server <em class="rfc2119">MUST</em> send an <code>InvalidReceiverContract</code> error message to the client according to <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>.
                Otherwise, the server <em class="rfc2119">SHOULD</em> accept the DTC and <em class="rfc2119">SHOULD</em> forward it to a DTC storage system.
              </li>
</ol>
</section>
</div>
</section>
<section id="dtcgenver-generation-abbrev"><div class="header-wrapper"><h4 id="x6-1-3-abbreviated-2-way-handshake"><bdi class="secno">6.1.3 </bdi>Abbreviated (2-way) Handshake</h4><a aria-label="Permalink for Section 6.1.3" class="self-link" href="#dtcgenver-generation-abbrev"></a></div>
<p>
          The abbreviated handshake assumes that the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-32">receiver</a> has full access to the underlying data of the DTC,
          i.e., that the data transmission is completed.
          Further, it assumes that the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-33">receiver</a> has access to the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-35">sender</a>'s identity and public certificate, i.e., the contents of the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-16"><code>sender</code></a> field according to Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
        </p>
<p>
          If these two assumptions hold, the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-34">receiver</a> is able to compile the DTC except for the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-36">sender</a>'s signature.
          In this case, only two messages are necessary to establish a valid DTC.
        </p>
<p>
          Note that if the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-customContent" href="#dfn-dtc-customcontent" id="ref-for-dfn-dtc-customcontent-5"><code>senderCustomContent</code></a> is to be used, its content <em class="rfc2119">MUST</em> be pre-shared before the receiver initiates the handshake, such that the client has access to it when initially compiling the DTC.
        </p>
<p>
          The following figure gives an overview of the handshake messages and computations.
          Note that only the differential message contents are listed, as the previously existing DTC content is carried over to the next messages.
          The caption includes a mapping from the message abbreviations used in the figure to the message identifiers defined in Section <a class="sec-ref" href="#dtcgenver-generation-msgids"><bdi class="secno">6.1.4 </bdi>Message Identifiers</a>.
        </p>
<div class="tlcontent">
<p>A shortened 2-way handshake dependent on a completed data transmission is shown below:</p>
<figure id="fig-dtc-generation-handshake-abbrev" style="text-align: center;">
<object aria-describedby="fig-dtc-generation-handshake-abbrev" data="figures/contract-generation-handshake-abbrev.svg" style="width: 80%;" type="image/svg+xml">
</object>
<p id="fig-contract-generation-handshake-abbrev-alt">
              The transmission-dependent 2-way contract generation handshake </p>
<figcaption><a class="self-link" href="#fig-dtc-generation-handshake-abbrev">Figure <bdi class="figno">10</bdi></a> <span class="fig-title">
              A message diagram of the 2-way contract generation handshake, initiated by the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-35">receiver</a> (<span class="fig-agent">R</span>).
              The <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-36">receiver</a> compiles the complete DTC, and the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-37">sender</a> (<span class="fig-agent">S</span>)
              verifies and signs it afterward.
              Message abbreviations: R1'=<code>AbbrevContractRequest</code>, S1'=<code>AbbrevContract</code>.
            </span></figcaption>
</figure>
<p>
            In the following, we define the behavior of client and server implementations in detail.
          </p>
<section class="notoc">
<div class="header-wrapper"><h5 id="handshake-initiation-client-side-0">Handshake initiation (Client-side)</h5><a aria-label="Permalink for this Section" class="self-link" href="#handshake-initiation-client-side-0"></a></div>
<p>
              The client is responsible for initiating the DTC generation handshake.
              For this, an appropriate user interface (manual trigger) or interface to the data-sharing system (automatic trigger) <em class="rfc2119">SHOULD</em> be implemented.
            </p>
<ol>
<li>
                To initiate the DTC generation, the client <em class="rfc2119">MUST</em> first compile a partial DTC.
                For this, the following steps <em class="rfc2119">MUST</em> be carried out in any order:
                <ul>
<li>
                    The client adds the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-12"><code>receiver</code></a> field with its own information, such that the content complies with Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                  </li>
<li>
                    The client adds the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-17"><code>sender</code></a> field with the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-38">sender</a>'s information,
                    such that the content complies with Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                    <div class="note" id="issue-container-generatedID-12" role="note"><div aria-level="6" class="note-title marker" id="h-note-12" role="heading"><span>Note</span></div><p class="">
                      As mentioned above, the content of the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-18"><code>sender</code></a> field needs to be pre-shared between <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-39">sender</a> and <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-37">receiver</a> for the abbreviated handshake.
                    </p></div>
</li>
<li>
                    Based on the set of <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-34">IRIs</a> of the underlying data transmission, the client compiles the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-16"><code>facts</code></a> field in compliance with Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                    For this, the client looks up or computes the checksums for the <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-20">facts</a> identified by the <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-35">IRIs</a> of the data transmission.
                    It then adds each checksum to the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-alg" href="#dfn-dtc-facts-alg" id="ref-for-dfn-dtc-facts-alg-3"><code><code>&lt;alg&gt;</code></code></a> sub-field of the respective <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-17"><code>facts</code></a> entry in accordance with Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                    As specified in Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>, the checksum is associated with a specific serialization of the <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-21">fact</a>.
                    The client <em class="rfc2119">MUST</em> add the serialization identifier to the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-serialization" href="#dfn-dtc-facts-serialization" id="ref-for-dfn-dtc-facts-serialization-3"><code>serialization</code></a> sub-field of each entry of <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-18"><code>facts</code></a> according to Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                    The <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-requestedID" href="#dfn-dtc-facts-requestedid" id="ref-for-dfn-dtc-facts-requestedid-4"><code>requestedID</code></a> subfield <em class="rfc2119">SHOULD NOT</em> be present for any entry of <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-19"><code>facts</code></a>.
                    <div class="note" id="issue-container-generatedID-13" role="note"><div aria-level="6" class="note-title marker" id="h-note-13" role="heading"><span>Note</span></div><p class="">
                      Note that in the abbreviated handshake, the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-40">sender</a> cannot update the entries of <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-factID" href="#dfn-dtc-facts-factid" id="ref-for-dfn-dtc-facts-factid-10"><code>factID</code></a>, as the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-38">receiver</a>'s signature already exists in the first message addressed to the sender.
                      Instead, an <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-36">IRI</a> negotiation, as discussed in Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>
<em class="rfc2119">SHOULD</em> be implemented together with the data transmission, as this has to be completed before the handshake if using the abbreviated handshake version.
                    </p></div>
</li>
<li>
                    The client creates a timestamp of its current time and adds it to the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-timestamp" href="#dfn-dtc-timestamp" id="ref-for-dfn-dtc-timestamp-2"><code>timestamp</code></a> field according to Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                  </li>
<li>
                    The client assigns a base <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-37">IRI</a> to the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-baseIRI" href="#dfn-dtc-baseiri" id="ref-for-dfn-dtc-baseiri-3"><code>baseIRI</code></a> field according to Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>, which can be used to uniquely identify the created DTC.
                    This <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-38">IRI</a> <em class="rfc2119">MAY</em> be created by the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-39">receiver</a> itself, or negotiated or created by the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-41">sender</a> during the transmission of the data subject to the DTC.
                  </li>
<li>
<i>(Optional)</i>
                    The client adds content to the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-customContent" href="#dfn-dtc-customcontent" id="ref-for-dfn-dtc-customcontent-6"><code>receiverCustomContent</code></a>
                    and <a class="internalDFN" data-link-type="dfn" data-lt="dtc-customContent" href="#dfn-dtc-customcontent" id="ref-for-dfn-dtc-customcontent-7"><code>senderCustomContent</code></a> fields according to <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                    <div class="note" id="issue-container-generatedID-14" role="note"><div aria-level="6" class="note-title marker" id="h-note-14" role="heading"><span>Note</span></div><p class="">
                      As mentioned above, the content of the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-customContent" href="#dfn-dtc-customcontent" id="ref-for-dfn-dtc-customcontent-8"><code>senderCustomContent</code></a> field has to be pre-shared before the abbreviated handshake.
                    </p></div>
</li>
</ul>
<p>Continue with step 2.</p>
</li>
<li>
                The client <em class="rfc2119">MUST</em> create a signature according to Section <a class="sec-ref" href="#dtc-signatures-creation"><bdi class="secno">4.5.3 </bdi>Signature Creation</a> for the compiled DTC and the private key associated with the public key included in the public key certificate in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-13"><code>receiver</code></a> field.
                The client then <em class="rfc2119">MUST</em> add it as the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiverSig" href="#dfn-dtc-receiversig" id="ref-for-dfn-dtc-receiversig-11"><code>receiverSig</code></a> field according to Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                Continue with step 3.
              </li>
<li>
<p>
                  The client then <em class="rfc2119">MUST</em> use the partial DTC to build the <code>AbbrevContractRequest</code> message by passing the partial DTC to the message builder defined in Section <a class="sec-ref" href="#dtcgenver-generation-msgbuilder"><bdi class="secno">6.1.5 </bdi>Message Builder</a>, and pass it to the <a class="internalDFN" data-link-type="dfn" href="#dfn-outgoing-message-interface" id="ref-for-dfn-outgoing-message-interface-4">outgoing message interface</a>
                  (see Section <a class="sec-ref" href="#dtcgenver-generation-protocol"><bdi class="secno">6.1.9 </bdi>Protocol Stack</a>).
                </p>
</li>
</ol>
</section>
<section class="notoc">
<div class="header-wrapper"><h5 id="client-side-incoming-message-handling-0">Client-side Incoming Message Handling</h5><a aria-label="Permalink for this Section" class="self-link" href="#client-side-incoming-message-handling-0"></a></div>
<p>
              Once the client implementation is called by the <a class="internalDFN" data-link-type="dfn" href="#dfn-incoming-message-handler" id="ref-for-dfn-incoming-message-handler-3">incoming message handler</a> (see Section <a class="sec-ref" href="#dtcgenver-generation-protocol"><bdi class="secno">6.1.9 </bdi>Protocol Stack</a>), the following procedure <em class="rfc2119">MUST</em> be carried out.
            </p>
<p>
              Start with step 1.
              If no "continue with step x" phrase is hit, the procedure is finished.
            </p>
<ol>
<li>
                The client <em class="rfc2119">MUST</em> pass the received message, together with an arbitrarily ordered list of the tuples <code>(id,schema)</code> of all <a class="internalDFN" data-link-type="dfn" href="#dfn-error-message-identifiers" id="ref-for-dfn-error-message-identifiers-3">error message identifiers</a> (defined in Section <a class="sec-ref" href="#dtcgenver-generation-msgids"><bdi class="secno">6.1.4 </bdi>Message Identifiers</a>) and their respective schemas (defined in Section <a class="sec-ref" href="#dtcgenver-generation-msgschemas"><bdi class="secno">6.1.6 </bdi>Message Schemas</a>), to the message validator (see Section <a class="sec-ref" href="#dtcgenver-generation-msgvalidator"><bdi class="secno">6.1.7 </bdi>Message Validator</a>).
                If the validation returns <code>None</code>, continue with step 2.
                If the validation returns one of the error message identifiers, the implementation <em class="rfc2119">MAY</em> behave arbitrarily (see the discussion and behavior recommendation in Section <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>).
              </li>
<li>
                The client <em class="rfc2119">MUST</em> pass the message, along with the schema for an <code>AbbrevContract</code> message (defined in Section <a class="sec-ref" href="#dtcgenver-generation-msgschemas"><bdi class="secno">6.1.6 </bdi>Message Schemas</a>), to the message validator (see Section <a class="sec-ref" href="#dtcgenver-generation-msgvalidator"><bdi class="secno">6.1.7 </bdi>Message Validator</a>).
                If <code>None</code> is returned by the message validator, the client <em class="rfc2119">SHOULD</em> send an <code>UnknownMessage</code> error to the server according to Section <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>.
                If the validator returns <code>S1</code>, continue with step 3.
              </li>
<li>
                The client <em class="rfc2119">MUST</em> parse the DTC contained in the <code>contract</code> field of the JSON message.
                Then, the client <em class="rfc2119">MUST</em> verify that its own public key certificate is contained in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-14"><code>receiver</code></a> field.
                If not, the client <em class="rfc2119">MUST</em> send a <code>BogusReceiverCert</code> error to the server according to Section <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>.
                <div class="note" id="issue-container-generatedID-15" role="note"><div aria-level="6" class="note-title marker" id="h-note-15" role="heading"><span>Note</span></div><p class="">
                  This step prevents the server from simply replacing the receiver's public key certificate with a bogus certificate, for which it controls the private key, and can thus create a signature (and thus a valid DTC) independent of the receiver.
                  While such an attack would not lead to a valid DTC issued by the receiver, it would lead to an invaluable DTC, which is not recognized by the receiver by simply verifying the DTC using the procedure specified in Section <a class="sec-ref" href="#dtcgenver-verification"><bdi class="secno">6.2 </bdi>DTC Verification</a>.
                </p></div>
                If the public key certificate is correct, continue with step 4.
              </li>
<li>
                The client <em class="rfc2119">MUST</em> verify <ul>
<li>that the sender's identity (in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-19"><code>sender</code></a>) is as expected</li>
<li>
                    that the sender's public key certificate (in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-20"><code>sender</code></a>) is valid and trusted <div class="note" id="issue-container-generatedID-16" role="note"><div aria-level="6" class="note-title marker" id="h-note-16" role="heading"><span>Note</span></div><p class="">
                      This step <em class="rfc2119">SHOULD</em> include checking whether the public key certificate has been issued for the authority identified by the <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-39">IRI</a> contained in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-21"><code>sender</code></a> field.
                      We further discuss this verification step in Section <a class="sec-ref" href="#considerations-iricertlink"><bdi class="secno">A.2 </bdi>Identity Management</a>.
                    </p></div>
</li>
<li>that the sender's signature (in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-senderSig" href="#dfn-dtc-sendersig" id="ref-for-dfn-dtc-sendersig-12"><code>senderSig</code></a> is valid by verifying the signature according to Section <a class="sec-ref" href="#dtc-signatures-verification"><bdi class="secno">4.5.4 </bdi>Signature Verification</a>.
                    The sender's public key contained in the public key certificate in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-22"><code>sender</code></a> <em class="rfc2119">MUST</em> be used for the verification procedure.</li>
</ul>
                If any of these verifications fail, the client <em class="rfc2119">MUST</em> send a <code>InvalidAbbrevContract</code> error message to the server according to <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>.
                Otherwise, the client <em class="rfc2119">SHOULD</em> accept the DTC and <em class="rfc2119">SHOULD</em> forward it to a DTC storage system.
              </li>
</ol>
</section>
<section class="notoc">
<div class="header-wrapper"><h5 id="server-side-incoming-message-handling-0">Server-side Incoming Message Handling</h5><a aria-label="Permalink for this Section" class="self-link" href="#server-side-incoming-message-handling-0"></a></div>
<p>
              Once the server implementation is called by the <a class="internalDFN" data-link-type="dfn" href="#dfn-incoming-message-handler" id="ref-for-dfn-incoming-message-handler-4">incoming message handler</a> (see Section <a class="sec-ref" href="#dtcgenver-generation-protocol"><bdi class="secno">6.1.9 </bdi>Protocol Stack</a>), the following procedure <em class="rfc2119">MUST</em> be carried out.
            </p>
<p>
              Start with step 1.
              If no "continue with step x" phrase is hit, the procedure is finished.
            </p>
<ol>
<li>
                The server <em class="rfc2119">MUST</em> pass the received message, together with an arbitrarily ordered list of the tuples <code>(id,schema)</code> of all <a class="internalDFN" data-link-type="dfn" href="#dfn-error-message-identifiers" id="ref-for-dfn-error-message-identifiers-4">error message identifiers</a> (defined in Section <a class="sec-ref" href="#dtcgenver-generation-msgids"><bdi class="secno">6.1.4 </bdi>Message Identifiers</a>) and their respective schemas (defined in Section <a class="sec-ref" href="#dtcgenver-generation-msgschemas"><bdi class="secno">6.1.6 </bdi>Message Schemas</a>), to the message validator (see Section <a class="sec-ref" href="#dtcgenver-generation-msgvalidator"><bdi class="secno">6.1.7 </bdi>Message Validator</a>).
                If the validation returns <code>None</code>, continue with step 2.
                If the validation returns one of the error message identifiers, the implementation <em class="rfc2119">MAY</em> behave arbitrarily (see the discussion and behavior recommendation in Section <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>).
              </li>
<li>
                The server <em class="rfc2119">MUST</em> pass the message, together with the <code>AbbrevContractRequest</code> schema (see Section <a class="sec-ref" href="#dtcgenver-generation-msgschemas"><bdi class="secno">6.1.6 </bdi>Message Schemas</a>) to the message validator (see <a class="sec-ref" href="#dtcgenver-generation-msgvalidator"><bdi class="secno">6.1.7 </bdi>Message Validator</a>).
                If the validator returns <code>None</code>, the server <em class="rfc2119">MUST</em> send an <code>UnknownMessage</code> error to the client according to Section <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>.
                If the validator returns <code>AbbrevContractRequest</code>, continue with step 3.
              </li>
<li>
<p>
                  The server <em class="rfc2119">MUST</em> extract and parse the partial DTC contained in the <code>content</code> attribute of the JSON message, and verify </p>
<ul>
<li>that the receiver's identity (in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-15"><code>receiver</code></a>) is as expected</li>
<li>
                    that the receiver's public key certificate (in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-16"><code>receiver</code></a>) is valid and trusted <div class="note" id="issue-container-generatedID-17" role="note"><div aria-level="6" class="note-title marker" id="h-note-17" role="heading"><span>Note</span></div><p class="">
                      This step <em class="rfc2119">SHOULD</em> include checking whether the public key certificate is issues for the authority identified by the <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-40">IRI</a> contained in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-17"><code>receiver</code></a> field.
                      We further discuss this verification step in Section <a class="sec-ref" href="#considerations-iricertlink"><bdi class="secno">A.2 </bdi>Identity Management</a>.
                    </p></div>
</li>
<li>that the receiver's signature (in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiverSig" href="#dfn-dtc-receiversig" id="ref-for-dfn-dtc-receiversig-12"><code>receiverSig</code></a>) is valid by verifying the signature according to Section <a class="sec-ref" href="#dtc-signatures-verification"><bdi class="secno">4.5.4 </bdi>Signature Verification</a>.
                    The receiver's public key contained in the public key certificate in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-18"><code>receiver</code></a> <em class="rfc2119">MUST</em> be used for the verification procedure.</li>
<li>that the <a class="internalDFN" data-link-type="dfn" href="#dfn-fact" id="ref-for-dfn-fact-22">fact</a> checksums contained in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-20"><code>facts</code></a> are valid.
                    This verification step can be done by re-computing or looking up the fact checksums given the serialization identified by the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-serialization" href="#dfn-dtc-facts-serialization" id="ref-for-dfn-dtc-facts-serialization-4"><code>serialization</code></a> field.
                    <div class="note" id="issue-container-generatedID-18" role="note"><div aria-level="6" class="note-title marker" id="h-note-18" role="heading"><span>Note</span></div><p class="">
                      In contrast to the 3-way handshake (see Section <a class="sec-ref" href="#dtcgenver-generation-complete"><bdi class="secno">6.1.2 </bdi>Complete (3-way) Handshake</a>),
                      this step is not optional, as the 2-way handshake requires a previously completed data transmission.
                      Thus, making this step mandatory does not constrain the application of the procedure.
                    </p></div>
</li>
</ul>
                If any of these verifications fail, the server <em class="rfc2119">MUST</em> send an <code>InvalidAbbrevContractRequest</code>
                error message to the client according to Section <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>.
                If all of the verifications succeeded, continue with step 5.
              </li>
<li>
                The server <em class="rfc2119">MUST</em> verify that its own identity and public key certificate are correctly included in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-23"><code>sender</code></a> field.
                <div class="note" id="issue-container-generatedID-19" role="note"><div aria-level="6" class="note-title marker" id="h-note-19" role="heading"><span>Note</span></div><p class="">
                  This information has to be pre-shared between sender and receiver for the abbreviated handshake.
                  If this information is not correct, the signature in step 6 cannot be created with the matching private key.
                </p></div>
                If not, the server <em class="rfc2119">MUST</em> send a <code>BogusSenderCert</code> error message to the client according to Section <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>.
                If the information is correct, continue with step 6.
              </li>
<li>
                The server <em class="rfc2119">MUST</em> create a signature according to Section <a class="sec-ref" href="#dtc-signatures-creation"><bdi class="secno">4.5.3 </bdi>Signature Creation</a> using the partial DTC from the <code>AbbrevContractRequest</code> message and the private key associated with the public key included in the public key certificate in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-24"><code>sender</code></a> field,
                and add it as the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-senderSig" href="#dfn-dtc-sendersig" id="ref-for-dfn-dtc-sendersig-13"><code>senderSig</code></a> field according to Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
                The server <em class="rfc2119">SHOULD</em> accept the complete DTC and <em class="rfc2119">SHOULD</em> forward it so a DTC storage system.
                Finally, the server <em class="rfc2119">MUST</em> build the <code>AbbrevContract</code> message by passing the now-complete DTC to the message builder (see Section <a class="sec-ref" href="#dtcgenver-generation-msgbuilder"><bdi class="secno">6.1.5 </bdi>Message Builder</a>), and use the <a class="internalDFN" data-link-type="dfn" href="#dfn-outgoing-message-interface" id="ref-for-dfn-outgoing-message-interface-5">outgoing message interface</a> (see Section <a class="sec-ref" href="#dtcgenver-generation-protocol"><bdi class="secno">6.1.9 </bdi>Protocol Stack</a>) to send it to the client.
              </li>
</ol>
</section>
</div>
</section>
<section id="dtcgenver-generation-msgids"><div class="header-wrapper"><h4 id="x6-1-4-message-identifiers"><bdi class="secno">6.1.4 </bdi>Message Identifiers</h4><a aria-label="Permalink for Section 6.1.4" class="self-link" href="#dtcgenver-generation-msgids"></a></div>
<p>
          The defined <dfn aria-haspopup="dialog" data-dfn-type="dfn" data-plurals="message identifier" id="dfn-message-identifiers" tabindex="0">message identifiers</dfn> are partitioned into <a class="internalDFN" data-link-type="dfn" href="#dfn-non-error-message-identifiers" id="ref-for-dfn-non-error-message-identifiers-1">non-error message identifiers</a> and <a class="internalDFN" data-link-type="dfn" href="#dfn-error-message-identifiers" id="ref-for-dfn-error-message-identifiers-5">error message identifiers</a>.
        </p>
<p>
          We do not further specify the implementation of the message identifiers.
          They could, for example, be implemented using constant string values, or with an enum-like structure.
        </p>
<p>We define the following <dfn aria-haspopup="dialog" data-dfn-type="dfn" data-plurals="non-error message identifier" id="dfn-non-error-message-identifiers" tabindex="0">non-error message identifiers</dfn>:</p>
<ul>
<li><code>ContractRequest</code>: Identifies the first message in the complete handshake defined in Section <a class="sec-ref" href="#dtcgenver-generation-complete"><bdi class="secno">6.1.2 </bdi>Complete (3-way) Handshake</a>.</li>
<li><code>SenderContract</code>: Identifies the second message in the complete handshake defined in Section <a class="sec-ref" href="#dtcgenver-generation-complete"><bdi class="secno">6.1.2 </bdi>Complete (3-way) Handshake</a>.</li>
<li><code>ReceiverContract</code>: Identifies the third message in the complete handshake defined in Section <a class="sec-ref" href="#dtcgenver-generation-complete"><bdi class="secno">6.1.2 </bdi>Complete (3-way) Handshake</a>.
          </li>
<li><code>AbbrevContractRequest</code>: Identifies the first message of the abbreviated handshake defined in Section <a class="sec-ref" href="#dtcgenver-generation-abbrev"><bdi class="secno">6.1.3 </bdi>Abbreviated (2-way) Handshake</a>.</li>
<li><code>AbbrevContract</code>: Identifies the second message of the abbreviated handshake defined in Section <a class="sec-ref" href="#dtcgenver-generation-abbrev"><bdi class="secno">6.1.3 </bdi>Abbreviated (2-way) Handshake</a>.
          </li>
</ul>
<p>We define the following <dfn aria-haspopup="dialog" data-dfn-type="dfn" data-plurals="error message identifier" id="dfn-error-message-identifiers" tabindex="0">error message identifiers</dfn>:</p>
<ul>
<li>
<code>UnknownMessage</code>:
            Indicates that the message could not be validated against any message schema.
          </li>
<li>
<code>UnexpectedSenderContract</code>:
            Indicates that an <code>S1</code> message was received by the client without expecting it (see Section <a class="sec-ref" href="#dtcgenver-generation-complete"><bdi class="secno">6.1.2 </bdi>Complete (3-way) Handshake</a>).
          </li>
<li>
<code>InvalidSenderContract</code>:
            Indicates that the verification of an <code>S1</code> message failed (see Section <a class="sec-ref" href="#dtcgenver-generation-complete"><bdi class="secno">6.1.2 </bdi>Complete (3-way) Handshake</a>).
          </li>
<li>
<code>BogusSenderCert</code>:
            Indicates that the public key certificate contained in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-25"><code>sender</code></a> field of an <code>R2</code> message did not equal the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-42">sender</a>'s actual certificate (see Section <a class="sec-ref" href="#dtcgenver-generation-complete"><bdi class="secno">6.1.2 </bdi>Complete (3-way) Handshake</a>).
          </li>
<li>
<code>InvalidReceiverContract</code>:
            Indicates that the verification of the previously transmitted <code>ReceiverContract</code> message on the server side failed.
          </li>
<li>
<code>BogusReceiverCert</code>:
            Indicates that the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-40">receiver</a>'s certificate, as included in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-19"><code>receiver</code></a>
            field of the partial DTC within the previously transmitted <code>SenderContract</code> message, was not the correct certificate of the handshake client.
          </li>
<li>
<code>InvalidAbbrevContract</code>:
            Indicates that the client-side verification of the previously transmitted <code>AbbrevContract</code>
            message failed.
          </li>
<li>
<code>InvalidAbbrevContractRequest</code>:
            Indicates that the server-side verification of the previously transmitted <code>AbbrevContractRequest</code>
            message failed.
          </li>
</ul>
</section>
<section id="dtcgenver-generation-msgbuilder"><div class="header-wrapper"><h4 id="x6-1-5-message-builder"><bdi class="secno">6.1.5 </bdi>Message Builder</h4><a aria-label="Permalink for Section 6.1.5" class="self-link" href="#dtcgenver-generation-msgbuilder"></a></div>
<p>
          The message builder is used to build JSON messages to be transmitted according to Section <a class="sec-ref" href="#dtcgenver-generation-protocol"><bdi class="secno">6.1.9 </bdi>Protocol Stack</a>.
          Its behavior is the same for client and server implementations, and it provides an interface for the implementation of both server and client behavior, as specified in Sections <a class="sec-ref" href="#dtcgenver-generation-complete"><bdi class="secno">6.1.2 </bdi>Complete (3-way) Handshake</a> and <a class="sec-ref" href="#dtcgenver-generation-abbrev"><bdi class="secno">6.1.3 </bdi>Abbreviated (2-way) Handshake</a>.
        </p>
<p>
          If an implementation implements the client or server part of the generation handshake, it <em class="rfc2119">MUST</em> also implement the message builder.
        </p>
<p>The message builder <em class="rfc2119">MUST</em> implement the following functionality.</p>
<ul>
<li>
<i>Input:</i>
            A <a class="internalDFN" data-link-type="dfn" href="#dfn-non-error-message-identifiers" id="ref-for-dfn-non-error-message-identifiers-2">non-error message identifier</a> (see Section <a class="sec-ref" href="#dtcgenver-generation-msgids"><bdi class="secno">6.1.4 </bdi>Message Identifiers</a>) and a (partial) DTC <div class="note" id="issue-container-generatedID-20" role="note"><div aria-level="5" class="note-title marker" id="h-note-20" role="heading"><span>Note</span></div><p class="">Details about building error messages can be found in Section <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>.</p></div>
</li>
<li>
<i>Behavior:</i>
            The message builder <em class="rfc2119">MUST</em> carry out the following steps:
            <ol>
<li>Create an empty JSON object (<code>{}</code>), referred to as <code>res</code>.</li>
<li>Assign the <a class="internalDFN" data-link-type="dfn" href="#dfn-message-identifiers" id="ref-for-dfn-message-identifiers-1">message identifier</a> to <code>res</code> as the string content of the <code>messageType</code> attribute.
              </li>
<li>Serialize the (partial) DTC as a JSON object according to Section <a class="sec-ref" href="#dtc-representations-json"><bdi class="secno">4.4.1 </bdi>JSON</a>, and assign it to <code>res</code> as the <code>contract</code>
                attribute.</li>
<li>Return <code>res</code> to the caller.</li>
</ol>
</li>
</ul>
<p>The following is an informative example of an <code>S1</code> message (see Section <a class="sec-ref" href="#dtcgenver-generation-complete"><bdi class="secno">6.1.2 </bdi>Complete (3-way) Handshake</a>) as generated by the message builder.</p>
<div class="example" id="example-example-handshake-message-sendercontract">
<div class="marker">
<a class="self-link" href="#example-example-handshake-message-sendercontract">Example<bdi> 7</bdi></a><span class="example-title">: Example handshake message (SenderContract)</span>
</div> <pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"messageType"</span>: <span class="hljs-string">"SenderContract"</span>,
  <span class="hljs-attr">"contract"</span>: {
    <span class="hljs-attr">"baseIRI"</span>: <span class="hljs-string">"https://example.com/contracts/2021-09-24/134"</span>,
    <span class="hljs-attr">"sender"</span>: {
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"X509"</span>,
      <span class="hljs-attr">"encoding"</span>: <span class="hljs-string">"base64"</span>,
      <span class="hljs-attr">"cert"</span>: <span class="hljs-string">"MIIEkTCCAnmgAwIBAgIUTpTAugWv4ZYQX9nk2zETfVcMi38wDQYJKoZIhvcNAQELBQAwTDELMAkGA1UEBhMCREUxEzARBgNVBAgMClNvbWUtU3RhdGUxEzARBgNVBAoMCkV4YW1wbGUgQ0ExEzARBgNVBAMMCkV4YW1wbGUgQ0EwHhcNMjEwNDE1MjExMTExWhcNMjIwNDE1MjExMTExWjAzMR0wGwYDVQQKDBRFeGFtcGxlIGNoYWluIGNlcnQgMTESMBAGA1UEAwwJbG9jYWxob3N0MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvw8C6sqLUVSOwFPbZsqS/1cL/+7aaaxVPwXs7TjPVombwNLyJW8yPyyQLbsTN5evVCpNdzciYc9Nhh77AYrqCiOsZBb7hu/PMqNqDvU2FAHeTH9KZ1PSpsOdgzG4i9widL6FBKGrxvlyj0G5ztQoGtymJFdmQ8K/ZN2W5Bi27H24UgITO+mX5MGmzFfyib7bDnvNqZUMJEgpSGt+jUf/7pMtuQqusrE1bfg5vvCbHIPHx2KXqzQEjNiioDafzKjIY2NSakis1AZe+J46o/Za0L8TUMXPvO1nSX4VMm9w5Qqf8auKdlUnT7fVqGKxQvPgX/JM/ksduZqZdTE1giWDgQIDAQABo4GDMIGAMB0GA1UdDgQWBBQtTnbTodwlQnP0QXA2VRv6DBWgzzAfBgNVHSMEGDAWgBR+/85DLJ8v0EP1y6kv/I9XPsHQ5TAPBgNVHRMBAf8EBTADAQH/MA4GA1UdDwEB/wQEAwIBhjAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUHAwEwDQYJKoZIhvcNAQELBQADggIBAG47hxcjEY6kXojCadK15iW5t6P2p2NCfXpymeRuVaHiI7hhMwQEPymGqXZe0MKUKaRxb9BssG9UvndJw7PWdLx55Y498dgEVXWp7UWUg+VmLxE0wrS+7odJ6ZwsSTPhlgQVF3y9SOP18UX1Iy+ipkdPVbeiQB2QJOYLdxj3h26a/BevyWJU7jTbZO9fNX3FlopyQbB64QPJKJyQiYrT1td7lOcreyBJUS2e5p+hifW/ukxHQ9QtfN+mE/MlnUSHar6LgXPX3AoiVKc14L5E7jRHLDCvFWO1PfVCsS6RWIKdoWsEUytDnMYLHb2TmMJWQf8S69BLyqgEhKXNS9hZceGr32jM9O6TepYKZNH5A1QLjZcuHHKUAzXMjM9loNLra/VGcqrMTdZYautGl8EdEURqE063qDd+Hsp3Vqw0iALQHcbEb6R1b2o5dIrczo+PINTSvnFv+4GyqznXEYjcueLrR/R6kE9GNOiPUxpont+0s1JCAKPaaZk97Z09ldtD47rPQLQgWopDadVOm3Gu9+ef7uqqpJw9+q384mqgw4P1Yws6aVkXLdvh8MCXcMEYi2AeQVCCZv2CjAh8CZQC+0P2JtkhWlCxPoSDk4jbm6koCxcpL3CRcc5LtTTrev5+Mi0oDMiLzx09GNls3SQzdKdP9PM+Y7E7y4Xi2LW3FtoG"</span>,
      <span class="hljs-attr">"authID"</span>: <span class="hljs-string">"http://example.com/sender"</span>
    },
    <span class="hljs-attr">"receiver"</span>: {
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"X509"</span>,
      <span class="hljs-attr">"encoding"</span>: <span class="hljs-string">"base64"</span>,
      <span class="hljs-attr">"cert"</span>: <span class="hljs-string">"MIIEkTCCAnmgAwIBAgIUTpTAugWv4ZYQX9nk2zETfVcMi4AwDQYJKoZIhvcNAQELBQAwTDELMAkGA1UEBhMCREUxEzARBgNVBAgMClNvbWUtU3RhdGUxEzARBgNVBAoMCkV4YW1wbGUgQ0ExEzARBgNVBAMMCkV4YW1wbGUgQ0EwHhcNMjEwNDE1MjExNDM1WhcNMjIwNDE1MjExNDM1WjAzMR0wGwYDVQQKDBRFeGFtcGxlIGNoYWluIGNlcnQgMTESMBAGA1UEAwwJbG9jYWxob3N0MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuKe4H5GwuaKS02s6oAnQF0e30TLyB3joT5GNzwa94WXuLjU8SWKqOjLQyIN2ZBtZW1jNI3By6nsPoU3t181SBStFI25JZ8PUvJ9/Skf/adRmrtXHX8MYRBqN4d1JIRdOoLxwq+bI0UIyMmMNMTjvhnWwTx4FkXwup5fna9FFBbtOGP+7vMVl98L2/bDMJwwLdnzUs0CKLyqDRx0XWAnp6R6CN9YDeMgpdDviMkBfeY74AJ084v6pWnx+K0PlUuQAkiuPvcRsDxgjHRO18rq4wA6Dxh6My7Xh/uHFzb5cmLT7C7kfr+WN26va8IRGCF8NWdOYQ0HSo/vbY/eIOB/G0wIDAQABo4GDMIGAMB0GA1UdDgQWBBSmlyw0Ht9gF3rnI42Us1dK9+jZ/DAfBgNVHSMEGDAWgBR+/85DLJ8v0EP1y6kv/I9XPsHQ5TAPBgNVHRMBAf8EBTADAQH/MA4GA1UdDwEB/wQEAwIBhjAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUHAwEwDQYJKoZIhvcNAQELBQADggIBABMLMfSOAwk34LEK9L/A1qtHTJPQ2BF3XjnbswINNao0oOI3PSWKU0weWYlITH29hgyzrwO8A9ifaOFPtsRxe9/UNv6RNqwObLpxF+f2U3ulu2hTzd7l/ZXUGYaBUHLL3Cu1JlZWMRoTUBUHAvkwnQlUkQLJZ7A+N9y+FfV5apIMTwPA+C2lwiVtEd3Hje5Z9lUmjwiARRnsliRuCm2ZY0IHvneQN7NnOFCFFQQnu/7wMEywNWR3NMtj5AcMugs56OqcAglwq+HqYNCUkelt1/I7A/NwitaPEYu/1TDjQBckR6nbtJwHKFx2M9heB+E5iMI65r+ae01jBr+r7tes6UdEz7SCF3xHks3ubKfRQykZzTZ7ixeHYG5XjaUSSk8EDuBCdZOJ/AUAA+Rar/UPODUd1YQUZDUqs0MvB9zXQYBtEhwii75pCmkFBpZewo6xyktdP3964q7MZPZQZTZimh02CxcWdXZj6JkoL6ihuM36UciS9rXUgIGGdJcbhC5mP/PqRYsAzipOvQiRL7mGRB9L8H0Wt08yl3H0KFwGcgasML8tOOkf+4MsGIHJZaJ20cVfdWm1StOtLN1Bn+gAppq8nlvDgPiQ3NxSsvY+Qpb0WSVWknc1VyOPKexKaM20/alMv/fykVhVmmAcNVshIMAuKV5TnhqeZyg8L02pVAHL"</span>,
      <span class="hljs-attr">"authID"</span>: <span class="hljs-string">"http://example.com/receiver"</span>
    },
    <span class="hljs-attr">"senderSig"</span>: {
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"urn:oid:1.2.840.113549.1.1.10"</span>,
      <span class="hljs-attr">"encoding"</span>: <span class="hljs-string">"base64"</span>,
      <span class="hljs-attr">"sig"</span>: <span class="hljs-string">"S82Al/YgpfjywjagQ03tjr8WT2oiMSkuYGA5hoXL/LCZHJhR4UGuXyQe1lJ6+yDRiN8FbKcp6ZrClb645rKpIK9UP/Y50wOo/vXCdeUGRqWj4NduoJsBKAP9O4QfQQkT9POHwcbYDsbvEGm3M7fh7mrOn6PzQQgq8vNGayVP5VmFLofxhArc2cy7/TthDl5sBwngpIokHUGOIE+RXasifJ/KS+DALU2s51EZzP2NuTbOvC2328UD5yhvHTopwqn3OrMWbKjF8UUDFjQHYx383hrK3VPjqfrMMNT3OHiJB6t9pJwZ3lmD3PV0Axp6k1XV+oxckBaYN7dCNneQn+zkcw=="</span>
    },
    <span class="hljs-attr">"facts"</span>: [
      {
        <span class="hljs-attr">"factID"</span>: <span class="hljs-string">"http://example.com/facts/fact1"</span>,
        <span class="hljs-attr">"sha256"</span>: <span class="hljs-string">"5fc62b0e99a143ff2b99b56a6953f07e96f52023aa3739bba3fec1194292f48e"</span>,
        <span class="hljs-attr">"serialization"</span>: <span class="hljs-string">"string"</span>
      },
      {
        <span class="hljs-attr">"factID"</span>: <span class="hljs-string">"http://example.com/facts/fact2"</span>,
        <span class="hljs-attr">"sha256"</span>: <span class="hljs-string">"828bbc97b5b866992dc8bc532265e3094bc9e17cce05e16d90844d2160ad99cf"</span>,
        <span class="hljs-attr">"serialization"</span>: <span class="hljs-string">"string"</span>
      },
      {
        <span class="hljs-attr">"factID"</span>: <span class="hljs-string">"http://example.com/facts/fact3"</span>,
        <span class="hljs-attr">"sha256"</span>: <span class="hljs-string">"c646cfa0feda9af766e6eca97f8578f3eb2b126d2349ea7ce1fd2d3b3fe2d456"</span>,
        <span class="hljs-attr">"serialization"</span>: <span class="hljs-string">"string"</span>
      },
      {
        <span class="hljs-attr">"factID"</span>: <span class="hljs-string">"http://example.com/facts/fact4"</span>,
        <span class="hljs-attr">"sha256"</span>: <span class="hljs-string">"5845f61bccd9c5631dee29f9e87830b11eb5b531081a8888db42e80e2f153fc0"</span>,
        <span class="hljs-attr">"serialization"</span>: <span class="hljs-string">"string"</span>
      }
    ],
    <span class="hljs-attr">"timestamp"</span>: <span class="hljs-string">"2021-04-15T21:50:29.940Z"</span>,
    <span class="hljs-attr">"senderCustomContent"</span>: {
      <span class="hljs-attr">"authMethod"</span>: <span class="hljs-string">"PublicKey"</span>,
      <span class="hljs-attr">"authSuccessful"</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">"authUserId"</span>: <span class="hljs-string">"user123456"</span>
    },
    <span class="hljs-attr">"receiverCustomContent"</span>: {
      <span class="hljs-attr">"dbStorageId"</span>: <span class="hljs-string">"StorageCluster5"</span>
    }
  }
}</code></pre>
</div>
</section>
<section id="dtcgenver-generation-msgschemas"><div class="header-wrapper"><h4 id="x6-1-6-message-schemas"><bdi class="secno">6.1.6 </bdi>Message Schemas</h4><a aria-label="Permalink for Section 6.1.6" class="self-link" href="#dtcgenver-generation-msgschemas"></a></div>
<p>
          We define one message schema per <a class="internalDFN" data-link-type="dfn" href="#dfn-message-identifiers" id="ref-for-dfn-message-identifiers-2">message identifier</a>.
        </p>
<p>For this, we build upon the same specification of <a href="https://json-schema.org/draft/2020-12/json-schema-core.html">JSON Schema</a>
          [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-schema" title="JSON Schema: A Media Type for Describing JSON Documents">JSON-SCHEMA</a></cite>][<cite><a class="bibref" data-link-type="biblio" href="#bib-json-schema-validation" title="JSON Schema Validation: A Vocabulary for Structural Validation of JSON">JSON-SCHEMA-VALIDATION</a></cite>] as in Section <a class="sec-ref" href="#dtc-representations-json"><bdi class="secno">4.4.1 </bdi>JSON</a>.</p>
<p>
          The message schemas can be obtained through the following links:
        </p>
<ul>
<li>
            Abstract (generic) schemas:
            <ul>
<li>Generic message: <a class="external" href="schemas/message/message.schema.json" target="_blank">Schema</a></li>
<li>Generic error message: <a class="external" href="schemas/message/error/error_message.schema.json" target="_blank">Schema</a></li>
<li>Partial DTC: <a class="external" href="schemas/partial_dtc.schema.json" target="_blank">Schema</a>
</li>
</ul>
</li>
<li>
            Non-error message schemas:
            <ul>
<li><code>ContractRequest</code>: <a class="external" href="schemas/message/contract_request.schema.json" target="_blank">Schema</a></li>
<li><code>SenderContract</code>: <a class="external" href="schemas/message/sender_contract.schema.json" target="_blank">Schema</a></li>
<li><code>ReceiverContract</code>: <a class="external" href="schemas/message/receiver_contract.schema.json" target="_blank">Schema</a></li>
<li><code>AbbrevContractRequest</code>: <a class="external" href="schemas/message/abbrev_contract_request.schema.json" target="_blank">Schema</a></li>
<li><code>AbbrevContract</code>: <a class="external" href="schemas/message/abbrev_contract.schema.json" target="_blank">Schema</a></li>
</ul>
</li>
<li>
            Error message schemas:
            <ul>
<li><code>UnknownMessage</code>: <a class="external" href="schemas/message/error/unknown_message.schema.json" target="_blank">Schema</a></li>
<li><code>UnexpectedSenderContract</code>: <a class="external" href="schemas/message/error/unexpected_sender_contract.schema.json" target="_blank">Schema</a></li>
<li><code>InvalidSenderContract</code>: <a class="external" href="schemas/message/error/invalid_sender_contract.schema.json" target="_blank">Schema</a></li>
<li><code>BogusSenderCert</code>: <a class="external" href="schemas/message/error/bogus_sender_cert.schema.json" target="_blank">Schema</a></li>
<li><code>InvalidReceiverContract</code>: <a class="external" href="schemas/message/error/invalid_receiver_contract.schema.json" target="_blank">Schema</a></li>
<li><code>BogusReceiverCert</code>: <a class="external" href="schemas/message/error/bogus_receiver_cert.schema.json" target="_blank">Schema</a></li>
<li><code>InvalidAbbrevContract</code>: <a class="external" href="schemas/message/error/invalid_abbrev_contract.schema.json" target="_blank">Schema</a></li>
<li><code>InvalidAbbrevContractRequest</code>: <a class="external" href="schemas/message/error/invalid_abbrev_contract_request.schema.json" target="_blank">Schema</a></li>
</ul>
</li>
</ul>
</section>
<section id="dtcgenver-generation-msgvalidator"><div class="header-wrapper"><h4 id="x6-1-7-message-validator"><bdi class="secno">6.1.7 </bdi>Message Validator</h4><a aria-label="Permalink for Section 6.1.7" class="self-link" href="#dtcgenver-generation-msgvalidator"></a></div>
<p>
          The message validator is used to validate a JSON message against an ordered list of schemas.
          It provides an interface to the client and server implementations specified in Sections <a class="sec-ref" href="#dtcgenver-generation-complete"><bdi class="secno">6.1.2 </bdi>Complete (3-way) Handshake</a> and <a class="sec-ref" href="#dtcgenver-generation-abbrev"><bdi class="secno">6.1.3 </bdi>Abbreviated (2-way) Handshake</a>.
        </p>
<p>
          Any implementation implementing the client or server part of the generation handshake <em class="rfc2119">MUST</em> also implement the message validator.
        </p>
<p>The behavior of the message validator <em class="rfc2119">MUST</em> be implemented as follows:</p>
<ul>
<li>
<i>Input:</i>
            A JSON object (referred to as <code>msg</code>) and a list of tuples <code>(id_0,schema_0),...,(id_n-1,schema_n-1)</code>, where for <code>i=0,...,n-1</code>, <code>id_i</code>
            is a <a class="internalDFN" data-link-type="dfn" href="#dfn-message-identifiers" id="ref-for-dfn-message-identifiers-3">message identifier</a>, and <code>schema_i</code> is the according JSON schema according to Section <a class="sec-ref" href="#dtcgenver-generation-msgschemas"><bdi class="secno">6.1.6 </bdi>Message Schemas</a>.
          </li>
<li>
<i>Behavior:</i>
            The validator tries to validate <code>msg</code> against the JSON Schemas, starting with <code>schema_0</code>, applying a first-match policy.
            That is, for the first tuple <code>(id_i,schema_i)</code>, such that <code>msg</code> matches <code>schema_i</code>, the message validator terminates and returns <code>id_i</code> to the caller.
            If none of the schemas match <code>msg</code>, the validator returns <code>None</code> (which <em class="rfc2119">MAY</em> be represented as a string or as a language-internal representation of a null value).
          </li>
</ul>
</section>
<section id="dtcgenver-generation-errors"><div class="header-wrapper"><h4 id="x6-1-8-error-message-builder-error-handling"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</h4><a aria-label="Permalink for Section 6.1.8" class="self-link" href="#dtcgenver-generation-errors"></a></div>
<p>
          We define a special message builder for <a class="internalDFN" data-link-type="dfn" href="#dfn-error-message-identifiers" id="ref-for-dfn-error-message-identifiers-6">error message identifiers</a>, which provides an interface to the client and server implementations in Sections <a class="sec-ref" href="#dtcgenver-generation-complete"><bdi class="secno">6.1.2 </bdi>Complete (3-way) Handshake</a> and <a class="sec-ref" href="#dtcgenver-generation-abbrev"><bdi class="secno">6.1.3 </bdi>Abbreviated (2-way) Handshake</a>.
        </p>
<p>
          Any implementation implementing the client or server part of the generation handshake <em class="rfc2119">MUST</em> also implement the error message builder.
        </p>
<p>
          The error message builder <em class="rfc2119">MUST</em> be implemented with the following functionality:
        </p>
<ul>
<li>
<i>Input:</i>
            An <a class="internalDFN" data-link-type="dfn" href="#dfn-error-message-identifiers" id="ref-for-dfn-error-message-identifiers-7">error message identifier</a>
</li>
<li>
<i>Behavior:</i>
            The error message builder <em class="rfc2119">MUST</em> carry out the following steps:
            <ol>
<li>Create an empty JSON object (<code>{}</code>) referred to as <code>res</code>.</li>
<li>Assign the <a class="internalDFN" data-link-type="dfn" href="#dfn-error-message-identifiers" id="ref-for-dfn-error-message-identifiers-8">error message identifier</a> as a string to the <code>messageType</code> attribute of <code>res</code>.
              </li>
<li>
                Assign an implementation-dependent error message as a string to the <code>errorMessage</code> attribute of <code>res</code>.
                <div class="note" id="issue-container-generatedID-21" role="note"><div aria-level="5" class="note-title marker" id="h-note-21" role="heading"><span>Note</span></div><p class="">
                  This field can be used to carry further meta-information about the error occurrence, but is not further specified.
                </p></div>
</li>
<li>Return <code>res</code> to the caller.</li>
</ol>
</li>
</ul>
<p>The following is an informative example of an error message with the <code>UnknownMessage</code> <a class="internalDFN" data-link-type="dfn" href="#dfn-message-identifiers" id="ref-for-dfn-message-identifiers-4">message identifier</a> as generated by the error message builder.</p>
<div class="example" id="example-example-error-message-unknownmessage">
<div class="marker">
<a class="self-link" href="#example-example-error-message-unknownmessage">Example<bdi> 8</bdi></a><span class="example-title">: Example error message (UnknownMessage)</span>
</div> <pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"messageType"</span>: <span class="hljs-string">"UnknownMessage"</span>,
  <span class="hljs-attr">"errorMessage"</span>: <span class="hljs-string">"Unrecognized message format!"</span>
}</code></pre>
</div>
<p>
          Note that we do not specify how error messages are handled.
          However, we recommend that error messages <em class="rfc2119">SHOULD NOT</em> simply be ignored, as this behavior <em class="rfc2119">MAY</em> lead to invalid (and thus invaluable) DTCs.
          An implementation <em class="rfc2119">SHOULD</em> instead decide to either repeat the handshake step which caused the error, or abort the generation handshake, such that a new handshake can be initiated.
        </p>
</section>
<section id="dtcgenver-generation-protocol"><div class="header-wrapper"><h4 id="x6-1-9-protocol-stack"><bdi class="secno">6.1.9 </bdi>Protocol Stack</h4><a aria-label="Permalink for Section 6.1.9" class="self-link" href="#dtcgenver-generation-protocol"></a></div>
<div class="tlcontent">
<p>
            The JSON messages are either transmitted directly on top of <a href="https://datatracker.ietf.org/doc/html/rfc793">TCP</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc793" title="Transmission Control Protocol">RFC793</a></cite>], via <a href="https://datatracker.ietf.org/doc/html/rfc6961">TLS</a> directly on top of TCP, or wrapped into <a href="https://httpwg.org/specs/rfc7230.html">HTTP</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-http11" title="Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing">HTTP11</a></cite>] requests, optionally over TLS (<a href="https://datatracker.ietf.org/doc/html/rfc2818">HTTPS</a>) [<cite><a class="bibref" data-link-type="biblio" href="#bib-http-tls" title="HTTP Over TLS">HTTP-TLS</a></cite>].
          </p>
<p>
            In order for the lower protocol stack to be transparent for the client and server implementation, we define an additional abstraction layer.
            This abstraction layer <em class="rfc2119">MUST</em> implement two components:
          </p>
<ul>
<li>An <dfn aria-haspopup="dialog" data-dfn-type="dfn" id="dfn-outgoing-message-interface" tabindex="0">outgoing message interface</dfn>, which can be called using JSON objects to send messages.</li>
<li>An <dfn aria-haspopup="dialog" data-dfn-type="dfn" id="dfn-incoming-message-handler" tabindex="0">incoming message handler</dfn>, which forwards valid JSON messages to the client or server implementation.</li>
</ul>
<p>
            Depending on the protocol stack, these components are implemented differently, as we specify in the following.
          </p>
<p>
            If only TCP is used (no TLS or HTTP on top), the server <em class="rfc2119">MUST</em> provide an open port that can be contacted by the client.
            Upon contract handshake initiation, the client <em class="rfc2119">MUST</em> open a connection to the server, such that both the client and the server have an open bi-directional TCP socket.
            The two abstraction components <em class="rfc2119">MUST</em> be implemented as follows for client and server:
          </p>
<ul>
<li>
<a class="internalDFN" data-link-type="dfn" href="#dfn-outgoing-message-interface" id="ref-for-dfn-outgoing-message-interface-6">Outgoing message interface</a>: Whenever called with a valid JSON object, the implementation <em class="rfc2119">MUST</em> serialize the JSON as a string in <a href="https://datatracker.ietf.org/doc/html/rfc3629">UTF-8</a>
              encoding [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3629" title="UTF-8, a transformation format of ISO 10646">RFC3629</a></cite>] and send it through the TCP socket with a trailing newline character.
            </li>
<li>
<a class="internalDFN" data-link-type="dfn" href="#dfn-incoming-message-handler" id="ref-for-dfn-incoming-message-handler-5">Incoming message handler</a>:
              Whenever the incoming data can be aggregated to a valid JSON object, it <em class="rfc2119">MUST</em> be parsed as a JSON object,
              and the associated client or server implementation <em class="rfc2119">MUST</em> be called with said JSON object.
            </li>
</ul>
<p>
            If TLS is used on top of TCP without HTTP, the server <em class="rfc2119">MUST</em> provide an open TCP port that can be contacted by the client, but only accepts TLS traffic.
            Upon contract handshake initiation, the client <em class="rfc2119">MUST</em> open a connection to the server and carry out a TLS handshake, such that a TLS-protected tunnel is established.
            Then, the abstraction components (i.e., the <a class="internalDFN" data-link-type="dfn" href="#dfn-outgoing-message-interface" id="ref-for-dfn-outgoing-message-interface-7">outgoing message interface</a> and the <a class="internalDFN" data-link-type="dfn" href="#dfn-incoming-message-handler" id="ref-for-dfn-incoming-message-handler-6">incoming message handler</a>) <em class="rfc2119">MUST</em> be implemented as in the no-TLS case, but using the TLS tunnel instead.
          </p>
<p>
            If HTTP or HTTPS is used, the server <em class="rfc2119">MUST</em> provide an HTTP(S) server to which the client can connect.
            Upon contract handshake initiation, the client <em class="rfc2119">MUST</em> open a TCP connection (without TLS) or create a TLS tunnel through a TLS handshake (with TLS), through which HTTP traffic can be sent.
            For the abstraction components, we differentiate between client and sender.
          </p>
<p>The client-side abstraction components for HTTP(S) <em class="rfc2119">MUST</em> be implemented as follows:</p>
<ul>
<li>
<a class="internalDFN" data-link-type="dfn" href="#dfn-outgoing-message-interface" id="ref-for-dfn-outgoing-message-interface-8">Outgoing message interface</a>:
              Whenever called with a valid JSON object, the implementation <em class="rfc2119">MUST</em> create and send an HTTP POST request through the established tunnel, containing the serialized JSON object as its body, and <em class="rfc2119">MUST</em> set the <code>Content-Type</code> header to <code>application/json</code>.
              It <em class="rfc2119">MUST</em> then install the <a class="internalDFN" data-link-type="dfn" href="#dfn-incoming-message-handler" id="ref-for-dfn-incoming-message-handler-7">incoming message handler</a>, such that it gets called with the response to the request.
            </li>
<li>
<a class="internalDFN" data-link-type="dfn" href="#dfn-incoming-message-handler" id="ref-for-dfn-incoming-message-handler-8">Incoming message handler</a>:
              Is called with the response of a previously executed POST request.
              If the response <code>Content-Type</code> header does not indicate the <code>application/json</code> type,
              the implementation <em class="rfc2119">SHOULD</em> initiate a retransmission of the previous message by either sending an <code>UnknownMessage</code> error message (see Sections <a class="sec-ref" href="#dtcgenver-generation-msgids"><bdi class="secno">6.1.4 </bdi>Message Identifiers</a> and <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>), or by retransmitting the previous message, using the <a class="internalDFN" data-link-type="dfn" href="#dfn-outgoing-message-interface" id="ref-for-dfn-outgoing-message-interface-9">outgoing message interface</a>.
              <div class="note" id="issue-container-generatedID-22" role="note"><div aria-level="5" class="note-title marker" id="h-note-22" role="heading"><span>Note</span></div><p class="">
                Because the client is not simply able to provide feedback in the form of an HTTP status code, as it only performs requests, we leave error handling to the implementation.
                We refer to the general discussion of ReShare's approach on error handling in Section <a class="sec-ref" href="#dtcgenver-generation-errors"><bdi class="secno">6.1.8 </bdi>Error Message Builder &amp; Error Handling</a>.
              </p></div>
</li>
</ul>
<p>The server-side abstraction components for HTTP(S) <em class="rfc2119">MUST</em> be implemented as follows:</p>
<ul>
<li>
<a class="internalDFN" data-link-type="dfn" href="#dfn-outgoing-message-interface" id="ref-for-dfn-outgoing-message-interface-10">Outgoing message interface</a>:
              <em class="rfc2119">MUST</em> be called with the context of a previously received incoming HTTP POST request.
              The implementation <em class="rfc2119">MUST</em> create and send a response to the request in the context with which the outgoing message interface was called.
              The body of the response <em class="rfc2119">MUST</em> be set to the JSON object, with which the outgoing message interface was called.
              The status code of a message with a <a class="internalDFN" data-link-type="dfn" href="#dfn-non-error-message-identifiers" id="ref-for-dfn-non-error-message-identifiers-3">non-error message identifier</a> (see Section <a class="sec-ref" href="#dtcgenver-generation-msgids"><bdi class="secno">6.1.4 </bdi>Message Identifiers</a>) <em class="rfc2119">MUST</em> be set to <code>200</code>.
              The status code of a message with an <a class="internalDFN" data-link-type="dfn" href="#dfn-error-message-identifiers" id="ref-for-dfn-error-message-identifiers-9">error message identifier</a> (see Section <a class="sec-ref" href="#dtcgenver-generation-msgids"><bdi class="secno">6.1.4 </bdi>Message Identifiers</a>) <em class="rfc2119">SHOULD</em> be set to one of the acceptable status codes from the table below, depending on the message identifier.
              The <code>Content-Type</code> header <em class="rfc2119">MUST</em> be set to <code>application/json</code>.
              <div class="note" id="issue-container-generatedID-23" role="note"><div aria-level="5" class="note-title marker" id="h-note-23" role="heading"><span>Note</span></div><p class="">
                A <code>200</code> status code is considered acceptable for every defined error message, as these higher-layer errors are already uniquely identified through their respective message schemas.
                Thus, using a <code>200</code> status code does not hinder an implementation's functionality, but we consider the usage of proper error status codes good practice.
              </p></div>
</li>
<li>
<a class="internalDFN" data-link-type="dfn" href="#dfn-incoming-message-handler" id="ref-for-dfn-incoming-message-handler-9">Incoming message handler</a>:
              <em class="rfc2119">MUST</em> be called whenever an HTTP request is received from the client.
              If the <code>Content-Type</code> header of the request does not indicate the <code>application/json</code>
              type, the incoming message handler <em class="rfc2119">MUST</em> respond with an empty response with a <code>406</code> status code, without calling the server-side implementation of the handshake.
              Else, the body of the request is parsed as a JSON object, and the server-side implementation of the handshake (defined in Sections <a class="sec-ref" href="#dtcgenver-generation-complete"><bdi class="secno">6.1.2 </bdi>Complete (3-way) Handshake</a> and <a class="sec-ref" href="#dtcgenver-generation-abbrev"><bdi class="secno">6.1.3 </bdi>Abbreviated (2-way) Handshake</a>) is called with the parsed JSON object.
              Additionally, the incoming message handler <em class="rfc2119">SHOULD</em> store the context of the request, such that it can be passed to the <a class="internalDFN" data-link-type="dfn" href="#dfn-outgoing-message-interface" id="ref-for-dfn-outgoing-message-interface-11">outgoing message interface</a> once it is called by the server implementation.
            </li>
</ul>
<p>
            We define the following acceptable status codes for error messages based on the <a class="internalDFN" data-link-type="dfn" href="#dfn-error-message-identifiers" id="ref-for-dfn-error-message-identifiers-10">error message identifiers</a> (see Section <a class="sec-ref" href="#dtcgenver-generation-msgids"><bdi class="secno">6.1.4 </bdi>Message Identifiers</a>):
          </p>
<div class="note" id="issue-container-generatedID-24" role="note"><div aria-level="5" class="note-title marker" id="h-note-24" role="heading"><span>Note</span></div><p class="">
            We only define status codes for error messages which can be sent by the server during the handshake, as a client only sends HTTP requests, which do not carry a status code.
          </p></div>
<table class="customtable">
<thead>
<tr>
<th><a class="internalDFN" data-link-type="dfn" href="#dfn-message-identifiers" id="ref-for-dfn-message-identifiers-5">Message identifier</a></th>
<th>Recommended HTTP Status Codes</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>UnknownMessage</code></td>
<td><code>200</code>, <code>400</code></td>
</tr>
<tr>
<td><code>BogusSenderCert</code></td>
<td><code>200</code>, <code>422</code></td>
</tr>
<tr>
<td><code>InvalidReceiverContract</code></td>
<td><code>200</code>, <code>422</code></td>
</tr>
<tr>
<td><code>InvalidAbbrevContractRequest</code></td>
<td><code>200</code>, <code>422</code></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="dtcgenver-verification"><div class="header-wrapper"><h3 id="x6-2-dtc-verification"><bdi class="secno">6.2 </bdi>DTC Verification</h3><a aria-label="Permalink for Section 6.2" class="self-link" href="#dtcgenver-verification"></a></div>
<div class="tlcontent">
<p>
          DTC verification can be executed fully locally, as the DTC itself contains all information necessary for its verification.
          This self-containing property of DTCs allows for efficient and unambiguous verification without the need to directly communicate with the involved parties.
        </p>
<p>
          To verify a DTC and the resources for which it contains checksums, access to the following information is required:
        </p>
<ul>
<li>The DTC itself</li>
<li>The resource(s) to be verified</li>
<li>A list of trusted root CAs (and their public keys)</li>
</ul>
<p>
          The verification steps immediately emerge from the design of the trust chain of DTCs.
          In order to verify a syntactically valid DTC, one <em class="rfc2119">MUST</em> execute the following verification steps in any order:
        </p>
<ul>
<li>
            Verify the public key certificates by verifying the certificate chains in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-26"><code>sender</code></a>
            and <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-20"><code>receiver</code></a> using a pre-installed trusted root CA's public key as the trust anchor.
            <div class="note" id="issue-container-generatedID-25" role="note"><div aria-level="4" class="note-title marker" id="h-note-25" role="heading"><span>Note</span></div><p class="">
              This step <em class="rfc2119">SHOULD</em> include checking whether the public key certificates are issued for the respective authorities identified by the <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-41">IRIs</a> contained in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-27"><code>sender</code></a> and <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-21"><code>receiver</code></a> fields.
              We further discuss this verification step in Section <a class="sec-ref" href="#considerations-iricertlink"><bdi class="secno">A.2 </bdi>Identity Management</a>.
            </p></div>
</li>
<li>
            Verify the DTC signatures in <a class="internalDFN" data-link-type="dfn" data-lt="dtc-senderSig" href="#dfn-dtc-sendersig" id="ref-for-dfn-dtc-sendersig-14"><code>senderSig</code></a> and <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiverSig" href="#dfn-dtc-receiversig" id="ref-for-dfn-dtc-receiversig-13"><code>receiverSig</code></a> using the public keys contained in the certificates in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-28"><code>sender</code></a> and <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-22"><code>receiver</code></a> fields and the signature verification process specified in Section <a class="sec-ref" href="#dtc-signatures-verification"><bdi class="secno">4.5.4 </bdi>Signature Verification</a>.
          </li>
<li>
            Verify the fact checksums using the original data.
            For this, the facts need to be serialized according to the serialization format identified in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts-serialization" href="#dfn-dtc-facts-serialization" id="ref-for-dfn-dtc-facts-serialization-5"><code>serialization</code></a> field.
            Subsequently, the checksums need to be re-computed given the serialized facts, and compared to the checksum included in the DTC.
            <div class="note" id="issue-container-generatedID-26" role="note"><div aria-level="4" class="note-title marker" id="h-note-26" role="heading"><span>Note</span></div><p class="">
              We do not further specify this verification step, as the process of serializing facts of different types is deemed out-of-scope for this document.
            </p></div>
</li>
</ul>
<p>
          If any of the verification steps fail, the verification mechanism <em class="rfc2119">MUST</em> terminate with a negative result.
        </p>
<p>
          Depending on the use case, it <em class="rfc2119">MAY</em> be desirable to extend these verification steps, e.g., by verifying that the owner of the certificates in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-23"><code>receiver</code></a> and <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-29"><code>sender</code></a> fields are as expected.
          While such extensions are not part of this verification mechanism, we advise implementors to carefully review that no unverified assumptions are made about the contents of a DTC.
        </p>
</div>
</section>
<p>
      ReShare with its specification of DTCs, the ontology, and the DTC creation and verification process, enables users to achieve data trustworthiness and reliability in a scalable manner.
      In this context, the central aspect not covered before by Web technology, but essential in the context of data-driven or industrial data sharing settings is the accountable involvement of both parties in the data transmission process, which is implemented using bilateral signatures in ReShare.
    </p>
</section>
<section class="informative appendix" id="considerations"><div class="header-wrapper"><h2 id="a-considerations"><bdi class="secno">A. </bdi>Considerations</h2><a aria-label="Permalink for Appendix A." class="self-link" href="#considerations"></a></div><p><em>This section is non-normative.</em></p>
    

    In the following section, we briefly elaborate on some of the design decisions and considerations w.r.t. ReShare.

    <section class="informative" id="considerations-otherw3ctechs"><div class="header-wrapper"><h3 id="a-1-relation-to-other-w3c-documents"><bdi class="secno">A.1 </bdi>Relation to Other W3C Documents</h3><a aria-label="Permalink for Appendix A.1" class="self-link" href="#considerations-otherw3ctechs"></a></div><p><em>This section is non-normative.</em></p>
<p>
        In recent years, both W3C itself and W3C Community Groups have been quite active in the field of expressing cryptographically-backed claims or statements about data.
        To the best of our knowledge, the following three documents are especially noteworthy:
      </p>
<ul>
<li>Verifiable Credentials [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-model" title="Verifiable Credentials Data Model v1.1">VC-DATA-MODEL</a></cite>],</li>
<li>Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity">DATA-INTEGRITY</a></cite>], and</li>
<li>Decentralized Identifiers [<cite><a class="bibref" data-link-type="biblio" href="#bib-did-core" title="Decentralized Identifiers (DIDs) v1.0">DID-CORE</a></cite>].</li>
</ul>
<p>
        ReShare was developed largely in parallel to these developments throughout years 2020 until early 2021, and the major parts of this document were created mostly from April to the end of 2021.
        ReShare was designed with backward-compatability with the existing Web infrastructure in mind and as such makes use of established standards at the time of design as a largely self-contained solution.
        That being said, future work, e.g., towards standardization, may potentially also make use of these related efforts.
        A potential role of Decentralized Identifiers in ReShare is discussed in Section <a class="sec-ref" href="#considerations-iricertlink"><bdi class="secno">A.2 </bdi>Identity Management</a>.
        In the following, we focus on Verifiable Credentials and the Data Integrity specification.
      </p>
<section class="notoc"><div class="header-wrapper"><h4 id="verifiable-credentials">
          Verifiable Credentials
        </h4><a aria-label="Permalink for this Appendix" class="self-link" href="#verifiable-credentials"></a></div>
<p>
          Verifiable Credentials (VC) [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-model" title="Verifiable Credentials Data Model v1.1">VC-DATA-MODEL</a></cite>] provide a cryptographically-secure and machine-readable approach to expressing credentials.
          An overview of conceivable use cases can be found in [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-use-cases" title="Verifiable Credentials Use Cases">VC-USE-CASES</a></cite>], and include a variety of claims in the areas of education, finance, healthcare and more.
        </p>
<p>
          The data model of a VC is defined independently from its representation.
          However, the specification defines both a JSON, and a JSON-LD representation, thus taking a very similar approach to ReShare.
        </p>
<p>
          As VCs represent very general means of expressing, presenting, and proving a set of claims in the form of credentials, it is conceivable that VCs could be used as a framework for an implementation of DTCs, together with a DTC generation mechanism similar to the one we currently specify.
        </p>
<p>
          However, the following two considerations have lead us to the decision of refraining from the use of VCs in ReShare as of now:
        </p>
<ol>
<li>
<p>
              While a credential is defined as essentially consisting of metadata, one ore more claims, and one or more proofs, which is applicable to the model of a DTC, the use cases in [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-use-cases" title="Verifiable Credentials Use Cases">VC-USE-CASES</a></cite>] are very much centered around use cases of a single individual in everyday life.
            </p>
<p>
              This makes us wonder whether applicability in typical use-cases of inter-organizational data sharing of ReShare is given, as such scenarios might not have been considered in the design of the VC specification.
            </p>
</li>
<li>
<p>
              Probably the most essential design choice defining the paradigm of DTCs lies in the idea of bilateral on-demand signatures, as we describe in-detail in Section <a class="sec-ref" href="#dtc-signature-paradigm"><bdi class="secno">4.1 </bdi>Mutual Commitment through Bilateral Signatures</a>.
            </p>
<p>
              In the VC specification, while multiple proofs within a single VC are supported, a VC always has one issuer by design (see <a href="https://www.w3.org/TR/vc-data-model/#issuer">4.5 Issuer</a>), which is incompatible with the paradigm of a DTC having two equally-involved parties, the <a class="internalDFN" data-link-type="dfn" href="#dfn-sender" id="ref-for-dfn-sender-43">sender</a> and the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-41">receiver</a>, whose signatures are both required for a DTC to be considered valid.
            </p>
</li>
</ol>
<p>
          Of course, depending on future developments, the suitability of VC as a framework for DTCs should be re-assessed if a new version of ReShare is to be designed in future.
        </p>
<p>
          For example, as we discuss below, signature sets, as used in contracts, are included in the Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity">DATA-INTEGRITY</a></cite>] specification, and could find their way into a future version of the VC specification, possibly expanding the set of use cases to those of DTCs.
        </p>
</section>
<section class="notoc"><div class="header-wrapper"><h4 id="data-integrity">Data Integrity</h4><a aria-label="Permalink for this Appendix" class="self-link" href="#data-integrity"></a></div>
<p>
          The Data Integrity specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity">DATA-INTEGRITY</a></cite>] strives to provide data models and representations of cryptographic proofs, such as signatures and integrity checksums, within the context of Linked Data.
        </p>
<p>
          Such mechanisms clearly find a promising use case in DTCs, as DTCs include integrity checksums of the data subject to the underlying data transmission (see <a class="internalDFN" data-link-type="dfn" data-lt="dtc-facts" href="#dfn-dtc-facts" id="ref-for-dfn-dtc-facts-21"><code>facts</code></a>), as well as digital signatures of both DTC parties (see <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-30"><code>sender</code></a> and <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-24"><code>receiver</code></a>).
          Even proof sets are already included in the Data Integrity specification (see <a href="https://w3c-ccg.github.io/data-integrity-spec/#proof-sets">3.1 Proof Sets</a>), for which we deem DTCs a very interesting use case.
        </p>
<p>
          Naturally, ReShare would greatly profit from employing a standardized mechanism of including and structuring these cryptographic proofs in DTCs.
          Therefore, we consider the Data Integrity specification as a promising mechanism to be used in a future version of ReShare.
        </p>
<p>
          As of now, ReShare uses a custom implementation of embedding signatures and checksums in DTCs, which has to be attributed to the temporal overlap of ReShare and the Data Integrity specification, as the Data Integrity specification is in a relatively early stage of standardization.
        </p>
</section>
</section>
<section class="informative" id="considerations-iricertlink"><div class="header-wrapper"><h3 id="a-2-identity-management"><bdi class="secno">A.2 </bdi>Identity Management</h3><a aria-label="Permalink for Appendix A.2" class="self-link" href="#considerations-iricertlink"></a></div><p><em>This section is non-normative.</em></p>
<p>
        Tackling the challenge of integrating a consistent and well-designed identity management approach, which also seamlessly interoperates within the ecosystem of common application contexts, clearly is a non-trivial task.
        We elaborate on our considerations w.r.t. an identity management system within ReShare in the following.
      </p>
<section class="notoc"><div class="header-wrapper"><h4 id="current-approach">Current Approach</h4><a aria-label="Permalink for this Appendix" class="self-link" href="#current-approach"></a></div>
<p>
          ReShare employs X.509 certificates for identity management.
          Parties of a contract are reliably linked to their signatures through their public key, which is contained in the DTC itself.
          Through this approach, we achieve a robust link between the party identified through an X.509 certificate to the signature that party creates.
        </p>
<p>
          However, the linking of an X.509 certificate to the party itself (e.g., a physical person or company) is also a major task in defining an identity management system.
          Here, we give recommendations on what such an approach should fulfill, but in general consider this task out of scope for ReShare.
        </p>
<p>
          The information about the two signing parties of a DTC include a public key certificate and an <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-42">IRI</a> - separated from the certificate - per party.
          These <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-43">IRI</a> and public key certificate of a party are included in the <a class="internalDFN" data-link-type="dfn" data-lt="dtc-sender" href="#dfn-dtc-sender" id="ref-for-dfn-dtc-sender-31"><code>sender</code></a> and <a class="internalDFN" data-link-type="dfn" data-lt="dtc-receiver" href="#dfn-dtc-receiver" id="ref-for-dfn-dtc-receiver-25"><code>receiver</code></a> fields of a DTC,
          as described in Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>.
        </p>
<p>
          However, the <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-44">IRI</a> of a party should additionally be included in the subject part of a party's public key certificate.
          Thereby, the party identified through the <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-45">IRI</a> can be held accountable for the uses of the private key matching the public key provided in the X.509 certificate, as long as the certificate validity is trusted.
        </p>
<p>
          For this link of <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-46">IRI</a> to X.509 certificate to be trustworthy, self-signed X.509 certificates are only conceivable for testing purposes.
          In productive use, for the DTC to be valuable, certificates should always be valid within a certificate chain starting at a root certificate, which is commonly trusted by all conceivable verifiers of the DTC to be created.
        </p>
<p>
          As specified in Section <a class="sec-ref" href="#dtc-data-structure"><bdi class="secno">4.3 </bdi>DTC Data Structure</a>, we leave our system open to extensions w.r.t. other certificate technologies than X.509.
          Therefore, we also decided not to further specify a mechanism of mapping <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-47">IRIs</a> to parties such as phyisical persons or organizations, but consider it out of scope.
        </p>
<p>
          However, in the following, we discuss how new technologies and standardization approaches of W3C could be used in future to extend or improve identity management in ReShare.
        </p>
</section>
<section class="notoc"><div class="header-wrapper"><h4 id="possible-future-adaptions">Possible Future Adaptions</h4><a aria-label="Permalink for this Appendix" class="self-link" href="#possible-future-adaptions"></a></div>
<p>
          We opted to use X.509 as our Public Key Infrastructure (PKI), as it is a commonly trusted system, and therefore does not hinder acceptability of ReShare.
        </p>
<p>
          However, X.509 is quite inflexible with the employed trust infrastructure, as it enforces a hierarchical trust structure by design.
          Furthermore, while it is a common use case of X.509 to verifiably link certificates to domain names, to the best of our knowledge, a mechanism to verifiably link certificates to parties such as persons or organizations can hardly be found.
        </p>
<p>
          For these reasons, deviating from pure use of X.509 certificates in ReShare may prove to be best in future.
          One technology is especially noteworthy with these regards, which is the Decentralized Identifiers specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-did-core" title="Decentralized Identifiers (DIDs) v1.0">DID-CORE</a></cite>].
        </p>
<p>
          A Decentralized Identifier (DID) allows to identify an arbitrary entity, such as an individual or organization.
          Because DIDs themselves are <a href="https://www.w3.org/TR/did-core/#dfn-uri">URIs</a> (Uniform Resource Identifiers), which in turn is a subset of <a class="internalDFN" data-link-type="dfn" href="#dfn-iri" id="ref-for-dfn-iri-48">IRIs</a>, DIDs could be used within ReShare with ease.
        </p>
<p>
          However, the DIDs themselves only define a mechanism to access the DID document related to the DID, which contains the statements the DID makes, including the link to a physical identity, or the public key material.
          For the accountability and verifiability guarantees we deem crucial in ReShare, such information should be self-contained within a DTC itself.
          Now, while it is conceivable to directly include DID documents in a DTC, this conflicts with an essential design choice of [<cite><a class="bibref" data-link-type="biblio" href="#bib-did-core" title="Decentralized Identifiers (DIDs) v1.0">DID-CORE</a></cite>], that is, that the DID controller is in charge of altering, or more generally, controlling the DID document.
          When this DID document is included within the DTC, this makes the DID document immutable without the DTC losing its validity, and thus takes away the control from the DID controller.
          It is hard to say whether this deviation from the design of [<cite><a class="bibref" data-link-type="biblio" href="#bib-did-core" title="Decentralized Identifiers (DIDs) v1.0">DID-CORE</a></cite>] would be reasonable.
        </p>
<p>
          If one decides to employ DIDs in DTCs, and directly includes the attached DID documents in some representations, the DID document could completely replace the public key certificate of a party within ReShare.
          A public key can optionally be directly included within the DID document (see <a href="https://www.w3.org/TR/did-core/#verification-material">5.2.1 Verification Material</a>), making an external public key certificate unnecessary, as long as the trustworthiness of this public key can be guaranteed.
        </p>
<p>
          In our current approach, we have established verifiability independent of certificate availability by including the public key certificates directly within a DTC.
          For the use of DIDs to provide the same verifiability guarantees, the following points would have to be fulfilled:
        </p>
<ul>
<li>The DID document has to be included in the DTC itself (see above),</li>
<li>
            the DID document has to contain a public key (as a JSON Web Key, JWK [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7517" title="JSON Web Key (JWK)">RFC7517</a></cite>]), and
          </li>
<li>
            the JWK has to contain the X.509 certificate chain (see the <a href="https://datatracker.ietf.org/doc/html/rfc7517#section-4.7"><code>x5c</code> property</a>).
          </li>
</ul>
<p>
          Note that both the use of <code>publicKeyJwk</code> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-did-core" title="Decentralized Identifiers (DIDs) v1.0">DID-CORE</a></cite>] and the use of <code>x5c</code> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7517" title="JSON Web Key (JWK)">RFC7517</a></cite>] are optional, and thus would have to be enforced in a future version of ReShare.
        </p>
<p>
          Furthermore, as the use of JWKs is currently the only specified stable mechanism for including public keys in DID documents (see <a href="https://www.w3.org/TR/did-core/#verification-material">5.2.1 Verification Material</a>), and JWKs rely on X.509 certificates, we still find ourselves with the disadvantages of using an X.509 PKI when using DIDs as of now.
        </p>
<p>
          Because of the stated disadvantages of X.509 certificates, we see the need for a novel mechanism to prove possession of a public key, which clearly relates said key to an entity.
          Such a mechanism should integrate well within the modern ecosystem of Linked Data, while building upon a secure and trusted PKI with well-defined methods to register or create your own certificate, which is linked to you as a person, organization, or different entity.
        </p>
</section>
</section>
<section class="informative" id="considerations-2or3wayhs"><div class="header-wrapper"><h3 id="a-3-dtc-generation-two-handshake-versions"><bdi class="secno">A.3 </bdi>DTC Generation: Two Handshake Versions</h3><a aria-label="Permalink for Appendix A.3" class="self-link" href="#considerations-2or3wayhs"></a></div><p><em>This section is non-normative.</em></p>
<p>
        We have introduced the shortened 2-way handshake as a way to reduce the communication overhead in an application scenario with high communication latencies.
        However, this shortened version requires that the transmission of the data which is signed in a given DTC is completed before DTC generation.
        With the complete 3-way handshake, the DTC generation is completely independent of the underlying data transmission, except that the <a class="internalDFN" data-link-type="dfn" href="#dfn-receiver" id="ref-for-dfn-receiver-42">receiver</a> has to know which resources are transmitted.
      </p>
<p>
        The sequentiality arising from a dependency on the data transmission has practical disadvantages in many cases, such as an increased management and implementation overhead by more closely integrating the data transmission process into the DTC generation mechanism.
        Given the context system, configuration or implementation changes in the data transmission backend might be necessary to implement the necessary pre-sharing to allow for a short handshake.
      </p>
<p>
        Therefore, we consider the complete 3-way handshake the default handshake, but still specify the shortened 2-way handshake for special high-latency environments.
        Without a strong argument against it, we advise to use the 3-way handshake.
      </p>
</section>
</section>
<section class="appendix" id="acknowledgements"><div class="header-wrapper"><h2 id="b-acknowledgements"><bdi class="secno">B. </bdi>Acknowledgements</h2><a aria-label="Permalink for Appendix B." class="self-link" href="#acknowledgements"></a></div>
<p>
      The authors are grateful for the supervision of Prof. Dr. Stefan Decker and Prof. Dr.-Ing. Klaus Wehrle.
    </p>
<p>
      The authors would like to thank <a href="http://www.essepuntato.it/">Silvio Peroni</a> for developing <a href="http://www.essepuntato.it/lode">LODE</a>, a Live OWL Documentation Environment, which is used for representing the Cross Referencing Section of this document and <a href="https://w3id.org/people/dgarijo">Daniel Garijo</a> for developing <a href="https://github.com/dgarijo/Widoco">Widoco</a>, the program used to create the template used in this documentation.
    </p>
<p>
      The authors would further like to thank the reviewers of the ESWC paper [<cite><a class="bibref" data-link-type="biblio" href="#bib-reshare" title="Data Reliability and Trustworthiness Through Digital Transmission Contracts">ReShare</a></cite>] for providing insightful and constructive feedback on the topic.
    </p>
<p>
      Funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) under Germany's Excellence Strategy -- EXC-2023 Internet of Production -- 390621612.
    </p>
</section>
<section class="appendix" id="tof"><div class="header-wrapper"><h2 id="c-list-of-figures"><bdi class="secno">C. </bdi>List of Figures</h2><a aria-label="Permalink for Appendix C." class="self-link" href="#tof"></a></div><ul class="tof">
<li class="tofline">
<a class="tocxref" href="#fig-example-scenario-1"><span class="self-link">Figure <bdi class="figno">1</bdi></span> <span class="fig-title">
              The example scenario in aircraft manufacturing.
              Besides a physical dataflow of the suppliers (A and B) to the manufacturer (C), production data is shared with C.
            </span></a>
</li><li class="tofline">
<a class="tocxref" href="#fig-example-scenario-2"><span class="self-link">Figure <bdi class="figno">2</bdi></span> <span class="fig-title">
            The application of DTCs to the example scenario in the aviation industry.
            DTCs (1) are certified by sender and receiver, (2) secure the transmitted data, and (3) are stored (longtime) in digital secure storage systems.
          </span></a>
</li><li class="tofline">
<a class="tocxref" href="#fig-dtc-sigproc-pipeline-creation"><span class="self-link">Figure <bdi class="figno">3</bdi></span> <span class="fig-title">
              The high-level process of creating a DTC signature.
              The DTC is pre-processed first before creating the DTC signature using the signer's private key.
            </span></a>
</li><li class="tofline">
<a class="tocxref" href="#fig-dtc-sigproc-pipeline-verification"><span class="self-link">Figure <bdi class="figno">4</bdi></span> <span class="fig-title">
              The high-level process of verifying a DTC signature.
              The DTC is pre-processed first before verifiying the given DTC signature using the signer's public key.
            </span></a>
</li><li class="tofline">
<a class="tocxref" href="#fig-dtc-sigproc-preprocessing"><span class="self-link">Figure <bdi class="figno">5</bdi></span> <span class="fig-title">
              The pre-processing steps for creating and verifying DTC signatures.
              The internal DTC is serialized as specified by the JSON DTC represenation, pruned by removing unsigned material, normalized, and encoded as a <span>UTF-8</span>
              string [<cite><span class="bibref" data-link-type="biblio">RFC3629</span></cite>].
            </span></a>
</li><li class="tofline">
<a class="tocxref" href="#fig-dtc-sigproc-creation"><span class="self-link">Figure <bdi class="figno">6</bdi></span> <span class="fig-title">
              The process of creating a DTC signature, based on its pre-processed form.
              Using said pre-processed DTC and its own private key, the signing party creates an RSA signature, which is encoded as <span>Base64</span> [<cite><span class="bibref" data-link-type="biblio">RFC4648</span></cite>].
            </span></a>
</li><li class="tofline">
<a class="tocxref" href="#fig-dtc-sigproc-verification"><span class="self-link">Figure <bdi class="figno">7</bdi></span> <span class="fig-title">
              The process of verifying a DTC signature, based on its pre-processed form.
              Requires said pre-processed DTC, the DTC signature encoded as <span>Base64</span> [<cite><span class="bibref" data-link-type="biblio">RFC4648</span></cite>], and the signing party's public key.
              The signature is first decoded into a binary form, and then verified using the pre-processed DTC and the public key.
            </span></a>
</li><li class="tofline">
<a class="tocxref" href="#fig-dtcgen-overview"><span class="self-link">Figure <bdi class="figno">8</bdi></span> <span class="fig-title">
            A schematic overview of the components of the DTC generation mechanism.
          </span></a>
</li><li class="tofline">
<a class="tocxref" href="#fig-dtc-generation-handshake"><span class="self-link">Figure <bdi class="figno">9</bdi></span> <span class="fig-title">
              A message diagram of the 3-way contract generation handshake, initiated by the <span>receiver</span> (<span class="fig-agent">R</span>).
              Upon a request (<i>R1</i>=<code>ContractRequest</code>), the <span>sender</span> (<span class="fig-agent">S</span>) assembles the DTC, signs it, and sends it to the <span>receiver</span> (<i>S1</i>=<code>SenderContract</code>).
              Finally, the <span>receiver</span> verifies and signs the DTC, and sends its own signature to the <span>sender</span>
              (<i>R2</i>=<code>ReceiverContract</code>).
            </span></a>
</li><li class="tofline">
<a class="tocxref" href="#fig-dtc-generation-handshake-abbrev"><span class="self-link">Figure <bdi class="figno">10</bdi></span> <span class="fig-title">
              A message diagram of the 2-way contract generation handshake, initiated by the <span>receiver</span> (<span class="fig-agent">R</span>).
              The <span>receiver</span> compiles the complete DTC, and the <span>sender</span> (<span class="fig-agent">S</span>)
              verifies and signs it afterward.
              Message abbreviations: R1'=<code>AbbrevContractRequest</code>, S1'=<code>AbbrevContract</code>.
            </span></a>
</li>
</ul></section>
<section class="appendix" id="references"><div class="header-wrapper"><h2 id="d-references"><bdi class="secno">D. </bdi>References</h2><a aria-label="Permalink for Appendix D." class="self-link" href="#references"></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="d-1-normative-references"><bdi class="secno">D.1 </bdi>Normative references</h3><a aria-label="Permalink for Appendix D.1" class="self-link" href="#normative-references"></a></div>
<dl class="bibliography"><dt id="bib-fips-180-4">[FIPS-180-4]</dt><dd>
<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf"><cite>FIPS PUB 180-4: Secure Hash Standard (SHS)</cite></a>.  U.S. Department of Commerce/National Institute of Standards and Technology. August 2015. National Standard. URL: <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>
</dd><dt id="bib-http-tls">[HTTP-TLS]</dt><dd>
<a href="https://httpwg.org/specs/rfc2818.html"><cite>HTTP Over TLS</cite></a>. E. Rescorla.  IETF. May 2000. Informational. URL: <a href="https://httpwg.org/specs/rfc2818.html">https://httpwg.org/specs/rfc2818.html</a>
</dd><dt id="bib-http11">[HTTP11]</dt><dd>
<a href="https://httpwg.org/specs/rfc7230.html"><cite>Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</cite></a>. R. Fielding, Ed.; J. Reschke, Ed..  IETF. June 2014. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc7230.html">https://httpwg.org/specs/rfc7230.html</a>
</dd><dt id="bib-iso8601">[ISO8601]</dt><dd>
<a href="http://www.iso.org/iso/catalogue_detail?csnumber=40874"><cite>Representation of dates and times. ISO 8601:2004.</cite></a>.  International Organization for Standardization (ISO). 2004. ISO 8601:2004. URL: <a href="http://www.iso.org/iso/catalogue_detail?csnumber=40874">http://www.iso.org/iso/catalogue_detail?csnumber=40874</a>
</dd><dt id="bib-json-ld11">[JSON-LD11]</dt><dd>
<a href="https://www.w3.org/TR/json-ld11/"><cite>JSON-LD 1.1</cite></a>. Gregg Kellogg; Pierre-Antoine Champin; Dave Longley.  W3C. 16 July 2020. W3C Recommendation. URL: <a href="https://www.w3.org/TR/json-ld11/">https://www.w3.org/TR/json-ld11/</a>
</dd><dt id="bib-json-ld11-api">[JSON-LD11-API]</dt><dd>
<a href="https://www.w3.org/TR/json-ld11-api/"><cite>JSON-LD 1.1 Processing Algorithms and API</cite></a>. Gregg Kellogg; Dave Longley; Pierre-Antoine Champin.  W3C. 16 July 2020. W3C Recommendation. URL: <a href="https://www.w3.org/TR/json-ld11-api/">https://www.w3.org/TR/json-ld11-api/</a>
</dd><dt id="bib-json-schema">[JSON-SCHEMA]</dt><dd>
<a href="https://datatracker.ietf.org/doc/html/draft-bhutton-json-schema"><cite>JSON Schema: A Media Type for Describing JSON Documents</cite></a>. Austin Wright; Henry Andrews; Ben Hutton; Greg Dennis.  Internet Engineering Task Force (IETF). 8 December 2020. Internet-Draft. URL: <a href="https://datatracker.ietf.org/doc/html/draft-bhutton-json-schema">https://datatracker.ietf.org/doc/html/draft-bhutton-json-schema</a>
</dd><dt id="bib-json-schema-validation">[JSON-SCHEMA-VALIDATION]</dt><dd>
<a href="https://datatracker.ietf.org/doc/html/draft-bhutton-json-schema-validation"><cite>JSON Schema Validation: A Vocabulary for Structural Validation of JSON</cite></a>. Austin Wright; Henry Andrews; Ben Hutton.  Internet Engineering Task Force (IETF). 11 June 2021. Internet-Draft. URL: <a href="https://datatracker.ietf.org/doc/html/draft-bhutton-json-schema-validation">https://datatracker.ietf.org/doc/html/draft-bhutton-json-schema-validation</a>
</dd><dt id="bib-n-quads">[N-Quads]</dt><dd>
<a href="https://www.w3.org/TR/n-quads/"><cite>RDF 1.1 N-Quads</cite></a>. Gavin Carothers.  W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/n-quads/">https://www.w3.org/TR/n-quads/</a>
</dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
<a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
</dd><dt id="bib-rfc2315">[RFC2315]</dt><dd>
<a href="https://www.rfc-editor.org/rfc/rfc2315"><cite>PKCS #7: Cryptographic Message Syntax Version 1.5</cite></a>. B. Kaliski.  IETF. March 1998. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc2315">https://www.rfc-editor.org/rfc/rfc2315</a>
</dd><dt id="bib-rfc3001">[RFC3001]</dt><dd>
<a href="https://www.rfc-editor.org/rfc/rfc3001"><cite>A URN Namespace of Object Identifiers</cite></a>. M. Mealling.  IETF. November 2000. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc3001">https://www.rfc-editor.org/rfc/rfc3001</a>
</dd><dt id="bib-rfc3061">[RFC3061]</dt><dd>
<a href="https://www.rfc-editor.org/rfc/rfc3061"><cite>A URN Namespace of Object Identifiers</cite></a>. M. Mealling.  IETF. February 2001. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc3061">https://www.rfc-editor.org/rfc/rfc3061</a>
</dd><dt id="bib-rfc3339">[RFC3339]</dt><dd>
<a href="https://www.rfc-editor.org/rfc/rfc3339"><cite>Date and Time on the Internet: Timestamps</cite></a>. G. Klyne; C. Newman.  IETF. July 2002. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3339">https://www.rfc-editor.org/rfc/rfc3339</a>
</dd><dt id="bib-rfc3629">[RFC3629]</dt><dd>
<a href="https://www.rfc-editor.org/rfc/rfc3629"><cite>UTF-8, a transformation format of ISO 10646</cite></a>. F. Yergeau.  IETF. November 2003. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3629">https://www.rfc-editor.org/rfc/rfc3629</a>
</dd><dt id="bib-rfc4648">[RFC4648]</dt><dd>
<a href="https://www.rfc-editor.org/rfc/rfc4648"><cite>The Base16, Base32, and Base64 Data Encodings</cite></a>. S. Josefsson.  IETF. October 2006. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>
</dd><dt id="bib-rfc793">[RFC793]</dt><dd>
<a href="https://www.rfc-editor.org/rfc/rfc793"><cite>Transmission Control Protocol</cite></a>. J. Postel.  IETF. September 1981. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc793">https://www.rfc-editor.org/rfc/rfc793</a>
</dd><dt id="bib-rfc8017">[RFC8017]</dt><dd>
<a href="https://www.rfc-editor.org/rfc/rfc8017"><cite>PKCS #1: RSA Cryptography Specifications Version 2.2</cite></a>. K. Moriarty, Ed.; B. Kaliski; J. Jonsson; A. Rusch.  IETF. November 2016. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc8017">https://www.rfc-editor.org/rfc/rfc8017</a>
</dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
<a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
</dd><dt id="bib-rfc8259">[RFC8259]</dt><dd>
<a href="https://www.rfc-editor.org/rfc/rfc8259"><cite>The JavaScript Object Notation (JSON) Data Interchange Format</cite></a>. T. Bray, Ed..  IETF. December 2017. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>
</dd><dt id="bib-rfc8785">[RFC8785]</dt><dd>
<a href="https://www.rfc-editor.org/rfc/rfc8785"><cite>JSON Canonicalization Scheme (JCS)</cite></a>. A. Rundgren; B. Jordan; S. Erdtman.  IETF. June 2020. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc8785">https://www.rfc-editor.org/rfc/rfc8785</a>
</dd></dl>
</section><section id="informative-references"><div class="header-wrapper"><h3 id="d-2-informative-references"><bdi class="secno">D.2 </bdi>Informative references</h3><a aria-label="Permalink for Appendix D.2" class="self-link" href="#informative-references"></a></div>
<dl class="bibliography"><dt id="bib-data-integrity">[DATA-INTEGRITY]</dt><dd>
<a href="https://w3c-ccg.github.io/data-integrity-spec/"><cite>Data Integrity</cite></a>. Manu Sporny; Dave Longley.  Credentials Community Group. CG-DRAFT. URL: <a href="https://w3c-ccg.github.io/data-integrity-spec/">https://w3c-ccg.github.io/data-integrity-spec/</a>
</dd><dt id="bib-did-core">[DID-CORE]</dt><dd>
<a href="https://www.w3.org/TR/did-core/"><cite>Decentralized Identifiers (DIDs) v1.0</cite></a>. Manu Sporny; Amy Guy; Markus Sabadello; Drummond Reed.  W3C. 19 July 2022. W3C Recommendation. URL: <a href="https://www.w3.org/TR/did-core/">https://www.w3.org/TR/did-core/</a>
</dd><dt id="bib-factdag">[FactDAG]</dt><dd>
<a href="https://doi.org/10.1109/JIOT.2020.2966402"><cite>FactDAG: Formalizing Data Interoperability in an Internet of Production</cite></a>. Lars Gleim; Jan Pennekamp; Martin Liebenberg; Melanie Buchsbaum; Phillip Niemietz; Simon Knape; Alexander Epple; Daniel Trauth; Thomas Bergs; Christian Brecher; Stefan Decker; Gerhard Lakemeyer; Klaus Wehrle.  IEEE Internet of Things Journal, vol. 7, no. 4, pp. 3243-3253. April 2020. Research Paper. URL: <a href="https://doi.org/10.1109/JIOT.2020.2966402">https://doi.org/10.1109/JIOT.2020.2966402</a>
</dd><dt id="bib-oezer-trust">[OEZER-TRUST]</dt><dd>
<a href="https://doi.org/10.1007/978-3-319-32441-8_14"><cite>Establishing Trust and Trustworthiness for Supply Chain Information Sharing</cite></a>. Özalp Özer, Yanchong Zheng.  Handbook of Information Exchange in Supply Chain Management. Springer Series in Supply Chain Management, vol 5. Springer, Cham. 2017. Research Paper. URL: <a href="https://doi.org/10.1007/978-3-319-32441-8_14">https://doi.org/10.1007/978-3-319-32441-8_14</a>
</dd><dt id="bib-reshare">[ReShare]</dt><dd>
<a href="https://doi.org/10.1007/978-3-030-77385-4_16"><cite>Data Reliability and Trustworthiness Through Digital Transmission Contracts</cite></a>. Simon Mangel; Lars Gleim; Jan Pennekamp; Klaus Wehrle; Stefan Decker.  The Semantic Web. ESWC 2021. Lecture Notes in Computer Science, vol 12731. Springer, Cham. 2021. Research Paper. URL: <a href="https://doi.org/10.1007/978-3-030-77385-4_16">https://doi.org/10.1007/978-3-030-77385-4_16</a>
</dd><dt id="bib-rfc3987">[RFC3987]</dt><dd>
<a href="https://www.rfc-editor.org/rfc/rfc3987"><cite>Internationalized Resource Identifiers (IRIs)</cite></a>. M. Duerst; M. Suignard.  IETF. January 2005. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3987">https://www.rfc-editor.org/rfc/rfc3987</a>
</dd><dt id="bib-rfc4880">[RFC4880]</dt><dd>
<a href="https://www.rfc-editor.org/rfc/rfc4880"><cite>OpenPGP Message Format</cite></a>. J. Callas; L. Donnerhacke; H. Finney; D. Shaw; R. Thayer.  IETF. November 2007. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc4880">https://www.rfc-editor.org/rfc/rfc4880</a>
</dd><dt id="bib-rfc7517">[RFC7517]</dt><dd>
<a href="https://www.rfc-editor.org/rfc/rfc7517"><cite>JSON Web Key (JWK)</cite></a>. M. Jones.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>
</dd><dt id="bib-towardsiop">[TowardsIoP]</dt><dd>
<a href="https://doi.org/10.1109/ICPHYS.2019.8780276"><cite>Towards an Infrastructure Enabling the Internet of Production</cite></a>. Jan Pennekamp; René Glebke; Martin Henze; Tobias Meisen; Christoph Quix; Rihan Hai; Lars Gleim; Philipp Niemitz; Maximilian Rudack; Simon Knape; Alexander Epple; Daniel Trauth; Uwe Vroomen; Thomas Bergs; Christian Brecher; Andreas Bührig-Polaczek; Matthias Jarke; Klaus Wehrle.  2019 IEEE International Conference on Industrial Cyber Physical Systems (ICPS). 2019. Research Paper. URL: <a href="https://doi.org/10.1109/ICPHYS.2019.8780276">https://doi.org/10.1109/ICPHYS.2019.8780276</a>
</dd><dt id="bib-vc-data-model">[VC-DATA-MODEL]</dt><dd>
<a href="https://www.w3.org/TR/vc-data-model/"><cite>Verifiable Credentials Data Model v1.1</cite></a>. Manu Sporny; Grant Noble; Dave Longley; Daniel Burnett; Brent Zundel; Kyle Den Hartog.  W3C. 3 March 2022. W3C Recommendation. URL: <a href="https://www.w3.org/TR/vc-data-model/">https://www.w3.org/TR/vc-data-model/</a>
</dd><dt id="bib-vc-use-cases">[VC-USE-CASES]</dt><dd>
<a href="https://www.w3.org/TR/vc-use-cases/"><cite>Verifiable Credentials Use Cases</cite></a>. Shane McCarron; Joe Andrieu; Matt Stone; Tzviya Siegman; Gregg Kellogg; Ted Thibodeau.  W3C. 24 September 2019. W3C Working Group Note. URL: <a href="https://www.w3.org/TR/vc-use-cases/">https://www.w3.org/TR/vc-use-cases/</a>
</dd></dl>
</section></section><p id="back-to-top" role="navigation">
<a href="#title"><abbr title="Back to Top">↑</abbr></a>
</p><div aria-label="Links in this document to definition: data sharing" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-data-sharing" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: data sharing. Activate to close this dialog." class="self-link" href="#dfn-data-sharing">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-data-sharing-1" title="§ 1. Introduction">§ 1. Introduction</a>
</li><li>
<a href="#ref-for-dfn-data-sharing-2" title="§ 3.1 Background">§ 3.1 Background</a> <a href="#ref-for-dfn-data-sharing-3" title="Reference 2">(2)</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: trustworthiness" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-trustworthiness" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: trustworthiness. Activate to close this dialog." class="self-link" href="#dfn-trustworthiness">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-trustworthiness-1" title="§ 1. Introduction">§ 1. Introduction</a>
</li><li>
<a href="#ref-for-dfn-trustworthiness-2" title="§ 3.1 Background">§ 3.1 Background</a> <a href="#ref-for-dfn-trustworthiness-3" title="Reference 2">(2)</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: reliability" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-reliability" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: reliability. Activate to close this dialog." class="self-link" href="#dfn-reliability">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-reliability-1" title="§ 1. Introduction">§ 1. Introduction</a>
</li><li>
<a href="#ref-for-dfn-reliability-2" title="§ 3.1 Background">§ 3.1 Background</a> <a href="#ref-for-dfn-reliability-3" title="Reference 2">(2)</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: immutability" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-immutability" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: immutability. Activate to close this dialog." class="self-link" href="#dfn-immutability">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-immutability-1" title="§ 4.1 Mutual Commitment through Bilateral Signatures">§ 4.1 Mutual Commitment through Bilateral Signatures</a> <a href="#ref-for-dfn-immutability-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-immutability-3" title="Reference 3">(3)</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: IRI" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-iri" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: IRI. Activate to close this dialog." class="self-link" href="#dfn-iri">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-iri-1" title="§ 3.2.2 Process and Agents of Data Sharing">§ 3.2.2 Process and Agents of Data Sharing</a> <a href="#ref-for-dfn-iri-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-iri-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-iri-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-iri-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-iri-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-iri-7" title="Reference 7">(7)</a> <a href="#ref-for-dfn-iri-8" title="Reference 8">(8)</a> <a href="#ref-for-dfn-iri-9" title="Reference 9">(9)</a>
</li><li>
<a href="#ref-for-dfn-iri-10" title="§ 4.3 DTC Data Structure">§ 4.3 DTC Data Structure</a> <a href="#ref-for-dfn-iri-11" title="Reference 2">(2)</a> <a href="#ref-for-dfn-iri-12" title="Reference 3">(3)</a> <a href="#ref-for-dfn-iri-13" title="Reference 4">(4)</a> <a href="#ref-for-dfn-iri-14" title="Reference 5">(5)</a> <a href="#ref-for-dfn-iri-15" title="Reference 6">(6)</a> <a href="#ref-for-dfn-iri-16" title="Reference 7">(7)</a> <a href="#ref-for-dfn-iri-17" title="Reference 8">(8)</a> <a href="#ref-for-dfn-iri-18" title="Reference 9">(9)</a> <a href="#ref-for-dfn-iri-19" title="Reference 10">(10)</a> <a href="#ref-for-dfn-iri-20" title="Reference 11">(11)</a> <a href="#ref-for-dfn-iri-21" title="Reference 12">(12)</a> <a href="#ref-for-dfn-iri-22" title="Reference 13">(13)</a> <a href="#ref-for-dfn-iri-23" title="Reference 14">(14)</a>
</li><li>
<a href="#ref-for-dfn-iri-24" title="§ JSON to JSON-LD">§ JSON to JSON-LD</a>
</li><li>
<a href="#ref-for-dfn-iri-25" title="§ 6.1.2 Complete (3-way) Handshake">§ 6.1.2 Complete (3-way) Handshake</a>
</li><li>
<a href="#ref-for-dfn-iri-26" title="§ Client-side Incoming Message Handling">§ Client-side Incoming Message Handling</a> <a href="#ref-for-dfn-iri-39" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-iri-27" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a> <a href="#ref-for-dfn-iri-28" title="Reference 2">(2)</a> <a href="#ref-for-dfn-iri-29" title="Reference 3">(3)</a> <a href="#ref-for-dfn-iri-30" title="Reference 4">(4)</a> <a href="#ref-for-dfn-iri-31" title="Reference 5">(5)</a> <a href="#ref-for-dfn-iri-32" title="Reference 6">(6)</a> <a href="#ref-for-dfn-iri-33" title="Reference 7">(7)</a> <a href="#ref-for-dfn-iri-40" title="Reference 8">(8)</a>
</li><li>
<a href="#ref-for-dfn-iri-34" title="§ Handshake initiation (Client-side)">§ Handshake initiation (Client-side)</a> <a href="#ref-for-dfn-iri-35" title="Reference 2">(2)</a> <a href="#ref-for-dfn-iri-36" title="Reference 3">(3)</a> <a href="#ref-for-dfn-iri-37" title="Reference 4">(4)</a> <a href="#ref-for-dfn-iri-38" title="Reference 5">(5)</a>
</li><li>
<a href="#ref-for-dfn-iri-41" title="§ 6.2 DTC Verification">§ 6.2 DTC Verification</a>
</li><li>
<a href="#ref-for-dfn-iri-42" title="§ Current Approach">§ Current Approach</a> <a href="#ref-for-dfn-iri-43" title="Reference 2">(2)</a> <a href="#ref-for-dfn-iri-44" title="Reference 3">(3)</a> <a href="#ref-for-dfn-iri-45" title="Reference 4">(4)</a> <a href="#ref-for-dfn-iri-46" title="Reference 5">(5)</a> <a href="#ref-for-dfn-iri-47" title="Reference 6">(6)</a>
</li><li>
<a href="#ref-for-dfn-iri-48" title="§ Possible Future Adaptions">§ Possible Future Adaptions</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: sender" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-sender" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: sender. Activate to close this dialog." class="self-link" href="#dfn-sender">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-sender-1" title="§ 3.2.1 Concepts">§ 3.2.1 Concepts</a> <a href="#ref-for-dfn-sender-2" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-sender-3" title="§ Setup">§ Setup</a>
</li><li>
<a href="#ref-for-dfn-sender-4" title="§ 4.1 Mutual Commitment through Bilateral Signatures">§ 4.1 Mutual Commitment through Bilateral Signatures</a> <a href="#ref-for-dfn-sender-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-sender-6" title="Reference 3">(3)</a> <a href="#ref-for-dfn-sender-7" title="Reference 4">(4)</a> <a href="#ref-for-dfn-sender-8" title="Reference 5">(5)</a> <a href="#ref-for-dfn-sender-9" title="Reference 6">(6)</a> <a href="#ref-for-dfn-sender-10" title="Reference 7">(7)</a>
</li><li>
<a href="#ref-for-dfn-sender-11" title="§ 4.3 DTC Data Structure">§ 4.3 DTC Data Structure</a> <a href="#ref-for-dfn-sender-12" title="Reference 2">(2)</a> <a href="#ref-for-dfn-sender-13" title="Reference 3">(3)</a> <a href="#ref-for-dfn-sender-14" title="Reference 4">(4)</a> <a href="#ref-for-dfn-sender-15" title="Reference 5">(5)</a> <a href="#ref-for-dfn-sender-16" title="Reference 6">(6)</a> <a href="#ref-for-dfn-sender-17" title="Reference 7">(7)</a> <a href="#ref-for-dfn-sender-18" title="Reference 8">(8)</a> <a href="#ref-for-dfn-sender-19" title="Reference 9">(9)</a> <a href="#ref-for-dfn-sender-20" title="Reference 10">(10)</a> <a href="#ref-for-dfn-sender-21" title="Reference 11">(11)</a> <a href="#ref-for-dfn-sender-22" title="Reference 12">(12)</a>
</li><li>
<a href="#ref-for-dfn-sender-23" title="§ 4.5 Signature Creation &amp; Verification">§ 4.5 Signature Creation &amp; Verification</a> <a href="#ref-for-dfn-sender-24" title="Reference 2">(2)</a> <a href="#ref-for-dfn-sender-25" title="Reference 3">(3)</a> <a href="#ref-for-dfn-sender-26" title="Reference 4">(4)</a> <a href="#ref-for-dfn-sender-27" title="Reference 5">(5)</a>
</li><li>
<a href="#ref-for-dfn-sender-28" title="§ 6. DTC Generation &amp; Verification">§ 6. DTC Generation &amp; Verification</a>
</li><li>
<a href="#ref-for-dfn-sender-29" title="§ 6.1 DTC Generation Handshake">§ 6.1 DTC Generation Handshake</a>
</li><li>
<a href="#ref-for-dfn-sender-30" title="§ 6.1.2 Complete (3-way) Handshake">§ 6.1.2 Complete (3-way) Handshake</a> <a href="#ref-for-dfn-sender-31" title="Reference 2">(2)</a> <a href="#ref-for-dfn-sender-32" title="Reference 3">(3)</a> <a href="#ref-for-dfn-sender-33" title="Reference 4">(4)</a> <a href="#ref-for-dfn-sender-34" title="Reference 5">(5)</a>
</li><li>
<a href="#ref-for-dfn-sender-35" title="§ 6.1.3 Abbreviated (2-way) Handshake">§ 6.1.3 Abbreviated (2-way) Handshake</a> <a href="#ref-for-dfn-sender-36" title="Reference 2">(2)</a> <a href="#ref-for-dfn-sender-37" title="Reference 3">(3)</a>
</li><li>
<a href="#ref-for-dfn-sender-38" title="§ Handshake initiation (Client-side)">§ Handshake initiation (Client-side)</a> <a href="#ref-for-dfn-sender-39" title="Reference 2">(2)</a> <a href="#ref-for-dfn-sender-40" title="Reference 3">(3)</a> <a href="#ref-for-dfn-sender-41" title="Reference 4">(4)</a>
</li><li>
<a href="#ref-for-dfn-sender-42" title="§ 6.1.4 Message Identifiers">§ 6.1.4 Message Identifiers</a>
</li><li>
<a href="#ref-for-dfn-sender-43" title="§ Verifiable Credentials">§ Verifiable Credentials</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: receiver" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-receiver" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: receiver. Activate to close this dialog." class="self-link" href="#dfn-receiver">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-receiver-1" title="§ 3.2.1 Concepts">§ 3.2.1 Concepts</a> <a href="#ref-for-dfn-receiver-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-receiver-3" title="Reference 3">(3)</a>
</li><li>
<a href="#ref-for-dfn-receiver-4" title="§ Setup">§ Setup</a>
</li><li>
<a href="#ref-for-dfn-receiver-5" title="§ 4.1 Mutual Commitment through Bilateral Signatures">§ 4.1 Mutual Commitment through Bilateral Signatures</a> <a href="#ref-for-dfn-receiver-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-receiver-7" title="Reference 3">(3)</a> <a href="#ref-for-dfn-receiver-8" title="Reference 4">(4)</a> <a href="#ref-for-dfn-receiver-9" title="Reference 5">(5)</a> <a href="#ref-for-dfn-receiver-10" title="Reference 6">(6)</a> <a href="#ref-for-dfn-receiver-11" title="Reference 7">(7)</a>
</li><li>
<a href="#ref-for-dfn-receiver-12" title="§ 4.3 DTC Data Structure">§ 4.3 DTC Data Structure</a> <a href="#ref-for-dfn-receiver-13" title="Reference 2">(2)</a> <a href="#ref-for-dfn-receiver-14" title="Reference 3">(3)</a> <a href="#ref-for-dfn-receiver-15" title="Reference 4">(4)</a> <a href="#ref-for-dfn-receiver-16" title="Reference 5">(5)</a> <a href="#ref-for-dfn-receiver-17" title="Reference 6">(6)</a> <a href="#ref-for-dfn-receiver-18" title="Reference 7">(7)</a>
</li><li>
<a href="#ref-for-dfn-receiver-19" title="§ 4.5 Signature Creation &amp; Verification">§ 4.5 Signature Creation &amp; Verification</a> <a href="#ref-for-dfn-receiver-20" title="Reference 2">(2)</a> <a href="#ref-for-dfn-receiver-21" title="Reference 3">(3)</a> <a href="#ref-for-dfn-receiver-22" title="Reference 4">(4)</a> <a href="#ref-for-dfn-receiver-23" title="Reference 5">(5)</a>
</li><li>
<a href="#ref-for-dfn-receiver-24" title="§ 6. DTC Generation &amp; Verification">§ 6. DTC Generation &amp; Verification</a>
</li><li>
<a href="#ref-for-dfn-receiver-25" title="§ 6.1 DTC Generation Handshake">§ 6.1 DTC Generation Handshake</a> <a href="#ref-for-dfn-receiver-26" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-receiver-27" title="§ 6.1.2 Complete (3-way) Handshake">§ 6.1.2 Complete (3-way) Handshake</a> <a href="#ref-for-dfn-receiver-28" title="Reference 2">(2)</a> <a href="#ref-for-dfn-receiver-29" title="Reference 3">(3)</a> <a href="#ref-for-dfn-receiver-30" title="Reference 4">(4)</a> <a href="#ref-for-dfn-receiver-31" title="Reference 5">(5)</a>
</li><li>
<a href="#ref-for-dfn-receiver-32" title="§ 6.1.3 Abbreviated (2-way) Handshake">§ 6.1.3 Abbreviated (2-way) Handshake</a> <a href="#ref-for-dfn-receiver-33" title="Reference 2">(2)</a> <a href="#ref-for-dfn-receiver-34" title="Reference 3">(3)</a> <a href="#ref-for-dfn-receiver-35" title="Reference 4">(4)</a> <a href="#ref-for-dfn-receiver-36" title="Reference 5">(5)</a>
</li><li>
<a href="#ref-for-dfn-receiver-37" title="§ Handshake initiation (Client-side)">§ Handshake initiation (Client-side)</a> <a href="#ref-for-dfn-receiver-38" title="Reference 2">(2)</a> <a href="#ref-for-dfn-receiver-39" title="Reference 3">(3)</a>
</li><li>
<a href="#ref-for-dfn-receiver-40" title="§ 6.1.4 Message Identifiers">§ 6.1.4 Message Identifiers</a>
</li><li>
<a href="#ref-for-dfn-receiver-41" title="§ Verifiable Credentials">§ Verifiable Credentials</a>
</li><li>
<a href="#ref-for-dfn-receiver-42" title="§ A.3 DTC Generation: Two Handshake Versions">§ A.3 DTC Generation: Two Handshake Versions</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: resource" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-resource" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: resource. Activate to close this dialog." class="self-link" href="#dfn-resource">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-resource-1" title="§ 3.2.2 Process and Agents of Data Sharing">§ 3.2.2 Process and Agents of Data Sharing</a>
</li><li>
<a href="#ref-for-dfn-resource-2" title="§ Setup">§ Setup</a> <a href="#ref-for-dfn-resource-3" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-resource-4" title="§ 4.3 DTC Data Structure">§ 4.3 DTC Data Structure</a> <a href="#ref-for-dfn-resource-5" title="Reference 2">(2)</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: fact" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-fact" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: fact. Activate to close this dialog." class="self-link" href="#dfn-fact">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-fact-1" title="§ Setup">§ Setup</a>
</li><li>
<a href="#ref-for-dfn-fact-2" title="§ 4.1 Mutual Commitment through Bilateral Signatures">§ 4.1 Mutual Commitment through Bilateral Signatures</a> <a href="#ref-for-dfn-fact-3" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-fact-4" title="§ 4.3 DTC Data Structure">§ 4.3 DTC Data Structure</a> <a href="#ref-for-dfn-fact-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-fact-6" title="Reference 3">(3)</a> <a href="#ref-for-dfn-fact-7" title="Reference 4">(4)</a> <a href="#ref-for-dfn-fact-8" title="Reference 5">(5)</a> <a href="#ref-for-dfn-fact-9" title="Reference 6">(6)</a> <a href="#ref-for-dfn-fact-10" title="Reference 7">(7)</a> <a href="#ref-for-dfn-fact-11" title="Reference 8">(8)</a> <a href="#ref-for-dfn-fact-12" title="Reference 9">(9)</a> <a href="#ref-for-dfn-fact-13" title="Reference 10">(10)</a>
</li><li>
<a href="#ref-for-dfn-fact-14" title="§ 4.4.1 JSON">§ 4.4.1 JSON</a> <a href="#ref-for-dfn-fact-15" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-fact-16" title="§ Client-side Incoming Message Handling">§ Client-side Incoming Message Handling</a>
</li><li>
<a href="#ref-for-dfn-fact-17" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a> <a href="#ref-for-dfn-fact-18" title="Reference 2">(2)</a> <a href="#ref-for-dfn-fact-19" title="Reference 3">(3)</a> <a href="#ref-for-dfn-fact-22" title="Reference 4">(4)</a>
</li><li>
<a href="#ref-for-dfn-fact-20" title="§ Handshake initiation (Client-side)">§ Handshake initiation (Client-side)</a> <a href="#ref-for-dfn-fact-21" title="Reference 2">(2)</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: FactID" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-factid" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: FactID. Activate to close this dialog." class="self-link" href="#dfn-factid">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-factid-1" title="§ 4.3 DTC Data Structure">§ 4.3 DTC Data Structure</a> <a href="#ref-for-dfn-factid-2" title="Reference 2">(2)</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: pre-created signatures" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-pre-created-signatures" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: pre-created signatures. Activate to close this dialog." class="self-link" href="#dfn-pre-created-signatures">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>Not referenced in this document.</li>
</ul>
</div><div aria-label="Links in this document to definition: document signatures" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-document-signatures" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: document signatures. Activate to close this dialog." class="self-link" href="#dfn-document-signatures">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>Not referenced in this document.</li>
</ul>
</div><div aria-label="Links in this document to definition: on-demand signatures" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-on-demand-signatures" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: on-demand signatures. Activate to close this dialog." class="self-link" href="#dfn-on-demand-signatures">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-on-demand-signatures-1" title="§ 4.1 Mutual Commitment through Bilateral Signatures">§ 4.1 Mutual Commitment through Bilateral Signatures</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: message signatures" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-message-signatures" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: message signatures. Activate to close this dialog." class="self-link" href="#dfn-message-signatures">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>Not referenced in this document.</li>
</ul>
</div><div aria-label="Links in this document to definition: contract fields" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-contract-fields" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: contract fields. Activate to close this dialog." class="self-link" href="#dfn-contract-fields">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-contract-fields-1" title="§ 4.3 DTC Data Structure">§ 4.3 DTC Data Structure</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: baseIRI" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-dtc-baseiri" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: baseIRI. Activate to close this dialog." class="self-link" href="#dfn-dtc-baseiri">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-dtc-baseiri-1" title="§ JSON to JSON-LD">§ JSON to JSON-LD</a>
</li><li>
<a href="#ref-for-dfn-dtc-baseiri-2" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a>
</li><li>
<a href="#ref-for-dfn-dtc-baseiri-3" title="§ Handshake initiation (Client-side)">§ Handshake initiation (Client-side)</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: sender" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-dtc-sender" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: sender. Activate to close this dialog." class="self-link" href="#dfn-dtc-sender">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-dtc-sender-1" title="§ 4.3 DTC Data Structure">§ 4.3 DTC Data Structure</a> <a href="#ref-for-dfn-dtc-sender-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-dtc-sender-3" title="Reference 3">(3)</a>
</li><li>
<a href="#ref-for-dfn-dtc-sender-4" title="§ 4.4.1 JSON">§ 4.4.1 JSON</a> <a href="#ref-for-dfn-dtc-sender-5" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-dtc-sender-6" title="§ JSON to JSON-LD">§ JSON to JSON-LD</a> <a href="#ref-for-dfn-dtc-sender-7" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-dtc-sender-8" title="§ 4.5 Signature Creation &amp; Verification">§ 4.5 Signature Creation &amp; Verification</a>
</li><li>
<a href="#ref-for-dfn-dtc-sender-9" title="§ Client-side Incoming Message Handling">§ Client-side Incoming Message Handling</a> <a href="#ref-for-dfn-dtc-sender-10" title="Reference 2">(2)</a> <a href="#ref-for-dfn-dtc-sender-11" title="Reference 3">(3)</a> <a href="#ref-for-dfn-dtc-sender-12" title="Reference 4">(4)</a> <a href="#ref-for-dfn-dtc-sender-19" title="Reference 5">(5)</a> <a href="#ref-for-dfn-dtc-sender-20" title="Reference 6">(6)</a> <a href="#ref-for-dfn-dtc-sender-21" title="Reference 7">(7)</a> <a href="#ref-for-dfn-dtc-sender-22" title="Reference 8">(8)</a>
</li><li>
<a href="#ref-for-dfn-dtc-sender-13" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a> <a href="#ref-for-dfn-dtc-sender-14" title="Reference 2">(2)</a> <a href="#ref-for-dfn-dtc-sender-15" title="Reference 3">(3)</a> <a href="#ref-for-dfn-dtc-sender-23" title="Reference 4">(4)</a> <a href="#ref-for-dfn-dtc-sender-24" title="Reference 5">(5)</a>
</li><li>
<a href="#ref-for-dfn-dtc-sender-16" title="§ 6.1.3 Abbreviated (2-way) Handshake">§ 6.1.3 Abbreviated (2-way) Handshake</a>
</li><li>
<a href="#ref-for-dfn-dtc-sender-17" title="§ Handshake initiation (Client-side)">§ Handshake initiation (Client-side)</a> <a href="#ref-for-dfn-dtc-sender-18" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-dtc-sender-25" title="§ 6.1.4 Message Identifiers">§ 6.1.4 Message Identifiers</a>
</li><li>
<a href="#ref-for-dfn-dtc-sender-26" title="§ 6.2 DTC Verification">§ 6.2 DTC Verification</a> <a href="#ref-for-dfn-dtc-sender-27" title="Reference 2">(2)</a> <a href="#ref-for-dfn-dtc-sender-28" title="Reference 3">(3)</a> <a href="#ref-for-dfn-dtc-sender-29" title="Reference 4">(4)</a>
</li><li>
<a href="#ref-for-dfn-dtc-sender-30" title="§ Data Integrity">§ Data Integrity</a>
</li><li>
<a href="#ref-for-dfn-dtc-sender-31" title="§ Current Approach">§ Current Approach</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: receiver" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-dtc-receiver" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: receiver. Activate to close this dialog." class="self-link" href="#dfn-dtc-receiver">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-dtc-receiver-1" title="§ JSON to JSON-LD">§ JSON to JSON-LD</a> <a href="#ref-for-dfn-dtc-receiver-2" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiver-3" title="§ 4.5 Signature Creation &amp; Verification">§ 4.5 Signature Creation &amp; Verification</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiver-4" title="§ 6.1.2 Complete (3-way) Handshake">§ 6.1.2 Complete (3-way) Handshake</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiver-5" title="§ Handshake Initiation (Client-side)">§ Handshake Initiation (Client-side)</a> <a href="#ref-for-dfn-dtc-receiver-6" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiver-7" title="§ Client-side Incoming Message Handling">§ Client-side Incoming Message Handling</a> <a href="#ref-for-dfn-dtc-receiver-14" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiver-8" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a> <a href="#ref-for-dfn-dtc-receiver-9" title="Reference 2">(2)</a> <a href="#ref-for-dfn-dtc-receiver-10" title="Reference 3">(3)</a> <a href="#ref-for-dfn-dtc-receiver-11" title="Reference 4">(4)</a> <a href="#ref-for-dfn-dtc-receiver-15" title="Reference 5">(5)</a> <a href="#ref-for-dfn-dtc-receiver-16" title="Reference 6">(6)</a> <a href="#ref-for-dfn-dtc-receiver-17" title="Reference 7">(7)</a> <a href="#ref-for-dfn-dtc-receiver-18" title="Reference 8">(8)</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiver-12" title="§ Handshake initiation (Client-side)">§ Handshake initiation (Client-side)</a> <a href="#ref-for-dfn-dtc-receiver-13" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiver-19" title="§ 6.1.4 Message Identifiers">§ 6.1.4 Message Identifiers</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiver-20" title="§ 6.2 DTC Verification">§ 6.2 DTC Verification</a> <a href="#ref-for-dfn-dtc-receiver-21" title="Reference 2">(2)</a> <a href="#ref-for-dfn-dtc-receiver-22" title="Reference 3">(3)</a> <a href="#ref-for-dfn-dtc-receiver-23" title="Reference 4">(4)</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiver-24" title="§ Data Integrity">§ Data Integrity</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiver-25" title="§ Current Approach">§ Current Approach</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: senderSig" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-dtc-sendersig" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: senderSig. Activate to close this dialog." class="self-link" href="#dfn-dtc-sendersig">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-dtc-sendersig-1" title="§ 4.3 DTC Data Structure">§ 4.3 DTC Data Structure</a> <a href="#ref-for-dfn-dtc-sendersig-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-dtc-sendersig-3" title="Reference 3">(3)</a>
</li><li>
<a href="#ref-for-dfn-dtc-sendersig-4" title="§ JSON to JSON-LD">§ JSON to JSON-LD</a> <a href="#ref-for-dfn-dtc-sendersig-5" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-dtc-sendersig-6" title="§ 4.5 Signature Creation &amp; Verification">§ 4.5 Signature Creation &amp; Verification</a>
</li><li>
<a href="#ref-for-dfn-dtc-sendersig-7" title="§ 4.5.2 Pre-Processing">§ 4.5.2 Pre-Processing</a>
</li><li>
<a href="#ref-for-dfn-dtc-sendersig-8" title="§ 4.5.3 Signature Creation">§ 4.5.3 Signature Creation</a>
</li><li>
<a href="#ref-for-dfn-dtc-sendersig-9" title="§ 4.5.4 Signature Verification">§ 4.5.4 Signature Verification</a>
</li><li>
<a href="#ref-for-dfn-dtc-sendersig-10" title="§ Client-side Incoming Message Handling">§ Client-side Incoming Message Handling</a> <a href="#ref-for-dfn-dtc-sendersig-12" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-dtc-sendersig-11" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a> <a href="#ref-for-dfn-dtc-sendersig-13" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-dtc-sendersig-14" title="§ 6.2 DTC Verification">§ 6.2 DTC Verification</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: receiverSig" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-dtc-receiversig" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: receiverSig. Activate to close this dialog." class="self-link" href="#dfn-dtc-receiversig">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-dtc-receiversig-1" title="§ 4.3 DTC Data Structure">§ 4.3 DTC Data Structure</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiversig-2" title="§ JSON to JSON-LD">§ JSON to JSON-LD</a> <a href="#ref-for-dfn-dtc-receiversig-3" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiversig-4" title="§ 4.5 Signature Creation &amp; Verification">§ 4.5 Signature Creation &amp; Verification</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiversig-5" title="§ 4.5.2 Pre-Processing">§ 4.5.2 Pre-Processing</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiversig-6" title="§ 4.5.3 Signature Creation">§ 4.5.3 Signature Creation</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiversig-7" title="§ 4.5.4 Signature Verification">§ 4.5.4 Signature Verification</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiversig-8" title="§ 6.1.2 Complete (3-way) Handshake">§ 6.1.2 Complete (3-way) Handshake</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiversig-9" title="§ Client-side Incoming Message Handling">§ Client-side Incoming Message Handling</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiversig-10" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a> <a href="#ref-for-dfn-dtc-receiversig-12" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiversig-11" title="§ Handshake initiation (Client-side)">§ Handshake initiation (Client-side)</a>
</li><li>
<a href="#ref-for-dfn-dtc-receiversig-13" title="§ 6.2 DTC Verification">§ 6.2 DTC Verification</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: facts" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-dtc-facts" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: facts. Activate to close this dialog." class="self-link" href="#dfn-dtc-facts">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-dtc-facts-1" title="§ 4.3 DTC Data Structure">§ 4.3 DTC Data Structure</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-2" title="§ 4.4.1 JSON">§ 4.4.1 JSON</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-3" title="§ JSON to JSON-LD">§ JSON to JSON-LD</a> <a href="#ref-for-dfn-dtc-facts-4" title="Reference 2">(2)</a> <a href="#ref-for-dfn-dtc-facts-5" title="Reference 3">(3)</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-6" title="§ 4.5 Signature Creation &amp; Verification">§ 4.5 Signature Creation &amp; Verification</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-7" title="§ 4.5.2 Pre-Processing">§ 4.5.2 Pre-Processing</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-8" title="§ 6.1.2 Complete (3-way) Handshake">§ 6.1.2 Complete (3-way) Handshake</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-9" title="§ Handshake Initiation (Client-side)">§ Handshake Initiation (Client-side)</a> <a href="#ref-for-dfn-dtc-facts-10" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-11" title="§ Client-side Incoming Message Handling">§ Client-side Incoming Message Handling</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-12" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a> <a href="#ref-for-dfn-dtc-facts-13" title="Reference 2">(2)</a> <a href="#ref-for-dfn-dtc-facts-14" title="Reference 3">(3)</a> <a href="#ref-for-dfn-dtc-facts-15" title="Reference 4">(4)</a> <a href="#ref-for-dfn-dtc-facts-20" title="Reference 5">(5)</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-16" title="§ Handshake initiation (Client-side)">§ Handshake initiation (Client-side)</a> <a href="#ref-for-dfn-dtc-facts-17" title="Reference 2">(2)</a> <a href="#ref-for-dfn-dtc-facts-18" title="Reference 3">(3)</a> <a href="#ref-for-dfn-dtc-facts-19" title="Reference 4">(4)</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-21" title="§ Data Integrity">§ Data Integrity</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: factID" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-dtc-facts-factid" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: factID. Activate to close this dialog." class="self-link" href="#dfn-dtc-facts-factid">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-dtc-facts-factid-1" title="§ 4.3 DTC Data Structure">§ 4.3 DTC Data Structure</a> <a href="#ref-for-dfn-dtc-facts-factid-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-dtc-facts-factid-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-dtc-facts-factid-4" title="Reference 4">(4)</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-factid-5" title="§ JSON to JSON-LD">§ JSON to JSON-LD</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-factid-6" title="§ 4.5.2 Pre-Processing">§ 4.5.2 Pre-Processing</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-factid-7" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a> <a href="#ref-for-dfn-dtc-facts-factid-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-dtc-facts-factid-9" title="Reference 3">(3)</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-factid-10" title="§ Handshake initiation (Client-side)">§ Handshake initiation (Client-side)</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: requestedID" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-dtc-facts-requestedid" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: requestedID. Activate to close this dialog." class="self-link" href="#dfn-dtc-facts-requestedid">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-dtc-facts-requestedid-1" title="§ Handshake Initiation (Client-side)">§ Handshake Initiation (Client-side)</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-requestedid-2" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a> <a href="#ref-for-dfn-dtc-facts-requestedid-3" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-requestedid-4" title="§ Handshake initiation (Client-side)">§ Handshake initiation (Client-side)</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: &lt;alg&gt;" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-dtc-facts-alg" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: &lt;alg&gt;. Activate to close this dialog." class="self-link" href="#dfn-dtc-facts-alg">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-dtc-facts-alg-1" title="§ Handshake Initiation (Client-side)">§ Handshake Initiation (Client-side)</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-alg-2" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-alg-3" title="§ Handshake initiation (Client-side)">§ Handshake initiation (Client-side)</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: serialization" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-dtc-facts-serialization" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: serialization. Activate to close this dialog." class="self-link" href="#dfn-dtc-facts-serialization">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-dtc-facts-serialization-1" title="§ Handshake Initiation (Client-side)">§ Handshake Initiation (Client-side)</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-serialization-2" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a> <a href="#ref-for-dfn-dtc-facts-serialization-4" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-serialization-3" title="§ Handshake initiation (Client-side)">§ Handshake initiation (Client-side)</a>
</li><li>
<a href="#ref-for-dfn-dtc-facts-serialization-5" title="§ 6.2 DTC Verification">§ 6.2 DTC Verification</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: senderCustomContent/receiverCustomContent" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-dtc-customcontent" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: senderCustomContent/receiverCustomContent. Activate to close this dialog." class="self-link" href="#dfn-dtc-customcontent">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-dtc-customcontent-1" title="§ 6.1.2 Complete (3-way) Handshake">§ 6.1.2 Complete (3-way) Handshake</a>
</li><li>
<a href="#ref-for-dfn-dtc-customcontent-2" title="§ Handshake Initiation (Client-side)">§ Handshake Initiation (Client-side)</a> <a href="#ref-for-dfn-dtc-customcontent-3" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-dtc-customcontent-4" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a>
</li><li>
<a href="#ref-for-dfn-dtc-customcontent-5" title="§ 6.1.3 Abbreviated (2-way) Handshake">§ 6.1.3 Abbreviated (2-way) Handshake</a>
</li><li>
<a href="#ref-for-dfn-dtc-customcontent-6" title="§ Handshake initiation (Client-side)">§ Handshake initiation (Client-side)</a> <a href="#ref-for-dfn-dtc-customcontent-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-dtc-customcontent-8" title="Reference 3">(3)</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: timestamp" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-dtc-timestamp" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: timestamp. Activate to close this dialog." class="self-link" href="#dfn-dtc-timestamp">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-dtc-timestamp-1" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a>
</li><li>
<a href="#ref-for-dfn-dtc-timestamp-2" title="§ Handshake initiation (Client-side)">§ Handshake initiation (Client-side)</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: message identifiers" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-message-identifiers" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: message identifiers. Activate to close this dialog." class="self-link" href="#dfn-message-identifiers">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-message-identifiers-1" title="§ 6.1.5 Message Builder">§ 6.1.5 Message Builder</a>
</li><li>
<a href="#ref-for-dfn-message-identifiers-2" title="§ 6.1.6 Message Schemas">§ 6.1.6 Message Schemas</a>
</li><li>
<a href="#ref-for-dfn-message-identifiers-3" title="§ 6.1.7 Message Validator">§ 6.1.7 Message Validator</a>
</li><li>
<a href="#ref-for-dfn-message-identifiers-4" title="§ 6.1.8 Error Message Builder &amp; Error Handling">§ 6.1.8 Error Message Builder &amp; Error Handling</a>
</li><li>
<a href="#ref-for-dfn-message-identifiers-5" title="§ 6.1.9 Protocol Stack">§ 6.1.9 Protocol Stack</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: non-error message identifiers" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-non-error-message-identifiers" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: non-error message identifiers. Activate to close this dialog." class="self-link" href="#dfn-non-error-message-identifiers">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-non-error-message-identifiers-1" title="§ 6.1.4 Message Identifiers">§ 6.1.4 Message Identifiers</a>
</li><li>
<a href="#ref-for-dfn-non-error-message-identifiers-2" title="§ 6.1.5 Message Builder">§ 6.1.5 Message Builder</a>
</li><li>
<a href="#ref-for-dfn-non-error-message-identifiers-3" title="§ 6.1.9 Protocol Stack">§ 6.1.9 Protocol Stack</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: error message identifiers" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-error-message-identifiers" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: error message identifiers. Activate to close this dialog." class="self-link" href="#dfn-error-message-identifiers">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-error-message-identifiers-1" title="§ Client-side Incoming Message Handling">§ Client-side Incoming Message Handling</a> <a href="#ref-for-dfn-error-message-identifiers-3" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-error-message-identifiers-2" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a> <a href="#ref-for-dfn-error-message-identifiers-4" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-error-message-identifiers-5" title="§ 6.1.4 Message Identifiers">§ 6.1.4 Message Identifiers</a>
</li><li>
<a href="#ref-for-dfn-error-message-identifiers-6" title="§ 6.1.8 Error Message Builder &amp; Error Handling">§ 6.1.8 Error Message Builder &amp; Error Handling</a> <a href="#ref-for-dfn-error-message-identifiers-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-error-message-identifiers-8" title="Reference 3">(3)</a>
</li><li>
<a href="#ref-for-dfn-error-message-identifiers-9" title="§ 6.1.9 Protocol Stack">§ 6.1.9 Protocol Stack</a> <a href="#ref-for-dfn-error-message-identifiers-10" title="Reference 2">(2)</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: outgoing message interface" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-outgoing-message-interface" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: outgoing message interface. Activate to close this dialog." class="self-link" href="#dfn-outgoing-message-interface">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-outgoing-message-interface-1" title="§ Handshake Initiation (Client-side)">§ Handshake Initiation (Client-side)</a>
</li><li>
<a href="#ref-for-dfn-outgoing-message-interface-2" title="§ Client-side Incoming Message Handling">§ Client-side Incoming Message Handling</a>
</li><li>
<a href="#ref-for-dfn-outgoing-message-interface-3" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a> <a href="#ref-for-dfn-outgoing-message-interface-5" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-outgoing-message-interface-4" title="§ Handshake initiation (Client-side)">§ Handshake initiation (Client-side)</a>
</li><li>
<a href="#ref-for-dfn-outgoing-message-interface-6" title="§ 6.1.9 Protocol Stack">§ 6.1.9 Protocol Stack</a> <a href="#ref-for-dfn-outgoing-message-interface-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-outgoing-message-interface-8" title="Reference 3">(3)</a> <a href="#ref-for-dfn-outgoing-message-interface-9" title="Reference 4">(4)</a> <a href="#ref-for-dfn-outgoing-message-interface-10" title="Reference 5">(5)</a> <a href="#ref-for-dfn-outgoing-message-interface-11" title="Reference 6">(6)</a>
</li>
</ul>
</div><div aria-label="Links in this document to definition: incoming message handler" aria-modal="true" class="dfn-panel" hidden="" id="dfn-panel-for-dfn-incoming-message-handler" role="dialog">
<span class="caret"></span>
<div>
<a aria-label="Permalink for definition: incoming message handler. Activate to close this dialog." class="self-link" href="#dfn-incoming-message-handler">Permalink</a>
</div>
<p><b>Referenced in:</b></p>
<ul>
<li>
<a href="#ref-for-dfn-incoming-message-handler-1" title="§ Client-side Incoming Message Handling">§ Client-side Incoming Message Handling</a> <a href="#ref-for-dfn-incoming-message-handler-3" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-incoming-message-handler-2" title="§ Server-side Incoming Message Handling">§ Server-side Incoming Message Handling</a> <a href="#ref-for-dfn-incoming-message-handler-4" title="Reference 2">(2)</a>
</li><li>
<a href="#ref-for-dfn-incoming-message-handler-5" title="§ 6.1.9 Protocol Stack">§ 6.1.9 Protocol Stack</a> <a href="#ref-for-dfn-incoming-message-handler-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-incoming-message-handler-7" title="Reference 3">(3)</a> <a href="#ref-for-dfn-incoming-message-handler-8" title="Reference 4">(4)</a> <a href="#ref-for-dfn-incoming-message-handler-9" title="Reference 5">(5)</a>
</li>
</ul>
</div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>